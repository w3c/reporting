<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <title>Reporting API</title>
  <meta content="ED" name="w3c-status">
  <link href="https://www.w3.org/StyleSheets/TR/2021/W3C-ED" rel="stylesheet">
  <meta content="Bikeshed version 9a7a6709a, updated Tue May 27 16:45:34 2025 -0700" name="generator">
  <link href="https://www.w3.org/TR/reporting-1/" rel="canonical">
  <meta content="b9ba28c8bdf763d8ffe576909688b737bbaeffbf" name="revision">
  <meta content="dark light" name="color-scheme">
  <link href="https://www.w3.org/StyleSheets/TR/2021/dark.css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css">
<style>/* Boilerplate: style-autolinks */
.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}

@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}
</style>
<style>/* Boilerplate: style-colors */
/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}
</style>
<style>/* Boilerplate: style-counters */
body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}
</style>
<style>/* Boilerplate: style-dfn-panel */
:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
    --dfnpanel-target-bg: #ffc;
    --dfnpanel-target-outline: orange;
}
@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
        --dfnpanel-target-bg: #333;
        --dfnpanel-target-outline: silver;
    }
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel a:focus {
    outline: 5px auto Highlight;
    outline: 5px auto -webkit-focus-ring-color;
}
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0 0 0 1em; list-style: none; }
.dfn-panel li a {
    max-width: calc(300px - 1.5em - 1em);
    overflow: hidden;
    text-overflow: ellipsis;
}

.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: 8px;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
    transition: left 1s ease-out, bottom 1s ease-out;
}

.dfn-panel .link-item:hover {
    text-decoration: underline;
}
.dfn-panel .link-item .copy-icon {
    opacity: 0;
}
.dfn-panel .link-item:hover .copy-icon,
.dfn-panel .link-item .copy-icon:focus {
    opacity: 1;
}

.dfn-panel .copy-icon {
    display: inline-block;
    margin-right: 0.5em;
    width: 0.85em;
    height: 1em;
    border-radius: 3px;
    background-color: #ccc;
    cursor: pointer;
}

.dfn-panel .copy-icon .icon {
    width: 100%;
    height: 100%;
    background-color: #fff;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
}

.dfn-panel .copy-icon .icon::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: 1px solid black;
    background-color: #ccc;
    opacity: 0.25;
    transform: translate(3px, -3px);
}

.dfn-panel .copy-icon:active .icon::before {
    opacity: 1;
}

.dfn-paneled[role="button"] { cursor: help; }

.highlighted {
    animation: target-fade 3s;
}

@keyframes target-fade {
    from {
        background-color: var(--dfnpanel-target-bg);
        outline: 5px solid var(--dfnpanel-target-outline);
    }
    to {
        color: var(--a-normal-text);
        background-color: transparent;
        outline: transparent;
    }
}
</style>
<style>/* Boilerplate: style-idl-highlighting */
pre.idl.highlight {
    background: var(--borderedblock-bg, var(--def-bg));
}
</style>
<style>/* Boilerplate: style-issues */
a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* Boilerplate: style-md-lists */
/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}
</style>
<style>/* Boilerplate: style-mdn-anno */
:root {
	--mdn-bg: #EEE;
	--mdn-shadow: #999;
	--mdn-nosupport-text: #ccc;
	--mdn-pass: green;
	--mdn-fail: red;
}
@media (prefers-color-scheme: dark) {
	:root {
		--mdn-bg: #222;
		--mdn-shadow: #444;
		--mdn-nosupport-text: #666;
		--mdn-pass: #690;
		--mdn-fail: #d22;
	}
}
.mdn-anno {
	background: var(--mdn-bg, #EEE);
	border-radius: .25em;
	box-shadow: 0 0 3px var(--mdn-shadow, #999);
	color: var(--text, black);
	font: 1em sans-serif;
	hyphens: none;
	max-width: min-content;
	overflow: hidden;
	padding: 0.2em;
	position: absolute;
	right: 0.3em;
	top: auto;
	white-space: nowrap;
	word-wrap: normal;
	z-index: 8;
}
.mdn-anno.unpositioned {
	display: none;
}
.mdn-anno.overlapping-main {
	opacity: .2;
	transition: opacity .1s;
}
.mdn-anno[open] {
	opacity: 1;
	z-index: 9;
	min-width: 9em;
}
.mdn-anno:hover {
	opacity: 1;
	outline: var(--text, black) 1px solid;
}
.mdn-anno > summary {
	font-weight: normal;
	text-align: right;
	cursor: pointer;
	display: block;
}
.mdn-anno > summary > .less-than-two-engines-flag {
	color: var(--mdn-fail);
	padding-right: 2px;
}
.mdn-anno > summary > .all-engines-flag {
	color: var(--mdn-pass);
	padding-right: 2px;
}
.mdn-anno > summary > span {
	color: #fff;
	background-color: #000;
	font-weight: normal;
	font-family: zillaslab, Palatino, "Palatino Linotype", serif;
	padding: 2px 3px 0px 3px;
	line-height: 1.3em;
	vertical-align: top;
}
.mdn-anno > .feature {
	margin-top: 20px;
}
.mdn-anno > .feature:not(:first-of-type) {
	border-top: 1px solid #999;
	margin-top: 6px;
	padding-top: 2px;
}
.mdn-anno > .feature > .less-than-two-engines-text {
	color: var(--mdn-fail);
}
.mdn-anno > .feature > .all-engines-text {
	color: var(--mdn-pass);
}
.mdn-anno > .feature > p {
	font-size: .75em;
	margin-top: 6px;
	margin-bottom: 0;
}
.mdn-anno > .feature > p + p {
	margin-top: 3px;
}
.mdn-anno > .feature > .support {
	display: block;
	font-size: 0.6em;
	margin: 0;
	padding: 0;
	margin-top: 2px;
}
.mdn-anno > .feature > .support + div {
	padding-top: 0.5em;
}
.mdn-anno > .feature > .support > hr {
	display: block;
	border: none;
	border-top: 1px dotted #999;
	padding: 3px 0px 0px 0px;
	margin: 2px 3px 0px 3px;
}
.mdn-anno > .feature > .support > hr::before {
	content: "";
}
.mdn-anno > .feature > .support > span {
	padding: 0.2em 0;
	display: block;
	display: table;
}
.mdn-anno > .feature > .support > span.no {
	color: var(--mdn-nosupport-text);
	filter: grayscale(100%);
}
.mdn-anno > .feature > .support > span.no::before {
	opacity: 0.5;
}
.mdn-anno > .feature > .support > span:first-of-type {
	padding-top: 0.5em;
}
.mdn-anno > .feature > .support > span > span {
	padding: 0 0.5em;
	display: table-cell;
}
.mdn-anno > .feature > .support > span > span:first-child {
	width: 100%;
}
.mdn-anno > .feature > .support > span > span:last-child {
	width: 100%;
	white-space: pre;
	padding: 0;
}
.mdn-anno > .feature > .support > span::before {
	content: ' ';
	display: table-cell;
	min-width: 1.5em;
	height: 1.5em;
	background: no-repeat center center;
	background-size: contain;
	text-align: right;
	font-size: 0.75em;
	font-weight: bold;
}
.mdn-anno > .feature > .support > .chrome_android::before {
	background-image: url(https://resources.whatwg.org/browser-logos/chrome.svg);
}
.mdn-anno > .feature > .support > .firefox_android::before {
	background-image: url(https://resources.whatwg.org/browser-logos/firefox.png);
}
.mdn-anno > .feature > .support > .chrome::before {
	background-image: url(https://resources.whatwg.org/browser-logos/chrome.svg);
}
.mdn-anno > .feature > .support > .edge_blink::before {
	background-image: url(https://resources.whatwg.org/browser-logos/edge.svg);
}
.mdn-anno > .feature > .support > .edge::before {
	background-image: url(https://resources.whatwg.org/browser-logos/edge_legacy.svg);
}
.mdn-anno > .feature > .support > .firefox::before {
	background-image: url(https://resources.whatwg.org/browser-logos/firefox.png);
}
.mdn-anno > .feature > .support > .ie::before {
	background-image: url(https://resources.whatwg.org/browser-logos/ie.png);
}
.mdn-anno > .feature > .support > .safari_ios::before {
	background-image: url(https://resources.whatwg.org/browser-logos/safari-ios.svg);
}
.mdn-anno > .feature > .support > .nodejs::before {
	background-image: url(https://nodejs.org/favicon.ico);
}
.mdn-anno > .feature > .support > .opera_android::before {
	background-image: url(https://resources.whatwg.org/browser-logos/opera.svg);
}
.mdn-anno > .feature > .support > .opera::before {
	background-image: url(https://resources.whatwg.org/browser-logos/opera.svg);
}
.mdn-anno > .feature > .support > .safari::before {
	background-image: url(https://resources.whatwg.org/browser-logos/safari.png);
}
.mdn-anno > .feature > .support > .samsunginternet_android::before {
	background-image: url(https://resources.whatwg.org/browser-logos/samsung.svg);
}
.mdn-anno > .feature > .support > .webview_android::before {
	background-image: url(https://resources.whatwg.org/browser-logos/android-webview.png);
}
.name-slug-mismatch {
	color: red;
}
.caniuse-status:hover {
	z-index: 9;
}
/* dt, li, .issue, .note, and .example are "position: relative", so to put annotation at right margin, must move to right of containing block */;
.h-entry:not(.status-LS) dt > .mdn-anno, .h-entry:not(.status-LS) li > .mdn-anno, .h-entry:not(.status-LS) .issue > .mdn-anno, .h-entry:not(.status-LS) .note > .mdn-anno, .h-entry:not(.status-LS) .example > .mdn-anno {
	right: -6.7em;
}
.h-entry p + .mdn-anno {
	margin-top: 0;
}
 h2 + .mdn-anno.after {
	margin: -48px 0 0 0;
}
 h3 + .mdn-anno.after {
	margin: -46px 0 0 0;
}
 h4 + .mdn-anno.after {
	margin: -42px 0 0 0;
}
 h5 + .mdn-anno.after {
	margin: -40px 0 0 0;
}
 h6 + .mdn-anno.after {
	margin: -40px 0 0 0;
}
</style>
<style>/* Boilerplate: style-ref-hints */
:root {
    --ref-hint-bg: #ddd;
    --ref-hint-text: var(--text);
}
@media (prefers-color-scheme: dark) {
    :root {
        --ref-hint-bg: #222;
        --ref-hint-text: var(--text);
    }
}

.ref-hint {
    display: inline-block;
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.5em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--ref-hint-bg);
    color: var(--ref-hint-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}

.ref-hint * { margin: 0; padding: 0; text-indent: 0; }

.ref-hint ul { padding: 0 0 0 1em; list-style: none; }
</style>
<style>/* Boilerplate: style-selflinks */
:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
.example > a.self-link,
.note > a.self-link,
.issue > a.self-link {
    /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
    left: auto;
    right: 0;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* Boilerplate: style-syntax-highlighting */
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: rgba(0, 0, 0, .03); }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */

@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
<style>/* Boilerplate: style-var-click-highlighting */
/*
Colors were chosen in Lab using https://nixsensor.com/free-color-converter/
D50 2deg illuminant, L in [0,100], a and b in [-128, 128]
0 = lab(85,0,85)
1 = lab(85,80,30)
2 = lab(85,-40,40)
3 = lab(85,-50,0)
4 = lab(85,5,15)
5 = lab(85,-10,-50)
6 = lab(85,35,-15)

For darkmode:
0 = oklab(50%   0%  108%)
1 = oklab(50% -51%   51%)
2 = oklab(50% -64%  -20%)
3 = oklab(50%   6%   19%)
4 = oklab(50% -12%  -64%)
5 = oklab(50%  44%  -19%)  
6 = oklab(50% 102%   38%)
*/

[data-algorithm] var { cursor: pointer; }
var[data-var-color] { background-color: var(--var-bg); box-shadow: 0 0 0 2px var(--var-bg); }

var[data-var-color] { --var-bg: #F4D200; }
var[data-var-color="1"] { --var-bg: #FF87A2; }
var[data-var-color="2"] { --var-bg: #96E885; }
var[data-var-color="3"] { --var-bg: #3EEED2; }
var[data-var-color="4"] { --var-bg: #EACFB6; }
var[data-var-color="5"] { --var-bg: #82DDFF; }
var[data-var-color="6"] { --var-vg: #FFBCF2; }

@media (prefers-color-scheme: dark) {
	var[data-var-color] { --var-bg: #bc1a00; }
	var[data-var-color="1"] { --var-bg: #007f00; }
	var[data-var-color="2"] { --var-bg: #008698; }
	var[data-var-color="3"] { --var-bg: #7f5b2b; }
	var[data-var-color="4"] { --var-bg: #004df3; }
	var[data-var-color="5"] { --var-bg: #a1248a; }
	var[data-var-color="6"] { --var-vg: #ff0000; }
}
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72"> </a> </p>
   <h1>Reporting API</h1>
   <p id="w3c-state"><a href="https://www.w3.org/standards/types/#ED">Editor’s Draft</a>, <time class="dt-updated" datetime="2025-06-02">2 June 2025</time></p>
   <details open>
    <summary>More details about this document</summary>
    <div data-fill-with="spec-metadata">
     <dl>
      <dt>This version:
      <dd><a class="u-url" href="https://w3c.github.io/reporting/">https://w3c.github.io/reporting/</a>
      <dt>Latest published version:
      <dd><a href="https://www.w3.org/TR/reporting-1/">https://www.w3.org/TR/reporting-1/</a>
      <dt>Version History:
      <dd><a href="https://github.com/w3c/reporting/commits/main/index.src.html">https://github.com/w3c/reporting/commits/main/index.src.html</a>
      <dt>Feedback:
      <dd><a href="https://github.com/w3c/reporting/issues/">GitHub</a>
      <dd><a href="#issues-index">Inline In Spec</a>
      <dt class="editor">Editors:
      <dd class="editor p-author h-card vcard" data-editor-id="103120"><a class="p-name fn u-email email" href="mailto:dcreager@dcreager.net">Douglas Creager</a> (<span class="p-org org">GitHub</span>)
      <dd class="editor p-author h-card vcard" data-editor-id="76841"><a class="p-name fn u-email email" href="mailto:iclelland@google.com">Ian Clelland</a> (<span class="p-org org">Google Inc.</span>)
      <dd class="editor p-author h-card vcard" data-editor-id="56384"><a class="p-name fn u-email email" href="mailto:mkwst@google.com">Mike West</a> (<span class="p-org org">Google Inc.</span>)
      <dt class="editor">Former Editors:
      <dd class="editor p-author h-card vcard" data-editor-id="56102"><a class="p-name fn u-email email" href="mailto:igrigorik@google.com">Ilya Grigorik</a> (<span class="p-org org">Google Inc.</span>)
      <dd class="editor p-author h-card vcard" data-editor-id="99916"><a class="p-name fn u-email email" href="mailto:paulmeyer@google.com">Paul Meyer</a> (<span class="p-org org">Google Inc.</span>)
     </dl>
    </div>
   </details>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/policies/#copyright">Copyright</a> © 2025 <a href="https://www.w3.org/">World Wide Web Consortium</a>. <abbr title="World Wide Web Consortium">W3C</abbr><sup>®</sup> <a href="https://www.w3.org/policies/#Legal_Disclaimer">liability</a>, <a href="https://www.w3.org/policies/#W3C_Trademarks">trademark</a> and <a href="https://www.w3.org/copyright/software-license/" rel="license" title="W3C Software and Document License">permissive document license</a> rules apply. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>This document defines a generic reporting framework which allows web
developers to associate a set of named reporting endpoints with an origin.
Various platform features can use these endpoints to deliver
feature-specific reports in a consistent manner.</p>
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="sotd"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> This is a public copy of the editors’ draft.
	It is provided for discussion only and may change at any moment.
	Its publication here does not imply endorsement of its contents by W3C.
	Don’t cite this document other than as work in progress. </p>
   <p><a href="https://github.com/w3c/reporting/issues">GitHub Issues</a> are preferred for discussion of this specification. </p>
   <p>This document is governed by the <a href="https://www.w3.org/policies/process/20231103/" id="w3c_process_revision">03 November 2023 W3C Process Document</a>. </p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li>
     <a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ol class="toc">
      <li><a href="#guarantees"><span class="secno">1.1</span> <span class="content">Guarantees</span></a>
      <li><a href="#examples"><span class="secno">1.2</span> <span class="content">Examples</span></a>
     </ol>
    <li>
     <a href="#generic-reporting"><span class="secno">2</span> <span class="content">Generic Reporting Framework</span></a>
     <ol class="toc">
      <li>
       <a href="#concept"><span class="secno">2.1</span> <span class="content">Concepts</span></a>
       <ol class="toc">
        <li><a href="#concept-endpoints"><span class="secno">2.1.1</span> <span class="content">Endpoints</span></a>
        <li><a href="#concept-report-type"><span class="secno">2.1.2</span> <span class="content">Report Type</span></a>
        <li><a href="#concept-reports"><span class="secno">2.1.3</span> <span class="content">Reports</span></a>
       </ol>
      <li><a href="#media-type"><span class="secno">2.2</span> <span class="content">Media Type</span></a>
      <li><a href="#queue-report"><span class="secno">2.3</span> <span class="content"> Queue <var>data</var> as <var>type</var> for <var>destination</var> </span></a>
      <li><a href="#serialize-reports"><span class="secno">2.4</span> <span class="content">Serialize Reports</span></a>
     </ol>
    <li>
     <a href="#document-reporting"><span class="secno">3</span> <span class="content">Document Centered Reporting</span></a>
     <ol class="toc">
      <li><a href="#document-configuration"><span class="secno">3.1</span> <span class="content">Document configuration</span></a>
      <li><a href="#header"><span class="secno">3.2</span> <span class="content">The <code>Reporting-Endpoints</code> HTTP Response Header Field</span></a>
      <li><a href="#process-header"><span class="secno">3.3</span> <span class="content"> Process reporting endpoints for <var>response</var> </span></a>
      <li>
       <a href="#report-generation"><span class="secno">3.4</span> <span class="content">Report Generation</span></a>
       <ol class="toc">
        <li><a href="#generate-report"><span class="secno">3.4.1</span> <span class="content">Generate report of <var>type</var> with <var>data</var></span></a>
       </ol>
      <li>
       <a href="#report-delivery"><span class="secno">3.5</span> <span class="content">Report Delivery</span></a>
       <ol class="toc">
        <li><a href="#send-reports"><span class="secno">3.5.1</span> <span class="content">Send reports</span></a>
        <li><a href="#try-delivery"><span class="secno">3.5.2</span> <span class="content"> Attempt to deliver <var>reports</var> to <var>endpoint</var> </span></a>
       </ol>
      <li><a href="#strip-url-for-use-in-reports-heading"><span class="secno">3.6</span> <span class="content">Strip URL for use in reports</span></a>
     </ol>
    <li>
     <a href="#observers"><span class="secno">4</span> <span class="content">Reporting Observers</span></a>
     <ol class="toc">
      <li><a href="#interface-reporting-observer"><span class="secno">4.1</span> <span class="content">Interface <code class="idl"><span>ReportingObserver</span></code></span></a>
      <li><a href="#notify-observers"><span class="secno">4.2</span> <span class="content"> Notify reporting observers on <var>scope</var> with <var>report</var> </span></a>
      <li><a href="#add-report"><span class="secno">4.3</span> <span class="content"> Add <var>report</var> to <var>observer</var> </span></a>
      <li><a href="#invoke-observers"><span class="secno">4.4</span> <span class="content"> Invoke reporting observers with <var>notify list</var> </span></a>
     </ol>
    <li>
     <a href="#implementation"><span class="secno">5</span> <span class="content">Implementation Considerations</span></a>
     <ol class="toc">
      <li><a href="#delivery"><span class="secno">5.1</span> <span class="content">Delivery</span></a>
      <li><a href="#gc"><span class="secno">5.2</span> <span class="content">Garbage Collection</span></a>
     </ol>
    <li><a href="#sample-reports"><span class="secno">6</span> <span class="content">Sample Reports</span></a>
    <li>
     <a href="#automation"><span class="secno">7</span> <span class="content">Automation</span></a>
     <ol class="toc">
      <li><a href="#generate-test-report-command"><span class="secno">7.1</span> <span class="content">Generate Test Report</span></a>
     </ol>
    <li>
     <a href="#security"><span class="secno">8</span> <span class="content">Security Considerations</span></a>
     <ol class="toc">
      <li><a href="#capability-urls"><span class="secno">8.1</span> <span class="content">Capability URLs</span></a>
     </ol>
    <li>
     <a href="#privacy"><span class="secno">9</span> <span class="content">Privacy Considerations</span></a>
     <ol class="toc">
      <li><a href="#network-leakage"><span class="secno">9.1</span> <span class="content">Network Leakage</span></a>
      <li><a href="#fingerprinting-clock-skew"><span class="secno">9.2</span> <span class="content">Clock Skew</span></a>
      <li><a href="#correlation"><span class="secno">9.3</span> <span class="content">Cross-origin correlation</span></a>
      <li><a href="#disable"><span class="secno">9.4</span> <span class="content">Disabling Reporting</span></a>
     </ol>
    <li>
     <a href="#iana-considerations"><span class="secno">10</span> <span class="content">IANA Considerations</span></a>
     <ol class="toc">
      <li><a href="#header-field-registration"><span class="secno">10.1</span> <span class="content">The <code>Reporting-Endpoints</code> Header</span></a>
      <li><a href="#media-type-registration"><span class="secno">10.2</span> <span class="content">The <code>application/reports+json</code> Media Type</span></a>
     </ol>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ol>
  </nav>
  <main>
   <section>
    <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
    <p>This document provides three pieces of infrastructure for generic reporting,
  which may be used or extended by other specifications:</p>
    <ol>
     <li data-md>
      <p>A generic framework for defining report types and reporting endpoints, and
 a document format for sending reports to endpoints over HTTP.</p>
     <li data-md>
      <p>A specific mechanism for configuring reporting endpoints in a document or
 worker, and for delivering reports whose lifetime is tied to that document
 or worker.</p>
     <li data-md>
      <p>A JavaScript interface for observing reports generated within a document or
 worker.</p>
    </ol>
    <p>Other specifications may extend or make use of these pieces, for instance by
  defining concrete report types, or alternative configuration or delivery
  mechanisms for non-document-based reports.</p>
    <h3 class="heading settled" data-level="1.1" id="guarantees"><span class="secno">1.1. </span><span class="content">Guarantees</span><a class="self-link" href="#guarantees"></a></h3>
    <p>This specification aims to provide a best-effort report delivery system that
  executes out-of-band with website activity. The user agent will be able to do
  a better job prioritizing and scheduling delivery of reports, as it has an
  overview of cross-origin activity that individual websites do not, and can
  deliver reports based on error conditions that would prevent a website from
  loading in the first place.</p>
    <p>The delivery is not, however, guaranteed in any way, and reporting is not
  intended to be used as a reliable communications channel. Network conditions
  may prevent reports from reaching their destination at all, and user agents
  are permitted to reject and not deliver a report for any reason.</p>
    <h3 class="heading settled" data-level="1.2" id="examples"><span class="secno">1.2. </span><span class="content">Examples</span><a class="self-link" href="#examples"></a></h3>
    <div class="example" id="example-bd21f0f9">
     <a class="self-link" href="#example-bd21f0f9"></a> MegaCorp Inc. wants to collect Content Security Policy and Key Pinning
    violation reports. It can do so by delivering the following header to
    define a set of reporting endpoints named "<code>endpoint-1</code>": 
<pre><a data-link-type="dfn" href="#reporting-endpoints" id="ref-for-reporting-endpoints">Reporting-Endpoints</a>: endpoint-1="https://example.com/reports"
</pre>
     <p>And the following headers, which direct CSP and HPKP reports to that
    endpoint:</p>
<pre><a data-link-type="dfn" href="https://w3c.github.io/webappsec-csp/#content-security-policy" id="ref-for-content-security-policy">Content-Security-Policy</a>: ...; <a data-link-type="dfn" href="https://w3c.github.io/webappsec-csp/#directives-reporting" id="ref-for-directives-reporting">report-to</a> endpoint-1
<a data-link-type="dfn" href="https://tools.ietf.org/html/rfc7469#section-2.1" id="ref-for-section-2.1">Public-Key-Pins</a>: ...; report-to=endpoint-1
</pre>
    </div>
    <div class="example" id="example-b1cea891">
     <a class="self-link" href="#example-b1cea891"></a> After processing reports for a little while, MegaCorp Inc. decides to split
    the processing of these two types of reports out into two distinct endpoints
    in order to make the processing scripts simpler. It can do so by delivering
    the following header to define two reporting endpoints: 
<pre><a data-link-type="dfn" href="#reporting-endpoints" id="ref-for-reporting-endpoints①">Reporting-Endpoints</a>: csp-endpoint="https://example.com/csp-reports",
                     hpkp-endpoint="https://example.com/hpkp-reports"
</pre>
     <p>And the following headers, which direct CSP and HPKP reports to those named
    endpoints:</p>
<pre><a data-link-type="dfn" href="https://w3c.github.io/webappsec-csp/#content-security-policy" id="ref-for-content-security-policy①">Content-Security-Policy</a>: ...; <a data-link-type="dfn" href="https://w3c.github.io/webappsec-csp/#directives-reporting" id="ref-for-directives-reporting①">report-to</a> csp-endpoint
<a data-link-type="dfn" href="https://tools.ietf.org/html/rfc7469#section-2.1" id="ref-for-section-2.1①">Public-Key-Pins</a>: ...; report-to=hpkp-endpoint
</pre>
    </div>
   </section>
   <section>
    <h2 class="heading settled" data-level="2" id="generic-reporting"><span class="secno">2. </span><span class="content">Generic Reporting Framework</span><a class="self-link" href="#generic-reporting"></a></h2>
    <p class="informative"> This section defines the generic concepts of reports and endpoints, and how
  reports are serialized into the <a href="#media-type"><code>application/reports+json</code></a> format.</p>
    <h3 class="heading settled" data-level="2.1" id="concept"><span class="secno">2.1. </span><span class="content">Concepts</span><a class="self-link" href="#concept"></a></h3>
    <h4 class="heading settled" data-level="2.1.1" id="concept-endpoints"><span class="secno">2.1.1. </span><span class="content">Endpoints</span><a class="self-link" href="#concept-endpoints"></a></h4>
    <p>An <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="endpoint">endpoint</dfn> is location to which <a data-link-type="dfn" href="#windoworworkerglobalscope-reports" id="ref-for-windoworworkerglobalscope-reports">reports</a> for a
  particular <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#origin" id="ref-for-origin">origin</a> may be sent.</p>
    <p>Each <a data-link-type="dfn" href="#endpoint" id="ref-for-endpoint">endpoint</a> has a <dfn class="dfn-paneled idl-code" data-dfn-for="endpoint" data-dfn-type="attribute" data-export id="dom-endpoint-name"><code>name</code></dfn>, which is an ASCII string.</p>
    <p>Each <a data-link-type="dfn" href="#endpoint" id="ref-for-endpoint①">endpoint</a> has a <dfn class="dfn-paneled idl-code" data-dfn-for="endpoint" data-dfn-type="attribute" data-export id="dom-endpoint-url"><code>url</code></dfn>,
  which is a <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url">URL</a></code>.</p>
    <p>Each <a data-link-type="dfn" href="#endpoint" id="ref-for-endpoint②">endpoint</a> has a <dfn class="dfn-paneled idl-code" data-dfn-for="endpoint" data-dfn-type="attribute" data-export id="dom-endpoint-failures"><code>failures</code></dfn>, which is a non-negative
  integer representing the number of consecutive times this endpoint has failed
  to respond to a request.</p>
    <h4 class="heading settled" data-level="2.1.2" id="concept-report-type"><span class="secno">2.1.2. </span><span class="content">Report Type</span><a class="self-link" href="#concept-report-type"></a></h4>
    <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="report-type">report type</dfn> is a non-empty string that specifies the set
  of data that is contained in the <a data-link-type="dfn" href="#report-body" id="ref-for-report-body">body</a> of a <a data-link-type="dfn" href="#report" id="ref-for-report">report</a>.</p>
    <p>When a <a data-link-type="dfn" href="#report-type" id="ref-for-report-type">report type</a> is defined (in this spec or others), it can be
  specified to be <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="visible-to-reportingobservers">visible to <code>ReportingObserver</code>s</dfn>, meaning
  that <a data-link-type="dfn" href="#windoworworkerglobalscope-reports" id="ref-for-windoworworkerglobalscope-reports①">reports</a> of that type can be observed by a <a data-link-type="dfn" href="#reporting-observer" id="ref-for-reporting-observer">reporting
  observer</a>. By default, <a data-link-type="dfn" href="#report-type" id="ref-for-report-type①">report types</a> are not <a data-link-type="dfn" href="#visible-to-reportingobservers" id="ref-for-visible-to-reportingobservers">visible to <code>ReportingObserver</code>s</a>.</p>
    <h4 class="heading settled" data-level="2.1.3" id="concept-reports"><span class="secno">2.1.3. </span><span class="content">Reports</span><a class="self-link" href="#concept-reports"></a></h4>
    <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="report">report</dfn> is a collection of arbitrary data which the user
  agent is expected to deliver to a specified endpoint.</p>
    <p>Each <a data-link-type="dfn" href="#report" id="ref-for-report①">report</a> has a <dfn class="dfn-paneled" data-dfn-for="report" data-dfn-type="dfn" data-export id="report-body">body</dfn>, which is either <code>null</code> or an object which can be serialized into a <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8259#section-2" id="ref-for-section-2">JSON text</a>. The
  fields contained in a <a data-link-type="dfn" href="#report" id="ref-for-report②">report</a>’s <a data-link-type="dfn" href="#report-body" id="ref-for-report-body①">body</a> are determined by
  the <a data-link-type="dfn" href="#report" id="ref-for-report③">report</a>’s <a data-link-type="dfn" href="#report-reporttype" id="ref-for-report-reporttype">type</a>.</p>
    <p>Each <a data-link-type="dfn" href="#report" id="ref-for-report④">report</a> has a <dfn class="dfn-paneled" data-dfn-for="report" data-dfn-type="dfn" data-export id="report-url">url</dfn>, which
  is typically the address of the <code>Document</code> or <code>Worker</code> from which the report
  was generated.</p>
    <p class="note" role="note"><span class="marker">Note:</span> We strip the username, password, and fragment from this serialized URL.
  See <a href="#capability-urls">§ 8.1 Capability URLs</a>.</p>
    <p>Each <a data-link-type="dfn" href="#report" id="ref-for-report⑤">report</a> has a <dfn class="dfn-paneled" data-dfn-for="report" data-dfn-type="dfn" data-export id="report-user-agent">user agent</dfn>, which is
  the value of the <code>User-Agent</code> <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header" id="ref-for-concept-header">header</a> of the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request">request</a> from which the report was generated.</p>
    <p class="note" role="note"><span class="marker">Note:</span> The <a data-link-type="dfn" href="#report-user-agent" id="ref-for-report-user-agent">user agent</a> of a <a data-link-type="dfn" href="#report" id="ref-for-report⑥">report</a> represents the <code>User-Agent</code> sent by the browser for the page which generated the <a data-link-type="dfn" href="#report" id="ref-for-report⑦">report</a>.  This is potentially distinct from the <code>User-Agent</code> sent in the HTTP headers when uploading the report to a collector — for
  instance, where the browser has chosen to use a non-default <code>User-Agent</code> string such as the "request desktop site" feature.</p>
    <p>Each <a data-link-type="dfn" href="#report" id="ref-for-report⑧">report</a> has a <dfn class="dfn-paneled" data-dfn-for="report" data-dfn-type="dfn" data-export id="report-destination">destination</dfn>,
  which is a string representing the <code class="idl"><a data-link-type="idl" href="#dom-endpoint-name" id="ref-for-dom-endpoint-name">name</a></code> of the <a data-link-type="dfn" href="#endpoint" id="ref-for-endpoint③">endpoint</a> that the report will be sent to.</p>
    <p>Each <a data-link-type="dfn" href="#report" id="ref-for-report⑨">report</a> has a <dfn class="dfn-paneled" data-dfn-for="report" data-dfn-type="dfn" data-export id="report-reporttype">type</dfn>, which is a <a data-link-type="dfn" href="#report-type" id="ref-for-report-type②">report type</a>.</p>
    <p>Each <a data-link-type="dfn" href="#report" id="ref-for-report①⓪">report</a> has a <dfn class="dfn-paneled" data-dfn-for="report" data-dfn-type="dfn" data-export id="report-timestamp">timestamp</dfn>,
  which records the time at which the report was generated, in milliseconds
  since the unix epoch.</p>
    <p>Each <a data-link-type="dfn" href="#report" id="ref-for-report①①">report</a> has an <dfn class="dfn-paneled" data-dfn-for="report" data-dfn-type="dfn" data-export id="report-attempts">attempts</dfn> counter, which is a non-negative integer representing the number of times the
  user agent attempted to deliver the report.</p>
    <h3 class="heading settled" data-level="2.2" id="media-type"><span class="secno">2.2. </span><span class="content">Media Type</span><a class="self-link" href="#media-type"></a></h3>
    <p>The media type used when POSTing reports to a specified endpoint is <code>application/reports+json</code>.</p>
    <h3 class="heading settled algorithm" data-algorithm="Queue data as type for destination" data-level="2.3" id="queue-report"><span class="secno">2.3. </span><span class="content"> Queue <var>data</var> as <var>type</var> for <var>destination</var> </span><a class="self-link" href="#queue-report"></a></h3>
    <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="generate-a-report">generate a report</dfn> given a
  serializable object (<var>data</var>), a string (<var>type</var>), another string
  (<var>destination</var>), an optional <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object">environment settings object</a> (<var>settings</var>), and an optional <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url①">URL</a></code> (<var>url</var>):</p>
    <ol>
     <li data-md>
      <p>Let <var>report</var> be a new <a data-link-type="dfn" href="#report" id="ref-for-report①②">report</a> object with its values initialized as
  follows:</p>
      <dl>
       <dt data-md><a data-link-type="dfn" href="#report-body" id="ref-for-report-body②">body</a>
       <dd data-md>
        <p><var>data</var></p>
       <dt data-md><a data-link-type="dfn" href="#report-user-agent" id="ref-for-report-user-agent①">user agent</a>
       <dd data-md>
        <p>The current value of <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/system-state.html#dom-navigator-useragent" id="ref-for-dom-navigator-useragent"><code>navigator.userAgent</code></a></p>
       <dt data-md><a data-link-type="dfn" href="#report-destination" id="ref-for-report-destination">destination</a>
       <dd data-md>
        <p><var>destination</var></p>
       <dt data-md><a data-link-type="dfn" href="#report-reporttype" id="ref-for-report-reporttype①">type</a>
       <dd data-md>
        <p><var>type</var></p>
       <dt data-md><a data-link-type="dfn" href="#report-timestamp" id="ref-for-report-timestamp">timestamp</a>
       <dd data-md>
        <p>The current timestamp.</p>
       <dt data-md><a data-link-type="dfn" href="#report-attempts" id="ref-for-report-attempts">attempts</a>
       <dd data-md>
        <p>0</p>
      </dl>
     <li data-md>
      <p>If <var>url</var> was not provided by the caller, let <var>url</var> be <var>settings</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#creation-url" id="ref-for-creation-url">creation URL</a>.</p>
     <li data-md>
      <p>Set <var>url</var>’s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#dom-url-username" id="ref-for-dom-url-username">username</a></code> to the empty string, and its <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#dom-url-password" id="ref-for-dom-url-password">password</a></code> to <code>null</code>.</p>
     <li data-md>
      <p>Set <var>report</var>’s <a data-link-type="dfn" href="#report-url" id="ref-for-report-url">url</a> to the result of executing the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-serializer" id="ref-for-concept-url-serializer">URL
  serializer</a> on <var>url</var> with the <em>exclude fragment flag</em> set.</p>
     <li data-md>
      <p>Return <var>report</var>.</p>
    </ol>
    <p class="note" role="note"><span class="marker">Note:</span> <a data-link-type="dfn" href="#reporting-observer" id="ref-for-reporting-observer①">reporting observers</a> can only observe reports from the
  same <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object①">environment settings object</a>.</p>
    <p class="note" role="note"><span class="marker">Note:</span> We strip the username, password, and fragment from the serialized URL
  in the report. See <a href="#capability-urls">§ 8.1 Capability URLs</a>.</p>
    <p class="note" role="note"><span class="marker">Note:</span> The user agent MAY reject reports for any reason. This API does not
  guarantee delivery of arbitrary amounts of data, for instance.</p>
    <p class="note" role="note"><span class="marker">Note:</span> Non user agent clients (with no JavaScript engine) should not interact
  with <a data-link-type="dfn" href="#reporting-observer" id="ref-for-reporting-observer②">reporting observers</a>, and thus should return in step 6.</p>
    <h3 class="heading settled algorithm" data-algorithm="Serialize Reports" data-level="2.4" id="serialize-reports"><span class="secno">2.4. </span><span class="content">Serialize Reports</span><a class="self-link" href="#serialize-reports"></a></h3>
    <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="serialize-a-list-of-reports-to-json">serialize a list of <var>reports</var> to JSON</dfn>,</p>
    <ol>
     <li data-md>
      <p>Let <var>collection</var> be an empty list.</p>
     <li data-md>
      <p>For each <var>report</var> in <var>reports</var>:</p>
      <ol>
       <li data-md>
        <p>Let <var>data</var> be a map with the following key/value pairs:</p>
        <dl>
         <dt data-md><code>age</code>
         <dd data-md>
          <p>The number of milliseconds between <var>report</var>’s <a data-link-type="dfn" href="#report-timestamp" id="ref-for-report-timestamp①">timestamp</a> and the current time.</p>
         <dt data-md><code>type</code>
         <dd data-md>
          <p><var>report</var>’s <a data-link-type="dfn" href="#report-reporttype" id="ref-for-report-reporttype②">type</a></p>
         <dt data-md><code>url</code>
         <dd data-md>
          <p><var>report</var>’s <a data-link-type="dfn" href="#report-url" id="ref-for-report-url①">url</a></p>
         <dt data-md><code>user_agent</code>
         <dd data-md>
          <p><var>report</var>’s <a data-link-type="dfn" href="#report-user-agent" id="ref-for-report-user-agent②">user agent</a></p>
         <dt data-md><code>body</code>
         <dd data-md>
          <p><var>report</var>’s <a data-link-type="dfn" href="#report-body" id="ref-for-report-body③">body</a></p>
        </dl>
        <p class="note" role="note"><span class="marker">Note:</span> Client clocks are unreliable and subject to skew. We therefore
  deliver an <code>age</code> attribute rather than an absolute timestamp. See
  also <a href="#fingerprinting-clock-skew">§ 9.2 Clock Skew</a></p>
       <li data-md>
        <p>Increment <var>report</var>’s <a data-link-type="dfn" href="#report-attempts" id="ref-for-report-attempts①">attempts</a>.</p>
       <li data-md>
        <p>Append <var>data</var> to <var>collection</var>.</p>
      </ol>
     <li data-md>
      <p>Return the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence">byte sequence</a> resulting from executing <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#serialize-an-infra-value-to-json-bytes" id="ref-for-serialize-an-infra-value-to-json-bytes">serialize an Infra value to JSON bytes</a> on <var>collection</var>.</p>
    </ol>
   </section>
   <section>
    <h2 class="heading settled" data-level="3" id="document-reporting"><span class="secno">3. </span><span class="content">Document Centered Reporting</span><a class="self-link" href="#document-reporting"></a></h2>
    <p>This section defines the mechanism for configuring reporting endpoints for
  reports generated by actions in a document (or in a worker script). Such
  reports have a lifetime which is tied to that of the document or worker where
  they were generated.</p>
    <h3 class="heading settled" data-level="3.1" id="document-configuration"><span class="secno">3.1. </span><span class="content">Document configuration</span><a class="self-link" href="#document-configuration"></a></h3>
    <p>Each object implementing <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope" id="ref-for-windoworworkerglobalscope">WindowOrWorkerGlobalScope</a></code> has an <dfn class="dfn-paneled" data-dfn-for="WindowOrWorkerGlobalScope" data-dfn-type="dfn" data-export id="windoworworkerglobalscope-endpoints">endpoints</dfn> list, which
  is a list of <a data-link-type="dfn" href="#endpoint" id="ref-for-endpoint④">endpoints</a>, each of which MUST have a distinct <code class="idl"><a data-link-type="idl" href="#dom-endpoint-name" id="ref-for-dom-endpoint-name①">name</a></code>.  (Uniqueness is guaranteed by the algorithm in <a href="#process-header">§ 3.3 Process reporting endpoints for response</a>.)</p>
    <p>Each object implementing <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope" id="ref-for-windoworworkerglobalscope①">WindowOrWorkerGlobalScope</a></code> has an <dfn class="dfn-paneled" data-dfn-for="WindowOrWorkerGlobalScope" data-dfn-type="dfn" data-export id="windoworworkerglobalscope-reports">reports</dfn> list, which is
  a list of <a data-link-type="dfn" href="#report" id="ref-for-report①③">reports</a>.</p>
    <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="initialize-a-globals-endpoint-list">initialize a global’s endpoint list</dfn>, given a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope" id="ref-for-windoworworkerglobalscope②">WindowOrWorkerGlobalScope</a></code> (<var>scope</var>) and a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response">response</a> (<var>response</var>),
  set <var>scope</var>’s <a data-link-type="dfn" href="#windoworworkerglobalscope-endpoints" id="ref-for-windoworworkerglobalscope-endpoints">endpoints</a> to the result
  of executing <a href="#process-header">§ 3.3 Process reporting endpoints for response</a> given <var>response</var>.</p>
    <h3 class="heading settled" data-level="3.2" id="header"><span class="secno">3.2. </span><span class="content">The <code>Reporting-Endpoints</code> HTTP Response Header Field</span><a class="self-link" href="#header"></a></h3>
    <p>A server MAY define a set of reporting endpoints for a document or a worker
  script resource it returns, via the <a data-link-type="dfn" href="#reporting-endpoints" id="ref-for-reporting-endpoints②"><code>Reporting-Endpoints</code></a> HTTP response
  header field. This mechanism is defined in <a href="#header">§ 3.2 The Reporting-Endpoints HTTP Response Header Field</a>, and its processing in <a href="#process-header">§ 3.3 Process reporting endpoints for response</a>.</p>
    <p>The value of the <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="reporting-endpoints"><code>Reporting-Endpoints</code></dfn> HTTP response header
  field is used to construct the reporting configuration for a resource.</p>
    <p><a data-link-type="dfn" href="#reporting-endpoints" id="ref-for-reporting-endpoints③"><code>Reporting-Endpoints</code></a> is a Dictionary Structured Field <a data-link-type="biblio" href="#biblio-structured-fields" title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</a>. Each entry in the dictionary defines an <a data-link-type="dfn" href="#endpoint" id="ref-for-endpoint⑤">endpoint</a> to which reports may be delivered. The entry value MUST be a
  string.</p>
    <p>Each <a data-link-type="dfn" href="#endpoint" id="ref-for-endpoint⑥">endpoint</a> is defined by a String Item, which is interpreted as a
  URI-reference. If its value is not a valid URI-reference, that <a data-link-type="dfn" href="#endpoint" id="ref-for-endpoint⑦">endpoint</a> member MUST be ignored.</p>
    <p>Moreover, the URL that the member’s value represents MUST be <a data-link-type="dfn" href="https://w3c.github.io/webappsec-secure-contexts/#is-origin-trustworthy" id="ref-for-is-origin-trustworthy">potentially
  trustworthy</a> <a data-link-type="biblio" href="#biblio-secure-contexts" title="Secure Contexts">[SECURE-CONTEXTS]</a>. Non-secure endpoints will be ignored.</p>
    <p>No parameters are defined for <a data-link-type="dfn" href="#endpoint" id="ref-for-endpoint⑧">endpoints</a>, and any parameters
  which are specified will be silently ignored.</p>
    <p>The header is represented by the following ABNF grammar <a data-link-type="biblio" href="#biblio-rfc5234" title="Augmented BNF for Syntax Specifications: ABNF">[RFC5234]</a>:</p>
<pre class="abnf">Reporting-Endpoints = <a data-link-type="grammar" href="https://www.rfc-editor.org/rfc/rfc8941.html#section-3.2" id="ref-for-section-3.2">sf-dictionary</a>
</pre>
    <h3 class="heading settled algorithm" data-algorithm="Process reporting endpoints for response" data-level="3.3" id="process-header"><span class="secno">3.3. </span><span class="content"> Process reporting endpoints for <var>response</var> </span><a class="self-link" href="#process-header"></a></h3>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response①">response</a> (<var>response</var>), this algorithm extracts and returns a
  list of <a data-link-type="dfn" href="#endpoint" id="ref-for-endpoint⑨">endpoints</a>.</p>
    <ol>
     <li data-md>
      <p>Abort these steps if <var>response</var>’s <a class="idl-code" data-link-type="attribute" href="https://fetch.spec.whatwg.org/#concept-response-https-state" id="ref-for-concept-response-https-state">HTTPS
  state</a> is not "<code>modern</code>", and the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin">origin</a> of <var>response</var>’s <a class="idl-code" data-link-type="attribute" href="https://fetch.spec.whatwg.org/#concept-response-url" id="ref-for-concept-response-url">url</a> is not <a data-link-type="dfn" href="https://w3c.github.io/webappsec-secure-contexts/#is-origin-trustworthy" id="ref-for-is-origin-trustworthy①">potentially
  trustworthy</a>.</p>
     <li data-md>
      <p>Let <var>parsed header</var> be the result of executing <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list-get-structured-header" id="ref-for-concept-header-list-get-structured-header">get a structured field value</a> given "Reporting-Endpoints" and "dictionary" from <var>response</var>’s <a class="idl-code" data-link-type="attribute" href="https://fetch.spec.whatwg.org/#concept-response-header-list" id="ref-for-concept-response-header-list">header list</a>.</p>
     <li data-md>
      <p>If <var>parsed header</var> is null, abort these steps.</p>
     <li data-md>
      <p>Let <var>endpoints</var> be an empty list.</p>
     <li data-md>
      <p>For each <var>name</var> → <var>value_and_parameters</var> of <var>parsed header</var>:</p>
      <ol>
       <li data-md>
        <p>Let <var>endpoint url string</var> be the first element of the tuple <var>value_and_parameters</var>. If <var>endpoint url string</var> is not a string,
  then <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-continue" id="ref-for-iteration-continue">continue</a>.</p>
       <li data-md>
        <p>Let <var>endpoint url</var> be the result of executing the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-parser" id="ref-for-concept-url-parser">URL parser</a> on <var>endpoint url string</var>, with <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-base-url" id="ref-for-concept-base-url">base URL</a> set to <var>response</var>’s <a class="idl-code" data-link-type="attribute" href="https://fetch.spec.whatwg.org/#concept-response-url" id="ref-for-concept-response-url①">url</a>. If <var>endpoint url</var> is
  failure, then <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-continue" id="ref-for-iteration-continue①">continue</a>.</p>
       <li data-md>
        <p>If <var>endpoint url</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#origin" id="ref-for-origin①">origin</a> is not <a data-link-type="dfn" href="https://w3c.github.io/webappsec-secure-contexts/#is-origin-trustworthy" id="ref-for-is-origin-trustworthy②">potentially
  trustworthy</a>, then <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-continue" id="ref-for-iteration-continue②">continue</a>.</p>
       <li data-md>
        <p>Let <var>endpoint</var> be a new <a data-link-type="dfn" href="#endpoint" id="ref-for-endpoint①⓪">endpoint</a> whose properties are set
      as follows:</p>
        <dl>
         <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-endpoint-name" id="ref-for-dom-endpoint-name②">name</a></code>
         <dd data-md>
          <p><var>name</var></p>
         <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-endpoint-url" id="ref-for-dom-endpoint-url">url</a></code>
         <dd data-md>
          <p><var>endpoint url</var></p>
         <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-endpoint-failures" id="ref-for-dom-endpoint-failures">failures</a></code>
         <dd data-md>
          <p>0</p>
        </dl>
       <li data-md>
        <p>Add <var>endpoint</var> to <var>endpoints</var>.</p>
      </ol>
     <li data-md>
      <p>Return <var>endpoints</var>.</p>
    </ol>
    <h3 class="heading settled" data-level="3.4" id="report-generation"><span class="secno">3.4. </span><span class="content">Report Generation</span><a class="self-link" href="#report-generation"></a></h3>
    <h4 class="heading settled algorithm" data-algorithm="Generate report of type with
  data" data-export data-level="3.4.1" id="generate-report"><span class="secno">3.4.1. </span><span class="content">Generate report of <var>type</var> with <var>data</var></span><a class="self-link" href="#generate-report"></a></h4>
    <p>When the user agent is to <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="generate-and-queue-a-report">generate and queue a report</dfn> for a <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document">Document</a></code> or <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope" id="ref-for-workerglobalscope">WorkerGlobalScope</a></code> object (<dfn class="dfn-paneled" data-dfn-for="generate and queue a report" data-dfn-type="dfn" data-export id="generate-and-queue-a-report-context"><var>context</var></dfn>),
  given a string (<dfn class="dfn-paneled" data-dfn-for="generate and queue a report" data-dfn-type="dfn" data-export id="generate-and-queue-a-report-type"><var>type</var></dfn>),
  a string (<dfn class="dfn-paneled" data-dfn-for="generate and queue a report" data-dfn-type="dfn" data-export id="generate-and-queue-a-report-destination"><var>destination</var></dfn>), and
  a serializable object (<dfn class="dfn-paneled" data-dfn-for="generate and queue a report" data-dfn-type="dfn" data-export id="generate-and-queue-a-report-data"><var>data</var></dfn>),
  it must run the following steps:</p>
    <ol>
     <li data-md>
      <p>Let <var>settings</var> be <var>context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object">relevant settings object</a>.</p>
     <li data-md>
      <p>Let <var>report</var> be the result of running <a data-link-type="dfn" href="#generate-a-report" id="ref-for-generate-a-report">generate a report</a> with <var>data</var>, <var>type</var>, <var>destination</var> and <var>settings</var>.</p>
     <li data-md>
      <p>If <var>settings</var> is given, then</p>
      <ol>
       <li data-md>
        <p>Let <var>scope</var> be <var>settings</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global" id="ref-for-concept-settings-object-global">global object</a>.</p>
       <li data-md>
        <p>If <var>scope</var> is an object implementing <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope" id="ref-for-windoworworkerglobalscope③">WindowOrWorkerGlobalScope</a></code>,
  then execute <a href="#notify-observers">§ 4.2 Notify reporting observers on scope with report</a> with <var>scope</var> and <var>report</var>.</p>
      </ol>
     <li data-md>
      <p>Append <var>report</var> to <var>context</var>’s <a data-link-type="dfn" href="#windoworworkerglobalscope-reports" id="ref-for-windoworworkerglobalscope-reports②">reports</a>.</p>
    </ol>
    <h3 class="heading settled" data-level="3.5" id="report-delivery"><span class="secno">3.5. </span><span class="content">Report Delivery</span><a class="self-link" href="#report-delivery"></a></h3>
    <p>Over time, various features will queue up a list of <a data-link-type="dfn" href="#windoworworkerglobalscope-reports" id="ref-for-windoworworkerglobalscope-reports③">reports</a> in
  documents and workers. The user agent will periodically grab the list of
  currently queued reports, and deliver them to the associated endpoints. This
  document does not define a schedule for the user agent to follow, and assumes
  that the user agent will have enough contextual information to deliver reports
  in a timely manner, balanced against impacting a user’s experience.</p>
    <p>That said, a user agent SHOULD make an effort to deliver reports as soon as
  possible after queuing, as a report’s data might be significantly more useful
  in the period directly after its generation than it would be a day or a week
  later.</p>
    <h4 class="heading settled algorithm" data-algorithm="Send reports" data-level="3.5.1" id="send-reports"><span class="secno">3.5.1. </span><span class="content">Send reports</span><a class="self-link" href="#send-reports"></a></h4>
    <p>A user agent sends a list of <a data-link-type="dfn" href="#windoworworkerglobalscope-reports" id="ref-for-windoworworkerglobalscope-reports④">reports</a> (<var>reports</var>) for <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope" id="ref-for-windoworworkerglobalscope④">WindowOrWorkerGlobalScope</a></code> object (<var>context</var>) by executing the following
  steps:</p>
    <ol>
     <li data-md>
      <p>Let <var>endpoint map</var> be an empty map of <a data-link-type="dfn" href="#endpoint" id="ref-for-endpoint①①">endpoint</a> objects to lists of <a data-link-type="dfn" href="#report" id="ref-for-report①④">report</a> objects.</p>
     <li data-md>
      <p>For each <var>report</var> in <var>reports</var>:</p>
      <ol>
       <li data-md>
        <p>If there exists an <a data-link-type="dfn" href="#endpoint" id="ref-for-endpoint①②">endpoint</a> (<var>endpoint</var>) in <var>context</var>’s <a data-link-type="dfn" href="#windoworworkerglobalscope-endpoints" id="ref-for-windoworworkerglobalscope-endpoints①">endpoints</a> list whose <code class="idl"><a data-link-type="idl" href="#dom-endpoint-name" id="ref-for-dom-endpoint-name③">name</a></code> is <var>report</var>’s <a data-link-type="dfn" href="#report-destination" id="ref-for-report-destination①">destination</a>:</p>
        <ol>
         <li data-md>
          <p>Append <var>report</var> to <var>endpoint map</var>’s list of reports for <var>endpoint</var>.</p>
         <li data-md>
          <p>Otherwise, remove <var>report</var> from <var>reports</var>.</p>
        </ol>
      </ol>
     <li data-md>
      <p>For each (<var>endpoint</var>, <var>report list</var>) pair in <var>endpoint map</var>:</p>
      <ol>
       <li data-md>
        <p>Let <var>origin map</var> be an empty map of <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#origin" id="ref-for-origin②">origins</a> to
  lists of <a data-link-type="dfn" href="#report" id="ref-for-report①⑤">report</a> objects.</p>
       <li data-md>
        <p>For each <var>report</var> in <var>report list</var>:</p>
        <ol>
         <li data-md>
          <p>Let <var>origin</var> be the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#origin" id="ref-for-origin③">origin</a> of <var>report</var>’s <a data-link-type="dfn" href="#report-url" id="ref-for-report-url②">url</a>.</p>
         <li data-md>
          <p>Append <var>report</var> to <var>origin map</var>’s list of reports for <var>origin</var>.</p>
        </ol>
       <li data-md>
        <p>For each (<var>origin</var>, <var>per-origin reports</var>) pair in <var>origin map</var>,
  execute the following steps asynchronously:</p>
        <ol>
         <li data-md>
          <p>Let <var>result</var> be the result of executing <a href="#try-delivery">§ 3.5.2 Attempt to deliver reports to endpoint</a> on <var>endpoint</var>, <var>origin</var>, and <var>per-origin reports</var>.</p>
         <li data-md>
          <p>If <var>result</var> is "<code>Failure</code>":</p>
          <ol>
           <li data-md>
            <p>Increment <var>endpoint</var>’s <code class="idl"><a data-link-type="idl" href="#dom-endpoint-failures" id="ref-for-dom-endpoint-failures①">failures</a></code>.</p>
          </ol>
         <li data-md>
          <p>If <var>result</var> is "<code>Remove Endpoint</code>":</p>
          <ol>
           <li data-md>
            <p>Remove <var>endpoint</var> from <var>context</var>’s <a data-link-type="dfn" href="#windoworworkerglobalscope-endpoints" id="ref-for-windoworworkerglobalscope-endpoints②">endpoints</a> list.</p>
          </ol>
         <li data-md>
          <p>Remove each <a data-link-type="dfn" href="#report" id="ref-for-report①⑥">report</a> from <var>reports</var>.</p>
        </ol>
        <p class="issue" id="issue-7f6dd3bd"><a class="self-link" href="#issue-7f6dd3bd"></a> We don’t specify any retry mechanism here for failed reports.
  We may want to add one here, or provide some indication that the
  delivery failed.</p>
      </ol>
    </ol>
    <p class="note" role="note"><span class="marker">Note:</span> User agents MAY decide to attempt delivery for only a subset of the
  collected reports or endpoints (because, for example, sending all the reports
  at once would consume an unreasonable amount of bandwidth, etc). As reports
  are only removed from the cache after delivery has been attempted, skipped
  reports will simply be delivered later.</p>
    <h4 class="heading settled algorithm" data-algorithm="Attempt to deliver reports to endpoint" data-level="3.5.2" id="try-delivery"><span class="secno">3.5.2. </span><span class="content"> Attempt to deliver <var>reports</var> to <var>endpoint</var> </span><a class="self-link" href="#try-delivery"></a></h4>
    <p>Given an <a data-link-type="dfn" href="#endpoint" id="ref-for-endpoint①③">endpoint</a> (<var>endpoint</var>), an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#origin" id="ref-for-origin④">origin</a> (<var>origin</var>), and a list of <a data-link-type="dfn" href="#windoworworkerglobalscope-reports" id="ref-for-windoworworkerglobalscope-reports⑤">reports</a> (<var>reports</var>), this algorithm will
  construct a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request①">request</a>, and attempt to deliver it to <var>endpoint</var>. It
  returns "<code>Success</code>" if that delivery succeeds, "<code>Remove Endpoint</code>" if the
  endpoint explicitly removes itself as a reporting endpoint by sending a 410
  response, and "<code>Failure</code>" otherwise.</p>
    <ol>
     <li data-md>
      <p>Let <var>body</var> be the result of executing <a data-link-type="dfn" href="#serialize-a-list-of-reports-to-json" id="ref-for-serialize-a-list-of-reports-to-json">serialize a list of reports to JSON</a> on <var>reports</var>.</p>
     <li data-md>
      <p>Let <var>request</var> be a new <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request②">request</a> with the following properties <a data-link-type="biblio" href="#biblio-fetch" title="Fetch Standard">[FETCH]</a>:</p>
      <dl>
       <dt data-md><code>method</code>
       <dd data-md>
        <p>"<code>POST</code>"</p>
       <dt data-md><code>url</code>
       <dd data-md>
        <p><var>endpoint</var>’s <code class="idl"><a data-link-type="idl" href="#dom-endpoint-url" id="ref-for-dom-endpoint-url①">url</a></code></p>
       <dt data-md><code>origin</code>
       <dd data-md>
        <p><var>origin</var></p>
       <dt data-md><code>header list</code>
       <dd data-md>
        <p>A new <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list" id="ref-for-concept-header-list">header list</a> containing a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header" id="ref-for-concept-header①">header</a> named
  `<code>Content-Type</code>` whose value is `<code>application/reports+json</code>`</p>
       <dt data-md><code>client</code>
       <dd data-md>
        <p><code>null</code></p>
       <dt data-md><code>window</code>
       <dd data-md>
        <p>"<code>no-window</code>"</p>
       <dt data-md><code>service-workers mode</code>
       <dd data-md>
        <p>"<code>none</code>"</p>
       <dt data-md><code>initiator</code>
       <dd data-md>
        <p>""</p>
       <dt data-md><code>destination</code>
       <dd data-md>
        <p>"<code>report</code>"</p>
       <dt data-md><code>mode</code>
       <dd data-md>
        <p>"<code>cors</code>"</p>
       <dt data-md><code>unsafe-request</code> flag
       <dd data-md>
        <p>set</p>
       <dt data-md><code>credentials</code>
       <dd data-md>
        <p>"<code>same-origin</code>"</p>
       <dt data-md><code>body</code>
       <dd data-md>
        <p>A <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-body" id="ref-for-concept-body">body</a> whose <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-body-source" id="ref-for-concept-body-source">source</a> is <var>body</var>.</p>
      </dl>
      <p class="note" role="note"><span class="marker">Note:</span> Reports are sent with credentials set to <code>same-origin</code>. This allows
  reporting endpoints which are same-origin with the reporting page to get
  extra context about the nature of the report: for example, to understand
  whether a given user’s account is triggering errors consistently, or if a
  certain sequence of actions taken on other pages is triggering a report on
  this page. This does not leak any new information to the reporting
  endpoint that it could not obtain in other ways. That is not the case for
  cross-origin reporting endpoints, so they do not receive credentials.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task" id="ref-for-queue-a-task">Queue a task</a> to <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-fetch" id="ref-for-concept-fetch">fetch</a> <var>request</var>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#wait-for-a-response" id="ref-for-wait-for-a-response">Wait for a response</a> (<var>response</var>).</p>
     <li data-md>
      <p>If <var>response</var>’s <code>status</code> is an <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#ok-status" id="ref-for-ok-status">OK status</a> (200-299), return
  "<code>Success</code>".</p>
     <li data-md>
      <p>If <var>response</var>’s <code>status</code> is <code>410 Gone</code> <a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a>, return "<code>Remove       Endpoint</code>".</p>
     <li data-md>
      <p>Return "<code>Failure</code>".</p>
    </ol>
    <h3 class="heading settled" data-level="3.6" id="strip-url-for-use-in-reports-heading"><span class="secno">3.6. </span><span class="content">Strip URL for use in reports</span><a class="self-link" href="#strip-url-for-use-in-reports-heading"></a></h3>
     To <dfn class="dfn-paneled algorithm" data-algorithm="strip URL for use in reports" data-dfn-type="dfn" data-export id="strip-url-for-use-in-reports">strip URL for use in reports</dfn> given a <a data-link-type="dfn" data-refhint-key="https://url.spec.whatwg.org/#concept-url" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url②">URL</a> <var>url</var>,
  perform the following steps. They return a string representing the URL for use in reports. 
    <ol>
     <li data-md>
      <p>If <var>url</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme" id="ref-for-concept-url-scheme">scheme</a> is not an <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#http-scheme" id="ref-for-http-scheme">HTTP(S) scheme</a>,
 then return <var>url</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme" id="ref-for-concept-url-scheme①">scheme</a>.</p>
     <li data-md>
      <p>Set <var>url</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-fragment" id="ref-for-concept-url-fragment">fragment</a> to the empty string.</p>
     <li data-md>
      <p>Set <var>url</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-username" id="ref-for-concept-url-username">username</a> to the empty string.</p>
     <li data-md>
      <p>Set <var>url</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-password" id="ref-for-concept-url-password">password</a> to the empty string.</p>
     <li data-md>
      <p>Return the result of executing the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-serializer" id="ref-for-concept-url-serializer①">URL serializer</a> on <var>url</var>.</p>
    </ol>
   </section>
   <section>
    <h2 class="heading settled" data-level="4" id="observers"><span class="secno">4. </span><span class="content">Reporting Observers</span><a class="self-link" href="#observers"></a></h2>
    <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="reporting-observer">reporting observer</dfn> observes some types of <a data-link-type="dfn" href="#windoworworkerglobalscope-reports" id="ref-for-windoworworkerglobalscope-reports⑥">reports</a> from
  JavaScript, and is represented in JavaScript by the <code class="idl"><a data-link-type="idl" href="#reportingobserver" id="ref-for-reportingobserver">ReportingObserver</a></code> object.</p>
    <p>Each object implementing <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope" id="ref-for-windoworworkerglobalscope⑤">WindowOrWorkerGlobalScope</a></code> has a <dfn class="dfn-paneled" data-dfn-for="WindowOrWorkerGlobalScope" data-dfn-type="dfn" data-noexport id="windoworworkerglobalscope-registered-reporting-observer-list">registered reporting observer list</dfn>,
  which is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set">ordered set</a> of <a data-link-type="dfn" href="#reporting-observer" id="ref-for-reporting-observer③">reporting observers</a>.</p>
    <p>Any <a data-link-type="dfn" href="#reporting-observer" id="ref-for-reporting-observer④">reporting observer</a> that is in a <a data-link-type="dfn" href="#windoworworkerglobalscope-registered-reporting-observer-list" id="ref-for-windoworworkerglobalscope-registered-reporting-observer-list">registered reporting observer
  list</a> is considered <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="registered">registered</dfn>.</p>
    <p>Each object implementing <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope" id="ref-for-windoworworkerglobalscope⑥">WindowOrWorkerGlobalScope</a></code> has a <dfn class="dfn-paneled" data-dfn-for="WindowOrWorkerGlobalScope" data-dfn-type="dfn" data-noexport id="windoworworkerglobalscope-report-buffer">report buffer</dfn>, which is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list">list</a> of <a data-link-type="dfn" href="#windoworworkerglobalscope-reports" id="ref-for-windoworworkerglobalscope-reports⑦">reports</a> that have been generated in that <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope" id="ref-for-windoworworkerglobalscope⑦">WindowOrWorkerGlobalScope</a></code>. This list is initially empty, and the reports
  are stored in the same order in which they are generated.</p>
    <p class="note" role="note"><span class="marker">Note:</span> The purpose of the <a data-link-type="dfn" href="#windoworworkerglobalscope-report-buffer" id="ref-for-windoworworkerglobalscope-report-buffer">report buffer</a> is to allow <a data-link-type="dfn" href="#reporting-observer" id="ref-for-reporting-observer⑤">reporting
  observers</a> to observe reports that were generated earlier than that
  observer could be created (via the <code class="idl"><a data-link-type="idl" href="#dom-reportingobserveroptions-buffered" id="ref-for-dom-reportingobserveroptions-buffered">buffered</a></code> option). For example, some
  reports might be generated during an earlier stage of page loading than when
  an observer could first be created, or before a JavaScript library is loaded
  that wishes to observe these reports.</p>
    <p class="note" role="note"><span class="marker">Note:</span> <a data-link-type="dfn" href="#reporting-observer" id="ref-for-reporting-observer⑥">Reporting observers</a> are only relevant for user agents with
  JavaScript engines.</p>
    <h3 class="heading settled" data-level="4.1" id="interface-reporting-observer"><span class="secno">4.1. </span><span class="content">Interface <code class="idl"><a data-link-type="idl" href="#reportingobserver" id="ref-for-reportingobserver①">ReportingObserver</a></code></span><a class="self-link" href="#interface-reporting-observer"></a></h3>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->)]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="reportbody"><code><c- g>ReportBody</c-></code></dfn> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Default" id="ref-for-Default"><c- g>Default</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-object" id="ref-for-idl-object"><c- b>object</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="ReportBody" data-dfn-type="method" data-export data-lt="toJSON()" id="dom-reportbody-tojson"><code><c- g>toJSON</c-></code></dfn>();
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed①"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->)]
<c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="#dom-report" id="ref-for-dom-report"><c- g>Report</c-></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Default" id="ref-for-Default①"><c- g>Default</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-object" id="ref-for-idl-object①"><c- b>object</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="Report" data-dfn-type="method" data-export data-lt="toJSON()" id="dom-report-tojson"><code><c- g>toJSON</c-></code></dfn>();
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMString" href="#dom-report-type" id="ref-for-dom-report-type"><c- g>type</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMString" href="#dom-report-url" id="ref-for-dom-report-url"><c- g>url</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#reportbody" id="ref-for-reportbody"><c- n>ReportBody</c-></a>? <a class="idl-code" data-link-type="attribute" data-readonly data-type="ReportBody?" href="#dom-report-body" id="ref-for-dom-report-body"><c- g>body</c-></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed②"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->)]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="reportingobserver"><code><c- g>ReportingObserver</c-></code></dfn> {
  <a class="idl-code" data-link-type="constructor" href="#dom-reportingobserver-reportingobserver" id="ref-for-dom-reportingobserver-reportingobserver"><c- g>constructor</c-></a>(<a data-link-type="idl-name" href="#callbackdef-reportingobservercallback" id="ref-for-callbackdef-reportingobservercallback"><c- n>ReportingObserverCallback</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="ReportingObserver/ReportingObserver(callback, options), ReportingObserver/constructor(callback, options), ReportingObserver/ReportingObserver(callback), ReportingObserver/constructor(callback)" data-dfn-type="argument" data-export id="dom-reportingobserver-reportingobserver-callback-options-callback"><code><c- g>callback</c-></code></dfn>, <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-reportingobserveroptions" id="ref-for-dictdef-reportingobserveroptions"><c- n>ReportingObserverOptions</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="ReportingObserver/ReportingObserver(callback, options), ReportingObserver/constructor(callback, options), ReportingObserver/ReportingObserver(callback), ReportingObserver/constructor(callback)" data-dfn-type="argument" data-export id="dom-reportingobserver-reportingobserver-callback-options-options"><code><c- g>options</c-></code></dfn> = {});
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefined"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#dom-reportingobserver-observe" id="ref-for-dom-reportingobserver-observe"><c- g>observe</c-></a>();
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefined①"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#dom-reportingobserver-disconnect" id="ref-for-dom-reportingobserver-disconnect"><c- g>disconnect</c-></a>();
  <a data-link-type="idl-name" href="#typedefdef-reportlist" id="ref-for-typedefdef-reportlist"><c- n>ReportList</c-></a> <a class="idl-code" data-link-type="method" href="#dom-reportingobserver-takerecords" id="ref-for-dom-reportingobserver-takerecords"><c- g>takeRecords</c-></a>();
};

<c- b>callback</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="callback" data-export id="callbackdef-reportingobservercallback"><code><c- g>ReportingObserverCallback</c-></code></dfn> = <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefined②"><c- b>undefined</c-></a> (<a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence" id="ref-for-idl-sequence"><c- b>sequence</c-></a>&lt;<a data-link-type="idl-name" href="#dom-report" id="ref-for-dom-report①"><c- n>Report</c-></a>> <dfn class="dfn-paneled idl-code" data-dfn-for="ReportingObserverCallback" data-dfn-type="argument" data-export id="dom-reportingobservercallback-reports"><code><c- g>reports</c-></code></dfn>, <a data-link-type="idl-name" href="#reportingobserver" id="ref-for-reportingobserver②"><c- n>ReportingObserver</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="ReportingObserverCallback" data-dfn-type="argument" data-export id="dom-reportingobservercallback-observer"><code><c- g>observer</c-></code></dfn>);

<c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-reportingobserveroptions"><code><c- g>ReportingObserverOptions</c-></code></dfn> {
  <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence" id="ref-for-idl-sequence①"><c- b>sequence</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString②"><c- b>DOMString</c-></a>> <dfn class="dfn-paneled idl-code" data-dfn-for="ReportingObserverOptions" data-dfn-type="dict-member" data-export data-type="sequence<DOMString>" id="dom-reportingobserveroptions-types"><code><c- g>types</c-></code></dfn>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean"><c- b>boolean</c-></a> <dfn class="dfn-paneled idl-code" data-default="false" data-dfn-for="ReportingObserverOptions" data-dfn-type="dict-member" data-export data-type="boolean" id="dom-reportingobserveroptions-buffered"><code><c- g>buffered</c-></code></dfn> = <c- b>false</c->;
};

<c- b>typedef</c-> <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence" id="ref-for-idl-sequence②"><c- b>sequence</c-></a>&lt;<a data-link-type="idl-name" href="#dom-report" id="ref-for-dom-report②"><c- n>Report</c-></a>> <dfn class="dfn-paneled idl-code" data-dfn-type="typedef" data-export id="typedefdef-reportlist"><code><c- g>ReportList</c-></code></dfn>;
</pre>
    <p>A <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="dom-report"><code>Report</code></dfn> is the application exposed
  representation of a <a data-link-type="dfn" href="#report" id="ref-for-report①⑦">report</a>. <dfn class="dfn-paneled idl-code" data-dfn-for="Report" data-dfn-type="attribute" data-export id="dom-report-type"><code>type</code></dfn> returns <a data-link-type="dfn" href="#report-reporttype" id="ref-for-report-reporttype③">type</a>, <dfn class="dfn-paneled idl-code" data-dfn-for="Report" data-dfn-type="attribute" data-export id="dom-report-url"><code>url</code></dfn> returns <a data-link-type="dfn" href="#report-url" id="ref-for-report-url③">url</a>, and <dfn class="dfn-paneled idl-code" data-dfn-for="Report" data-dfn-type="attribute" data-export id="dom-report-body"><code>body</code></dfn> returns <a data-link-type="dfn" href="#report-body" id="ref-for-report-body④">body</a>.</p>
    <p>Each <code class="idl"><a data-link-type="idl" href="#reportingobserver" id="ref-for-reportingobserver③">ReportingObserver</a></code> object has these associated concepts:</p>
    <ul>
     <li data-md>
      <p>A <dfn class="dfn-paneled" data-dfn-for="ReportingObserver" data-dfn-type="dfn" data-noexport id="reportingobserver-callback">callback</dfn> function set on creation.</p>
     <li data-md>
      <p>A <code class="idl"><a data-link-type="idl" href="#dictdef-reportingobserveroptions" id="ref-for-dictdef-reportingobserveroptions①">ReportingObserverOptions</a></code> dictionary called <dfn class="dfn-paneled" data-dfn-for="ReportingObserver" data-dfn-type="dfn" data-noexport id="reportingobserver-options">options</dfn>.</p>
     <li data-md>
      <p>A list of <code class="idl"><a data-link-type="idl" href="#dom-report" id="ref-for-dom-report③">Report</a></code> objects called the <dfn class="dfn-paneled" data-dfn-for="ReportingObserver" data-dfn-type="dfn" data-lt="report queue" data-noexport id="reportingobserver-report-queue">report
queue</dfn>, which is initially empty.</p>
    </ul>
    <p>A <code class="idl"><a data-link-type="idl" href="#typedefdef-reportlist" id="ref-for-typedefdef-reportlist①">ReportList</a></code> represents a sequence of <code class="idl"><a data-link-type="idl" href="#dom-report" id="ref-for-dom-report④">Report</a></code>s, providing developers
  with all the convenience methods found on JavaScript arrays.</p>
    <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="ReportingObserver" data-dfn-type="constructor" data-export data-lt="ReportingObserver(callback, options)|constructor(callback, options)|ReportingObserver(callback)|constructor(callback)" id="dom-reportingobserver-reportingobserver"><code> ReportingObserver(<var>callback</var>, <var>options</var>)</code></dfn> constructor, when
  invoked, must run these steps:</p>
    <ol>
     <li data-md>
      <p>Create a new <code class="idl"><a data-link-type="idl" href="#reportingobserver" id="ref-for-reportingobserver④">ReportingObserver</a></code> object <var>observer</var>.</p>
     <li data-md>
      <p>Set <var>observer</var>’s <a data-link-type="dfn" href="#reportingobserver-callback" id="ref-for-reportingobserver-callback">callback</a> to <var>callback</var>.</p>
     <li data-md>
      <p>Set <var>observer</var>’s <a data-link-type="dfn" href="#reportingobserver-options" id="ref-for-reportingobserver-options">options</a> to <var>options</var>.</p>
     <li data-md>
      <p>Return <var>observer</var>.</p>
    </ol>
    <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="ReportingObserver" data-dfn-type="method" data-export id="dom-reportingobserver-observe"><code>observe()</code></dfn> method, when invoked, must run these steps:</p>
    <ol>
     <li data-md>
      <p>Let <var>global</var> be the be the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global" id="ref-for-concept-relevant-global">relevant global object</a> of <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this">this</a>.</p>
     <li data-md>
      <p>Append <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this①">this</a> to the <var>global</var>’s <a data-link-type="dfn" href="#windoworworkerglobalscope-registered-reporting-observer-list" id="ref-for-windoworworkerglobalscope-registered-reporting-observer-list①">registered reporting
 observer list</a>.</p>
     <li data-md>
      <p>If <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this②">this</a>’s <code class="idl"><a data-link-type="idl" href="#dom-reportingobserveroptions-buffered" id="ref-for-dom-reportingobserveroptions-buffered①">buffered</a></code> <a data-link-type="dfn" href="#reportingobserver-options" id="ref-for-reportingobserver-options①">option</a> is false, return.</p>
     <li data-md>
      <p>Set <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this③">this</a>’s <code class="idl"><a data-link-type="idl" href="#dom-reportingobserveroptions-buffered" id="ref-for-dom-reportingobserveroptions-buffered②">buffered</a></code> <a data-link-type="dfn" href="#reportingobserver-options" id="ref-for-reportingobserver-options②">option</a> to false.</p>
     <li data-md>
      <p>For each <var>report</var> in <var>global</var>’s <a data-link-type="dfn" href="#windoworworkerglobalscope-report-buffer" id="ref-for-windoworworkerglobalscope-report-buffer①">report buffer</a>, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task" id="ref-for-queue-a-task①">queue a task</a> to execute <a href="#add-report">§ 4.3 Add report to observer</a> with <var>report</var> and <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this④">this</a>.</p>
    </ol>
    <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="ReportingObserver" data-dfn-type="method" data-export id="dom-reportingobserver-disconnect"><code>disconnect()</code></dfn> method,
  when invoked, must run these steps:</p>
    <ol>
     <li data-md>
      <p>If <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this⑤">this</a> is not <a data-link-type="dfn" href="#registered" id="ref-for-registered">registered</a>, return.</p>
     <li data-md>
      <p>Let <var>global</var> be the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global" id="ref-for-concept-relevant-global①">relevant global object</a> of <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this⑥">this</a>.</p>
     <li data-md>
      <p>Remove <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this⑦">this</a> from <var>global</var>’s <a data-link-type="dfn" href="#windoworworkerglobalscope-registered-reporting-observer-list" id="ref-for-windoworworkerglobalscope-registered-reporting-observer-list②">registered reporting
 observer list</a>.</p>
    </ol>
    <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="ReportingObserver" data-dfn-type="method" data-export id="dom-reportingobserver-takerecords"><code>takeRecords()</code></dfn> method,
  when invoked, must run these steps:</p>
    <ol>
     <li data-md>
      <p>Let <var>reports</var> be a copy of <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this⑧">this</a>’s <a data-link-type="dfn" href="#reportingobserver-report-queue" id="ref-for-reportingobserver-report-queue">report queue</a>.</p>
     <li data-md>
      <p>Empty <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this⑨">this</a>’s <a data-link-type="dfn" href="#reportingobserver-report-queue" id="ref-for-reportingobserver-report-queue①">report queue</a>.</p>
     <li data-md>
      <p>Return <var>reports</var>.</p>
    </ol>
    <h3 class="heading settled algorithm" data-algorithm="Notify reporting observers on scope with report" data-level="4.2" id="notify-observers"><span class="secno">4.2. </span><span class="content"> Notify reporting observers on <var>scope</var> with <var>report</var> </span><a class="self-link" href="#notify-observers"></a></h3>
    <p>This algorithm makes <var>report</var>’s contents available to any <a data-link-type="dfn" href="#registered" id="ref-for-registered①">registered</a> <a data-link-type="dfn" href="#reporting-observer" id="ref-for-reporting-observer⑦">reporting observers</a> on the provided <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope" id="ref-for-windoworworkerglobalscope⑧">WindowOrWorkerGlobalScope</a></code>.</p>
    <ol>
     <li data-md>
      <p>For each <code class="idl"><a data-link-type="idl" href="#reportingobserver" id="ref-for-reportingobserver⑤">ReportingObserver</a></code> <var>observer</var> <a data-link-type="dfn" href="#registered" id="ref-for-registered②">registered</a> with <var>scope</var>,
 execute <a href="#add-report">§ 4.3 Add report to observer</a> on <var>report</var> and <var>observer</var>.</p>
     <li data-md>
      <p>Append <var>report</var> to <var>scope</var>’s <a data-link-type="dfn" href="#windoworworkerglobalscope-report-buffer" id="ref-for-windoworworkerglobalscope-report-buffer②">report buffer</a>.</p>
     <li data-md>
      <p>Let <var>type</var> be <var>report</var>’s <a data-link-type="dfn" href="#report-reporttype" id="ref-for-report-reporttype④">type</a>.</p>
     <li data-md>
      <p>If <var>scope</var>’s <a data-link-type="dfn" href="#windoworworkerglobalscope-report-buffer" id="ref-for-windoworworkerglobalscope-report-buffer③">report buffer</a> now contains more than 100 reports with <a data-link-type="dfn" href="#report-reporttype" id="ref-for-report-reporttype⑤">type</a> equal to <var>type</var>, remove the earliest item with <a data-link-type="dfn" href="#report-reporttype" id="ref-for-report-reporttype⑥">type</a> equal to <var>type</var> in the <a data-link-type="dfn" href="#windoworworkerglobalscope-report-buffer" id="ref-for-windoworworkerglobalscope-report-buffer④">report buffer</a>.</p>
    </ol>
    <h3 class="heading settled algorithm" data-algorithm="Add report to observer" data-level="4.3" id="add-report"><span class="secno">4.3. </span><span class="content"> Add <var>report</var> to <var>observer</var> </span><a class="self-link" href="#add-report"></a></h3>
    <p>Given a <a data-link-type="dfn" href="#report" id="ref-for-report①⑧">report</a> <var>report</var> and a <code class="idl"><a data-link-type="idl" href="#reportingobserver" id="ref-for-reportingobserver⑥">ReportingObserver</a></code> <var>observer</var>, this
  algorithm adds <var>report</var> to <var>observer</var>’s <a data-link-type="dfn" href="#reportingobserver-report-queue" id="ref-for-reportingobserver-report-queue②">report queue</a>, so long as <var>report</var>’s <a data-link-type="dfn" href="#report-reporttype" id="ref-for-report-reporttype⑦">type</a> is observable by <var>observer</var>.</p>
    <ol>
     <li data-md>
      <p>If <var>report</var>’s <a data-link-type="dfn" href="#report-reporttype" id="ref-for-report-reporttype⑧">type</a> is not <a data-link-type="dfn" href="#visible-to-reportingobservers" id="ref-for-visible-to-reportingobservers①">visible to <code>ReportingObserver</code>s</a>, return.</p>
     <li data-md>
      <p>If <var>observer</var>’s <a data-link-type="dfn" href="#reportingobserver-options" id="ref-for-reportingobserver-options③">options</a> has a non-empty <code class="idl"><a data-link-type="idl" href="#dom-reportingobserveroptions-types" id="ref-for-dom-reportingobserveroptions-types">types</a></code> member which does not contain <var>report</var>’s <a data-link-type="dfn" href="#report-reporttype" id="ref-for-report-reporttype⑨">type</a>, return.</p>
     <li data-md>
      <p>Create a new <code class="idl"><a data-link-type="idl" href="#dom-report" id="ref-for-dom-report⑤">Report</a></code> <var>r</var> with <code class="idl"><a data-link-type="idl" href="#dom-report-type" id="ref-for-dom-report-type①">type</a></code> initialized to <var>report</var>’s <a data-link-type="dfn" href="#report-reporttype" id="ref-for-report-reporttype①⓪">type</a>, <code class="idl"><a data-link-type="idl" href="#dom-report-url" id="ref-for-dom-report-url①">url</a></code> initialized to <var>report</var>’s <a data-link-type="dfn" href="#report-url" id="ref-for-report-url④">url</a>,
 and <code class="idl"><a data-link-type="idl" href="#dom-report-body" id="ref-for-dom-report-body①">body</a></code> initialized to <var>report</var>’s <a data-link-type="dfn" href="#report-body" id="ref-for-report-body⑤">body</a>.</p>
    </ol>
    <p class="issue" id="issue-6311d126"><a class="self-link" href="#issue-6311d126"></a> how to polymorphically initialize body?</p>
    <ol start="3">
     <li data-md>
      <p>Append <var>r</var> to <var>observer</var>’s <a data-link-type="dfn" href="#reportingobserver-report-queue" id="ref-for-reportingobserver-report-queue③">report queue</a>.</p>
     <li data-md>
      <p>If the size of <var>observer</var>’s <a data-link-type="dfn" href="#reportingobserver-report-queue" id="ref-for-reportingobserver-report-queue④">report queue</a> is 1:</p>
      <ol>
       <li data-md>
        <p>Let <var>global</var> be <var>observer</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global" id="ref-for-concept-relevant-global②">relevant global object</a>.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task" id="ref-for-queue-a-task②">Queue a task</a> to <a href="#invoke-observers">§ 4.4 Invoke reporting observers with notify list</a> with a copy of <var>global</var>’s <a data-link-type="dfn" href="#windoworworkerglobalscope-registered-reporting-observer-list" id="ref-for-windoworworkerglobalscope-registered-reporting-observer-list③">registered reporting observer list</a>.</p>
      </ol>
    </ol>
    <h3 class="heading settled algorithm" data-algorithm="Invoke reporting observers with notify list" data-level="4.4" id="invoke-observers"><span class="secno">4.4. </span><span class="content"> Invoke reporting observers with <var>notify list</var> </span><a class="self-link" href="#invoke-observers"></a></h3>
    <p>This algorithm invokes observer callback functions for reports of previously
  observed behavior.</p>
    <ol>
     <li data-md>
      <p>For each <code class="idl"><a data-link-type="idl" href="#reportingobserver" id="ref-for-reportingobserver⑦">ReportingObserver</a></code> <var>observer</var> in <var>notify list</var>:</p>
      <ol>
       <li data-md>
        <p>If <var>observer</var>’s <a data-link-type="dfn" href="#reportingobserver-report-queue" id="ref-for-reportingobserver-report-queue⑤">report queue</a> is empty, then continue.</p>
       <li data-md>
        <p>Let <var>reports</var> be a copy of <var>observer</var>’s <a data-link-type="dfn" href="#reportingobserver-report-queue" id="ref-for-reportingobserver-report-queue⑥">report queue</a></p>
       <li data-md>
        <p>Empty <var>observer</var>’s <a data-link-type="dfn" href="#reportingobserver-report-queue" id="ref-for-reportingobserver-report-queue⑦">report queue</a></p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#invoke-a-callback-function" id="ref-for-invoke-a-callback-function">Invoke</a> <var>observer</var>’s <a data-link-type="dfn" href="#reportingobserver-callback" id="ref-for-reportingobserver-callback①">callback</a> with
  « <var>reports</var>, <var>observer</var> » and "<code>report</code>", and with <var>observer</var> as the <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-callback-this-value" id="ref-for-dfn-callback-this-value">callback this value</a>.</p>
      </ol>
    </ol>
   </section>
   <section>
    <h2 class="heading settled" data-level="5" id="implementation"><span class="secno">5. </span><span class="content">Implementation Considerations</span><a class="self-link" href="#implementation"></a></h2>
    <h3 class="heading settled" data-level="5.1" id="delivery"><span class="secno">5.1. </span><span class="content">Delivery</span><a class="self-link" href="#delivery"></a></h3>
    <p>The user agent SHOULD attempt to deliver reports as soon as possible to
  provide feedback to developers as quickly as possible. However, when this
  desire is balanced against the impact on the user, the user wins. With that
  in mind, the user agent MAY delay delivery of reports based on its knowledge
  of the user’s activities and context.</p>
    <p>For instance, the user agent SHOULD prioritize the transmission of reporting
  data lower than other network traffic. The user’s explicit activities on a
  website should preempt reporting traffic.</p>
    <p>The user agent MAY choose to withhold report delivery entirely until the user
  is on a fast, cheap network in order to prevent unnecessary data cost.</p>
    <p>The user agent MAY choose to prioritize reports from particular origins over
  others (perhaps those that the user visits most often?)</p>
    <h3 class="heading settled" data-level="5.2" id="gc"><span class="secno">5.2. </span><span class="content">Garbage Collection</span><a class="self-link" href="#gc"></a></h3>
    <p>Periodically, the user agent SHOULD walk through the cached <a data-link-type="dfn" href="#report" id="ref-for-report①⑨">reports</a> and <a data-link-type="dfn" href="#endpoint" id="ref-for-endpoint①④">endpoints</a>, and discard those that are
  no longer relevant. These include:</p>
    <ul>
     <li data-md>
      <p><a data-link-type="dfn" href="#endpoint" id="ref-for-endpoint①⑤">endpoints</a> whose <code class="idl"><a data-link-type="idl" href="#dom-endpoint-failures" id="ref-for-dom-endpoint-failures②">failures</a></code> exceed
  some user-agent-defined threshold (~5 seems reasonable)</p>
     <li data-md>
      <p><a data-link-type="dfn" href="#report" id="ref-for-report②⓪">reports</a> which have not been delivered in some arbitrary
  period of time (perhaps ~2 days?)</p>
    </ul>
    <p>For any <a data-link-type="dfn" href="#report" id="ref-for-report②①">reports</a> that are discarded, these <a data-link-type="dfn" href="#windoworworkerglobalscope-reports" id="ref-for-windoworworkerglobalscope-reports⑧">reports</a> should
  also be removed from the <a data-link-type="dfn" href="#windoworworkerglobalscope-report-buffer" id="ref-for-windoworworkerglobalscope-report-buffer⑤">report buffer</a> of any <a data-link-type="dfn" href="#reporting-observer" id="ref-for-reporting-observer⑧">reporting
  observer</a>.</p>
   </section>
   <section class="non-normative">
    <h2 class="heading settled" data-level="6" id="sample-reports"><span class="secno">6. </span><span class="content">Sample Reports</span><a class="self-link" href="#sample-reports"></a></h2>
    <p><em>This section is non-normative.</em></p>
    <p>This example shows the format in which reports are sent by the user agent to
  the reporting endpoint. The sample submission contains three reports which
  have been bundled together and sent in a single HTTP request. (The report
  types and bodies themselves are not intended to be representative of any
  actual feature, as those are outside of the scope of this specification).</p>
    <div class="example" id="example-3cfcdab2">
     <a class="self-link" href="#example-3cfcdab2"></a> 
<pre>POST / HTTP/1.1
Host: example.com
...
Content-Type: application/reports+json

[{
  "type": "security-violation",
  "age": 10,
  "url": "https://example.com/vulnerable-page/",
  "user_agent": "Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0",
  "body": {
    "blocked": "https://evil.com/evil.js",
    "policy": "bad-behavior 'none'",
    "status": 200,
    "referrer": "https://evil.com/"
  }
}, {
  "type": "certificate-issue",
  "age": 32,
  "url": "https://www.example.com/",
  "user_agent": "Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0",
  "body": {
    "date-time": "2014-04-06T13:00:50Z",
    "hostname": "www.example.com",
    "port": 443,
    "effective-expiration-date": "2014-05-01T12:40:50Z",
    "served-certificate-chain": [
      "-----BEGIN CERTIFICATE-----\n
      MIIEBDCCAuygAwIBAgIDAjppMA0GCSqGSIb3DQEBBQUAMEIxCzAJBgNVBAYTAlVT\n
      ...
      HFa9llF7b1cq26KqltyMdMKVvvBulRP/F/A8rLIQjcxz++iPAsbw+zOzlTvjwsto\n
      WHPbqCRiOwY1nQ2pM714A5AuTHhdUDqB1O6gyHA43LL5Z/qHQF1hwFGPa4NrzQU6\n
      yuGnBXj8ytqU0CwIPX4WecigUCAkVDNx\n
      -----END CERTIFICATE-----",
      ...
    ]
  }
}, {
  "type": "cpu-on-fire",
  "age": 29,
  "url": "https://example.com/thing.js",
  "user_agent": "Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0",
  "body": {
    "temperature": 614.0
  }
}]
</pre>
    </div>
   </section>
   <section>
    <h2 class="heading settled" data-level="7" id="automation"><span class="secno">7. </span><span class="content">Automation</span><a class="self-link" href="#automation"></a></h2>
    <p>For the purposes of user-agent automation and application testing, this
  document defines a number of <a data-link-type="dfn" href="https://w3c.github.io/webdriver/#dfn-extension-command" id="ref-for-dfn-extension-command">extension commands</a> for the <a data-link-type="biblio" href="#biblio-webdriver" title="WebDriver">[WebDriver]</a> specification.</p>
    <h3 class="heading settled" data-level="7.1" id="generate-test-report-command"><span class="secno">7.1. </span><span class="content">Generate Test Report</span><a class="self-link" href="#generate-test-report-command"></a></h3>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="generate-test-report">Generate Test Report</dfn> <a data-link-type="dfn" href="https://w3c.github.io/webdriver/#dfn-extension-command" id="ref-for-dfn-extension-command①">extension command</a> simulates the
  generation of a <a data-link-type="dfn" href="#report" id="ref-for-report②②">report</a> for the purposes of testing. This report will be
  observed by any <a data-link-type="dfn" href="#registered" id="ref-for-registered③">registered</a> <a data-link-type="dfn" href="#reporting-observer" id="ref-for-reporting-observer⑨">reporting observers</a>.</p>
    <p>The <a data-link-type="dfn" href="https://w3c.github.io/webdriver/#dfn-extension-command" id="ref-for-dfn-extension-command②">extension command</a> is defined as follows:</p>
<pre class="idl highlight def"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-generatetestreportparameters"><code><c- g>GenerateTestReportParameters</c-></code></dfn> {
  <c- b>required</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString③"><c- b>DOMString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="GenerateTestReportParameters" data-dfn-type="dict-member" data-export data-type="DOMString" id="dom-generatetestreportparameters-message"><code><c- g>message</c-></code></dfn>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString④"><c- b>DOMString</c-></a> <dfn class="dfn-paneled idl-code" data-default="&quot;default&quot;" data-dfn-for="GenerateTestReportParameters" data-dfn-type="dict-member" data-export data-type="DOMString" id="dom-generatetestreportparameters-group"><code><c- g>group</c-></code></dfn> = "default";
};
</pre>
    <table style="border-spacing: 20px 0px;">
     <tbody>
      <tr>
       <th>HTTP Method
       <th><a data-link-type="dfn" href="https://w3c.github.io/webdriver/#dfn-extension-command-uri-template" id="ref-for-dfn-extension-command-uri-template">URI Template</a>
      <tr>
       <td><code>POST</code>
       <td><code>/session/{session id}/reporting/generate_test_report</code>
    </table>
    <p>The <a data-link-type="dfn" href="https://w3c.github.io/webdriver/#dfn-remote-end-steps" id="ref-for-dfn-remote-end-steps">remote end steps</a> are:</p>
    <ol>
     <li data-md>
      <p>If <var>parameters</var> is not a JSON <a data-link-type="dfn" href="https://w3c.github.io/rdf-concepts/spec/#dfn-object" id="ref-for-dfn-object">Object</a>, return a <a data-link-type="dfn" href="https://w3c.github.io/webdriver/#dfn-error" id="ref-for-dfn-error">WebDriver
 error</a> with <a data-link-type="dfn" href="https://w3c.github.io/webdriver/#dfn-error-code" id="ref-for-dfn-error-code">WebDriver error code</a> <a data-link-type="dfn" href="https://w3c.github.io/webdriver/#dfn-invalid-argument" id="ref-for-dfn-invalid-argument">invalid argument</a>.</p>
     <li data-md>
      <p>Let <var>message</var> be the result of <a data-link-type="dfn" href="https://w3c.github.io/webdriver/#dfn-try" id="ref-for-dfn-try">trying</a> to get <var>parameters</var>’s <code class="idl"><a data-link-type="idl" href="#dom-generatetestreportparameters-message" id="ref-for-dom-generatetestreportparameters-message">message</a></code> property.</p>
     <li data-md>
      <p>If <var>message</var> is not present, return a <a data-link-type="dfn" href="https://w3c.github.io/webdriver/#dfn-error" id="ref-for-dfn-error①">WebDriver error</a> with <a data-link-type="dfn" href="https://w3c.github.io/webdriver/#dfn-error-code" id="ref-for-dfn-error-code①">WebDriver error code</a> <a data-link-type="dfn" href="https://w3c.github.io/webdriver/#dfn-invalid-argument" id="ref-for-dfn-invalid-argument①">invalid argument</a>.</p>
     <li data-md>
      <p>If the <a data-link-type="dfn" href="https://w3c.github.io/webdriver/#dfn-current-browsing-context" id="ref-for-dfn-current-browsing-context">current browsing context</a> is no longer open, return a <a data-link-type="dfn" href="https://w3c.github.io/webdriver/#dfn-error" id="ref-for-dfn-error②">WebDriver error</a> with <a data-link-type="dfn" href="https://w3c.github.io/webdriver/#dfn-error-code" id="ref-for-dfn-error-code②">WebDriver error code</a> <a data-link-type="dfn" href="https://w3c.github.io/webdriver/#dfn-no-such-window" id="ref-for-dfn-no-such-window">no such
 window</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://w3c.github.io/webdriver/#dfn-handle-any-user-prompts" id="ref-for-dfn-handle-any-user-prompts">Handle any user prompts</a> and return its value if it is a <a data-link-type="dfn" href="https://w3c.github.io/webdriver/#dfn-error" id="ref-for-dfn-error③">WebDriver
 error</a>.</p>
     <li data-md>
      <p>Let <var>group</var> be <var>parameters</var>’s <code class="idl"><a data-link-type="idl" href="#dom-generatetestreportparameters-group" id="ref-for-dom-generatetestreportparameters-group">group</a></code> property.</p>
     <li data-md>
      <p>Let <var>body</var> be a new object that can be serialized into a <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8259#section-2" id="ref-for-section-2①">JSON text</a>,
 containing a single string field, <var>body_message</var>.</p>
     <li data-md>
      <p>Set <var>body_message</var> to <var>message</var>.</p>
     <li data-md>
      <p>Let <var>settings</var> be the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object②">environment settings object</a> of the <a data-link-type="dfn" href="https://w3c.github.io/webdriver/#dfn-current-browsing-context" id="ref-for-dfn-current-browsing-context①">current browsing context</a>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-document" id="ref-for-nav-document">active document</a>.</p>
     <li data-md>
      <p>Execute <a data-link-type="dfn" href="#generate-and-queue-a-report" id="ref-for-generate-and-queue-a-report">generate and queue a report</a> with <var>body</var>, "test", <var>group</var>, and <var>settings</var>.</p>
     <li data-md>
      <p>Return <a data-link-type="dfn" href="https://w3c.github.io/webdriver/#dfn-success" id="ref-for-dfn-success">success</a> with data null.</p>
    </ol>
   </section>
   <section>
    <h2 class="heading settled" data-level="8" id="security"><span class="secno">8. </span><span class="content">Security Considerations</span><a class="self-link" href="#security"></a></h2>
    <h3 class="heading settled" data-level="8.1" id="capability-urls"><span class="secno">8.1. </span><span class="content">Capability URLs</span><a class="self-link" href="#capability-urls"></a></h3>
    <p>Some URLs are valuable in and of themselves. They may contain explicit
  credentials in the username and password portion of the URL, or may grant
  access to some resource to anyone with knowledge of the URL path.
  Additionally, they may contain information which was never intended leave the
  user’s browser in the URL fragment. See <a data-link-type="biblio" href="#biblio-capability-urls" title="Good Practices for Capability URLs">[CAPABILITY-URLS]</a> for more
  information.</p>
    <p>To mitigate the possibility that such URLs will be leaked via this reporting
  mechanism, the algorithms here strip out credential information and fragment
  data from the URL sent as a <a data-link-type="dfn" href="#report" id="ref-for-report②③">report</a>’s originator. It is still possible,
  however, for sensitive information in the URL’s path to be leaked this way.
  Sites which use such URLs may need to operate their own reporting endpoints.</p>
    <p>Additionally, such URLs may be present in a report’s <a data-link-type="dfn" href="#report-body" id="ref-for-report-body⑥">body</a>.
  Specifications which extend this API and which include any URLs in a report’s <a data-link-type="dfn" href="#report-body" id="ref-for-report-body⑦">body</a> SHOULD require that they be similarly stripped.</p>
   </section>
   <section>
    <h2 class="heading settled" data-level="9" id="privacy"><span class="secno">9. </span><span class="content">Privacy Considerations</span><a class="self-link" href="#privacy"></a></h2>
    <h3 class="heading settled" data-level="9.1" id="network-leakage"><span class="secno">9.1. </span><span class="content">Network Leakage</span><a class="self-link" href="#network-leakage"></a></h3>
    <p>Because there is a delay between a page being loaded and a report being
  generated and sent, it’s entirely possible for a report generated while a user
  is on one network to be sent while the user is on another network.</p>
    <p>This behaviour is limited to the lifetime of the document which generated the
  reports, though, and such a document could be generating traffic on the new
  network through other means in any case, even after the document is closed,
  through mechanisms such as <code>navigator.sendBeacon</code>.</p>
    <p class="issue" id="issue-acba119f"><a class="self-link" href="#issue-acba119f"></a> Consider mitigations. For example, we could
  drop reports if we change from one network to another. <a href="https://github.com/WICG/background-sync/issues/107">[WICG/background-sync Issue #107]</a></p>
    <h3 class="heading settled" data-level="9.2" id="fingerprinting-clock-skew"><span class="secno">9.2. </span><span class="content">Clock Skew</span><a class="self-link" href="#fingerprinting-clock-skew"></a></h3>
    <p>Each report is delivered along with an <code>age</code> property, rather than the
  timestamp at which it was generated. We do this because each user’s local
  clock will be skewed from the clock on the server by an arbitrary amount.
  The difference between the time the report was generated and the time it
  was sent will be stable, regardless of clock skew, and we can avoid the
  fingerprinting risk of exposing the clock skew via this API.</p>
    <h3 class="heading settled" data-level="9.3" id="correlation"><span class="secno">9.3. </span><span class="content">Cross-origin correlation</span><a class="self-link" href="#correlation"></a></h3>
    <p>If multiple origins all use the same reporting endpoint, that endpoint may
  learn that a particular user has interacted with a certain set of websites,
  as it will receive origin-tagged reports from each. This doesn’t seem worse
  than the status quo ability to track the same information from cooperative
  origins, and doesn’t grant any new tracking ability above and beyond what’s
  possible with <code>&lt;img></code> today.</p>
    <h3 class="heading settled" data-level="9.4" id="disable"><span class="secno">9.4. </span><span class="content">Disabling Reporting</span><a class="self-link" href="#disable"></a></h3>
    <p>Reporting is, to some extent, a question of commons. In the aggregate, it
  seems useful for everyone for reports to be delivered. There is direct benefit
  to developers, as they can fix bugs, which means there’s indirect benefit to
  users, as the sites they enjoy will be more stable and enjoyable. As a
  concrete example, Content Security Policy grants something like herd immunity
  to cross-site scripting attacks by alerting developers about potential holes
  in their sites' defenses. Fixing those bugs helps every user, even those whose
  user agents don’t support Content Security Policy.</p>
    <p>The calculus, of course, depends on the nature of data that’s being delivered,
  and the relative maliciousness of the reporting endpoints, but that’s the
  value proposition in broad strokes.</p>
    <p>That said, it can’t be the case that this general benefit be allowed to take
  priority over the ability of a user to individually opt-out of such a system.
  Sending reports costs bandwidth, and potentially could reveal some small
  amount of additional information above and beyond what a website can obtain
  in-band (<a data-link-type="biblio" href="#biblio-network-error-logging" title="Network Error Logging">[NETWORK-ERROR-LOGGING]</a>, for instance). User agents MUST allow
  users to disable reporting with some reasonable amount of granularity in order
  to maintain the priority of constituencies espoused in <a data-link-type="biblio" href="#biblio-html-design-principles" title="HTML Design Principles">[HTML-DESIGN-PRINCIPLES]</a>.</p>
   </section>
   <section>
    <h2 class="heading settled" data-level="10" id="iana-considerations"><span class="secno">10. </span><span class="content">IANA Considerations</span><a class="self-link" href="#iana-considerations"></a></h2>
    <h3 class="heading settled" data-level="10.1" id="header-field-registration"><span class="secno">10.1. </span><span class="content">The <code>Reporting-Endpoints</code> Header</span><a class="self-link" href="#header-field-registration"></a></h3>
    <p>The permanent message header field registry should be updated
  with the following registration: <a data-link-type="biblio" href="#biblio-rfc3864" title="Registration Procedures for Message Header Fields">[RFC3864]</a></p>
    <dl>
     <dt data-md>Header field name
     <dd data-md>
      <p><code>Reporting-Endpoints</code></p>
     <dt data-md>Applicable protocol
     <dd data-md>
      <p>http</p>
     <dt data-md>Status
     <dd data-md>
      <p>standard</p>
     <dt data-md>Author/Change controller
     <dd data-md>
      <p>W3C</p>
     <dt data-md>Specification document
     <dd data-md>
      <p>This specification (see <a href="#header">§ 3.2 The Reporting-Endpoints HTTP Response Header Field</a>)</p>
    </dl>
    <h3 class="heading settled" data-level="10.2" id="media-type-registration"><span class="secno">10.2. </span><span class="content">The <code>application/reports+json</code> Media Type</span><a class="self-link" href="#media-type-registration"></a></h3>
    <dl>
     <dt data-md>Type name
     <dd data-md>
      <p>application</p>
     <dt data-md>Subtype name
     <dd data-md>
      <p>reports+json</p>
     <dt data-md>Required parameters
     <dd data-md>
      <p>N/A</p>
     <dt data-md>Optional parameters
     <dd data-md>
      <p>N/A</p>
     <dt data-md>Encoding considerations
     <dd data-md>
      <p>Encoding considerations are identical to those specified for the "application/json" media type. See <a data-link-type="biblio" href="#biblio-rfc8259" title="The JavaScript Object Notation (JSON) Data Interchange Format">[RFC8259]</a>.</p>
     <dt data-md>Security considerations
     <dd data-md>
      <p>See <a href="#security">§ 8 Security Considerations</a>.</p>
     <dt data-md>Interoperability considerations
     <dd data-md>
      <p>This document specifies the format of conforming messages and the interpretation thereof.</p>
     <dt data-md>Published specification
     <dd data-md>
      <p><a href="#media-type">§ 2.2 Media Type</a></p>
     <dt data-md>Applications that use this media type
     <dt data-md>Fragment identifier considerations
     <dt data-md>Additional information
     <dd data-md>
      <p>N/A</p>
     <dt data-md>Person and email address to contact for further information
     <dd data-md>
      <p>This document’s editors.</p>
     <dt data-md>Intended usage:
     <dd data-md>
      <p>COMMON</p>
     <dt data-md>Restrictions on usage:
     <dd data-md>
      <p>N/A</p>
     <dt data-md>Author
     <dd data-md>
      <p>This document’s editors.</p>
     <dt data-md>Change controller
     <dd data-md>
      <p>W3C</p>
     <dt data-md>Provisional registration?
     <dd data-md>
      <p>Yes.</p>
    </dl>
   </section>
  </main>
  <script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#report-attempts">attempts</a><span>, in § 2.1.3</span>
   <li>
    body
    <ul>
     <li><a href="#dom-report-body">attribute for Report</a><span>, in § 4.1</span>
     <li><a href="#report-body">dfn for report</a><span>, in § 2.1.3</span>
    </ul>
   <li><a href="#dom-reportingobserveroptions-buffered">buffered</a><span>, in § 4.1</span>
   <li><a href="#reportingobserver-callback">callback</a><span>, in § 4.1</span>
   <li><a href="#dom-reportingobserver-reportingobserver">constructor(callback)</a><span>, in § 4.1</span>
   <li><a href="#dom-reportingobserver-reportingobserver">constructor(callback, options)</a><span>, in § 4.1</span>
   <li><a href="#generate-and-queue-a-report-context">context</a><span>, in § 3.4.1</span>
   <li><a href="#generate-and-queue-a-report-data">data</a><span>, in § 3.4.1</span>
   <li>
    destination
    <ul>
     <li><a href="#generate-and-queue-a-report-destination">dfn for generate and queue a report</a><span>, in § 3.4.1</span>
     <li><a href="#report-destination">dfn for report</a><span>, in § 2.1.3</span>
    </ul>
   <li><a href="#dom-reportingobserver-disconnect">disconnect()</a><span>, in § 4.1</span>
   <li><a href="#endpoint">endpoint</a><span>, in § 2.1.1</span>
   <li><a href="#windoworworkerglobalscope-endpoints">endpoints</a><span>, in § 3.1</span>
   <li><a href="#dom-endpoint-failures">failures</a><span>, in § 2.1.1</span>
   <li><a href="#generate-and-queue-a-report">generate and queue a report</a><span>, in § 3.4.1</span>
   <li><a href="#generate-a-report">generate a report</a><span>, in § 2.3</span>
   <li><a href="#generate-test-report">Generate Test Report</a><span>, in § 7.1</span>
   <li><a href="#dictdef-generatetestreportparameters">GenerateTestReportParameters</a><span>, in § 7.1</span>
   <li><a href="#dom-generatetestreportparameters-group">group</a><span>, in § 7.1</span>
   <li><a href="#initialize-a-globals-endpoint-list">initialize a global’s endpoint list</a><span>, in § 3.1</span>
   <li><a href="#dom-generatetestreportparameters-message">message</a><span>, in § 7.1</span>
   <li><a href="#dom-endpoint-name">name</a><span>, in § 2.1.1</span>
   <li><a href="#dom-reportingobserver-observe">observe()</a><span>, in § 4.1</span>
   <li><a href="#reportingobserver-options">options</a><span>, in § 4.1</span>
   <li><a href="#registered">registered</a><span>, in § 4</span>
   <li><a href="#windoworworkerglobalscope-registered-reporting-observer-list">registered reporting observer list</a><span>, in § 4</span>
   <li><a href="#dom-report">Report</a><span>, in § 4.1</span>
   <li><a href="#report">report</a><span>, in § 2.1.3</span>
   <li><a href="#reportbody">ReportBody</a><span>, in § 4.1</span>
   <li><a href="#windoworworkerglobalscope-report-buffer">report buffer</a><span>, in § 4</span>
   <li><a href="#reporting-endpoints">Reporting-Endpoints</a><span>, in § 3.2</span>
   <li><a href="#reporting-observer">reporting observer</a><span>, in § 4</span>
   <li><a href="#reportingobserver">ReportingObserver</a><span>, in § 4.1</span>
   <li><a href="#dom-reportingobserver-reportingobserver">ReportingObserver(callback)</a><span>, in § 4.1</span>
   <li><a href="#callbackdef-reportingobservercallback">ReportingObserverCallback</a><span>, in § 4.1</span>
   <li><a href="#dom-reportingobserver-reportingobserver">ReportingObserver(callback, options)</a><span>, in § 4.1</span>
   <li><a href="#dictdef-reportingobserveroptions">ReportingObserverOptions</a><span>, in § 4.1</span>
   <li><a href="#typedefdef-reportlist">ReportList</a><span>, in § 4.1</span>
   <li><a href="#reportingobserver-report-queue">report queue</a><span>, in § 4.1</span>
   <li><a href="#windoworworkerglobalscope-reports">reports</a><span>, in § 3.1</span>
   <li><a href="#report-type">report type</a><span>, in § 2.1.2</span>
   <li><a href="#serialize-a-list-of-reports-to-json">serialize a list of reports to JSON</a><span>, in § 2.4</span>
   <li><a href="#strip-url-for-use-in-reports">strip URL for use in reports</a><span>, in § 3.6</span>
   <li><a href="#dom-reportingobserver-takerecords">takeRecords()</a><span>, in § 4.1</span>
   <li><a href="#report-timestamp">timestamp</a><span>, in § 2.1.3</span>
   <li>
    toJSON()
    <ul>
     <li><a href="#dom-report-tojson">method for Report</a><span>, in § 4.1</span>
     <li><a href="#dom-reportbody-tojson">method for ReportBody</a><span>, in § 4.1</span>
    </ul>
   <li>
    type
    <ul>
     <li><a href="#dom-report-type">attribute for Report</a><span>, in § 4.1</span>
     <li><a href="#generate-and-queue-a-report-type">dfn for generate and queue a report</a><span>, in § 3.4.1</span>
     <li><a href="#report-reporttype">dfn for report</a><span>, in § 2.1.3</span>
    </ul>
   <li><a href="#dom-reportingobserveroptions-types">types</a><span>, in § 4.1</span>
   <li>
    url
    <ul>
     <li><a href="#dom-report-url">attribute for Report</a><span>, in § 4.1</span>
     <li><a href="#dom-endpoint-url">attribute for endpoint</a><span>, in § 2.1.1</span>
     <li><a href="#report-url">dfn for report</a><span>, in § 2.1.3</span>
    </ul>
   <li><a href="#report-user-agent">user agent</a><span>, in § 2.1.3</span>
   <li><a href="#visible-to-reportingobservers">visible to ReportingObservers</a><span>, in § 2.1.2</span>
  </ul>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[CSP3]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="2382cfb6">Content-Security-Policy</span>
     <li><span class="dfn-paneled" id="0914e5ac">reports directive</span>
    </ul>
   <li>
    <a data-link-type="biblio">[DOM]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="85394472">Document</span>
    </ul>
   <li>
    <a data-link-type="biblio">[FETCH]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="29d70c68">HTTPS state</span>
     <li><span class="dfn-paneled" id="644cb530">body</span>
     <li><span class="dfn-paneled" id="a33db89a">fetch</span>
     <li><span class="dfn-paneled" id="5c66de35">get a structured field value</span>
     <li><span class="dfn-paneled" id="c9e7c11a">header</span>
     <li><span class="dfn-paneled" id="d85a6c84">header list</span>
     <li><span class="dfn-paneled" id="f7b00a8b">header list <small>(for response)</small></span>
     <li><span class="dfn-paneled" id="eb62573b">HTTP(S) scheme</span>
     <li><span class="dfn-paneled" id="a27468c5">ok status</span>
     <li><span class="dfn-paneled" id="55213b5b">request</span>
     <li><span class="dfn-paneled" id="ee7bba09">response</span>
     <li><span class="dfn-paneled" id="449b55f1">source</span>
     <li><span class="dfn-paneled" id="3268a8eb">url</span>
     <li><span class="dfn-paneled" id="9a79363d">wait for a response</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="5f6d392d">WindowOrWorkerGlobalScope</span>
     <li><span class="dfn-paneled" id="83c59a3a">WorkerGlobalScope</span>
     <li><span class="dfn-paneled" id="35972864">active document</span>
     <li><span class="dfn-paneled" id="64db426e">creation URL</span>
     <li><span class="dfn-paneled" id="3e12e042">environment settings object</span>
     <li><span class="dfn-paneled" id="8a30477b">global object</span>
     <li><span class="dfn-paneled" id="543d1495">navigator.userAgent</span>
     <li><span class="dfn-paneled" id="303ff2d7">origin</span>
     <li><span class="dfn-paneled" id="9a517a7d">queue a task</span>
     <li><span class="dfn-paneled" id="e99bd18e">relevant global object</span>
     <li><span class="dfn-paneled" id="9c4c1e66">relevant settings object</span>
    </ul>
   <li>
    <a data-link-type="biblio">[INFRA]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="3de9e659">byte sequence</span>
     <li><span class="dfn-paneled" id="f937b7b6">continue</span>
     <li><span class="dfn-paneled" id="649608b9">list</span>
     <li><span class="dfn-paneled" id="692595fe">ordered set</span>
     <li><span class="dfn-paneled" id="4c07280e">serialize an Infra value to JSON bytes</span>
    </ul>
   <li>
    <a data-link-type="biblio">[RDF12-CONCEPTS]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="166572aa">object</span>
    </ul>
   <li>
    <a data-link-type="biblio">[RFC7469]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="c0fa3c07">Public-Key-Pins</span>
    </ul>
   <li>
    <a data-link-type="biblio">[RFC8259]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="c8829574">JSON text</span>
    </ul>
   <li>
    <a data-link-type="biblio">[SECURE-CONTEXTS]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="844c841b">potentially trustworthy</span>
    </ul>
   <li>
    <a data-link-type="biblio">[STRUCTURED-FIELDS]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="c0666585">sf-dictionary</span>
    </ul>
   <li>
    <a data-link-type="biblio">[URL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="20b42dd0">URL</span>
     <li><span class="dfn-paneled" id="b9d1df32">base URL</span>
     <li><span class="dfn-paneled" id="ed948033">fragment</span>
     <li><span class="dfn-paneled" id="c4c32895">origin of a url</span>
     <li><span class="dfn-paneled" id="95210ccd">password <small>(for URL)</small></span>
     <li><span class="dfn-paneled" id="a1288f2a">password <small>(for url)</small></span>
     <li><span class="dfn-paneled" id="3a711be7">scheme</span>
     <li><span class="dfn-paneled" id="dcffbccd">URL</span>
     <li><span class="dfn-paneled" id="ca3ca4ae">URL parser</span>
     <li><span class="dfn-paneled" id="5442ea33">URL serializer</span>
     <li><span class="dfn-paneled" id="d6f79d11">username <small>(for URL)</small></span>
     <li><span class="dfn-paneled" id="218c9455">username <small>(for url)</small></span>
    </ul>
   <li>
    <a data-link-type="biblio">[WebDriver]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="024a1df2">current browsing context</span>
     <li><span class="dfn-paneled" id="bc7f2174">extension command</span>
     <li><span class="dfn-paneled" id="040c67fa">extension command uri template</span>
     <li><span class="dfn-paneled" id="b3505eba">handle any user prompts</span>
     <li><span class="dfn-paneled" id="8da4d1e3">invalid argument</span>
     <li><span class="dfn-paneled" id="a1894061">no such window</span>
     <li><span class="dfn-paneled" id="82c23298">remote end steps</span>
     <li><span class="dfn-paneled" id="4be6272b">success</span>
     <li><span class="dfn-paneled" id="7aa9c8e0">trying</span>
     <li><span class="dfn-paneled" id="5cf0e148">WebDriver error</span>
     <li><span class="dfn-paneled" id="7482107b">WebDriver error code</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBIDL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="8855a9aa">DOMString</span>
     <li><span class="dfn-paneled" id="f4531911">Default</span>
     <li><span class="dfn-paneled" id="889e932f">Exposed</span>
     <li><span class="dfn-paneled" id="5372cca8">boolean</span>
     <li><span class="dfn-paneled" id="a9bf6bd5">callback this value</span>
     <li><span class="dfn-paneled" id="10ce5f6f">invoke</span>
     <li><span class="dfn-paneled" id="efd1ec5d">object</span>
     <li><span class="dfn-paneled" id="9cce47fd">sequence</span>
     <li><span class="dfn-paneled" id="4013a022">this</span>
     <li><span class="dfn-paneled" id="5f90bbfb">undefined</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-dom">[DOM]
   <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/"><cite>DOM Standard</cite></a>. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-fetch">[FETCH]
   <dd>Anne van Kesteren. <a href="https://fetch.spec.whatwg.org/"><cite>Fetch Standard</cite></a>. Living Standard. URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
   <dt id="biblio-html">[HTML]
   <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-infra">[INFRA]
   <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
   <dt id="biblio-rdf12-concepts">[RDF12-CONCEPTS]
   <dd>Olaf Hartig; et al. <a href="https://w3c.github.io/rdf-concepts/spec/"><cite>RDF 1.2 Concepts and Abstract Syntax</cite></a>. URL: <a href="https://w3c.github.io/rdf-concepts/spec/">https://w3c.github.io/rdf-concepts/spec/</a>
   <dt id="biblio-rfc3864">[RFC3864]
   <dd>G. Klyne; M. Nottingham; J. Mogul. <a href="https://www.rfc-editor.org/rfc/rfc3864"><cite>Registration Procedures for Message Header Fields</cite></a>. September 2004. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc3864">https://www.rfc-editor.org/rfc/rfc3864</a>
   <dt id="biblio-rfc5234">[RFC5234]
   <dd>D. Crocker, Ed.; P. Overell. <a href="https://www.rfc-editor.org/rfc/rfc5234"><cite>Augmented BNF for Syntax Specifications: ABNF</cite></a>. January 2008. Internet Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc5234">https://www.rfc-editor.org/rfc/rfc5234</a>
   <dt id="biblio-rfc8259">[RFC8259]
   <dd>T. Bray, Ed.. <a href="https://www.rfc-editor.org/rfc/rfc8259"><cite>The JavaScript Object Notation (JSON) Data Interchange Format</cite></a>. December 2017. Internet Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc8259">https://www.rfc-editor.org/rfc/rfc8259</a>
   <dt id="biblio-rfc9110">[RFC9110]
   <dd>R. Fielding, Ed.; M. Nottingham, Ed.; J. Reschke, Ed.. <a href="https://httpwg.org/specs/rfc9110.html"><cite>HTTP Semantics</cite></a>. June 2022. Internet Standard. URL: <a href="https://httpwg.org/specs/rfc9110.html">https://httpwg.org/specs/rfc9110.html</a>
   <dt id="biblio-secure-contexts">[SECURE-CONTEXTS]
   <dd>Mike West; Yan Zhu. <a href="https://w3c.github.io/webappsec-secure-contexts/"><cite>Secure Contexts</cite></a>. URL: <a href="https://w3c.github.io/webappsec-secure-contexts/">https://w3c.github.io/webappsec-secure-contexts/</a>
   <dt id="biblio-structured-fields">[STRUCTURED-FIELDS]
   <dd>Mark Nottingham; Poul-Henning Kamp. <a href="https://www.rfc-editor.org/rfc/rfc8941.html"><cite>Structured Field Values for HTTP</cite></a>. URL: <a href="https://www.rfc-editor.org/rfc/rfc8941.html">https://www.rfc-editor.org/rfc/rfc8941.html</a>
   <dt id="biblio-url">[URL]
   <dd>Anne van Kesteren. <a href="https://url.spec.whatwg.org/"><cite>URL Standard</cite></a>. Living Standard. URL: <a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>
   <dt id="biblio-webdriver">[WebDriver]
   <dd>Simon Stewart; David Burns. <a href="https://w3c.github.io/webdriver/"><cite>WebDriver</cite></a>. URL: <a href="https://w3c.github.io/webdriver/">https://w3c.github.io/webdriver/</a>
   <dt id="biblio-webidl">[WEBIDL]
   <dd>Edgar Chen; Timothy Gu. <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL Standard</cite></a>. Living Standard. URL: <a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-capability-urls">[CAPABILITY-URLS]
   <dd>Jeni Tennison. <a href="https://w3ctag.github.io/capability-urls/"><cite>Good Practices for Capability URLs</cite></a>. URL: <a href="https://w3ctag.github.io/capability-urls/">https://w3ctag.github.io/capability-urls/</a>
   <dt id="biblio-csp3">[CSP3]
   <dd>Mike West; Antonio Sartori. <a href="https://w3c.github.io/webappsec-csp/"><cite>Content Security Policy Level 3</cite></a>. URL: <a href="https://w3c.github.io/webappsec-csp/">https://w3c.github.io/webappsec-csp/</a>
   <dt id="biblio-html-design-principles">[HTML-DESIGN-PRINCIPLES]
   <dd>Anne van Kesteren; Maciej Stachowiak. <a href="https://www.w3.org/TR/html-design-principles/"><cite>HTML Design Principles</cite></a>. 26 November 2007. WD. URL: <a href="https://www.w3.org/TR/html-design-principles/">https://www.w3.org/TR/html-design-principles/</a>
   <dt id="biblio-network-error-logging">[NETWORK-ERROR-LOGGING]
   <dd>Douglas Creager; Ian Clelland. <a href="https://w3c.github.io/network-error-logging/"><cite>Network Error Logging</cite></a>. URL: <a href="https://w3c.github.io/network-error-logging/">https://w3c.github.io/network-error-logging/</a>
   <dt id="biblio-rfc7469">[RFC7469]
   <dd>C. Evans; C. Palmer; R. Sleevi. <a href="https://www.rfc-editor.org/rfc/rfc7469"><cite>Public Key Pinning Extension for HTTP</cite></a>. April 2015. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7469">https://www.rfc-editor.org/rfc/rfc7469</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->)]
<c- b>interface</c-> <a href="#reportbody"><code><c- g>ReportBody</c-></code></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Default"><c- g>Default</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-object"><c- b>object</c-></a> <a href="#dom-reportbody-tojson"><code><c- g>toJSON</c-></code></a>();
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->)]
<c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="#dom-report"><c- g>Report</c-></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Default"><c- g>Default</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-object"><c- b>object</c-></a> <a href="#dom-report-tojson"><code><c- g>toJSON</c-></code></a>();
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMString" href="#dom-report-type"><c- g>type</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMString" href="#dom-report-url"><c- g>url</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#reportbody"><c- n>ReportBody</c-></a>? <a class="idl-code" data-link-type="attribute" data-readonly data-type="ReportBody?" href="#dom-report-body"><c- g>body</c-></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->)]
<c- b>interface</c-> <a href="#reportingobserver"><code><c- g>ReportingObserver</c-></code></a> {
  <a class="idl-code" data-link-type="constructor" href="#dom-reportingobserver-reportingobserver"><c- g>constructor</c-></a>(<a data-link-type="idl-name" href="#callbackdef-reportingobservercallback"><c- n>ReportingObserverCallback</c-></a> <a href="#dom-reportingobserver-reportingobserver-callback-options-callback"><code><c- g>callback</c-></code></a>, <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-reportingobserveroptions"><c- n>ReportingObserverOptions</c-></a> <a href="#dom-reportingobserver-reportingobserver-callback-options-options"><code><c- g>options</c-></code></a> = {});
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#dom-reportingobserver-observe"><c- g>observe</c-></a>();
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#dom-reportingobserver-disconnect"><c- g>disconnect</c-></a>();
  <a data-link-type="idl-name" href="#typedefdef-reportlist"><c- n>ReportList</c-></a> <a class="idl-code" data-link-type="method" href="#dom-reportingobserver-takerecords"><c- g>takeRecords</c-></a>();
};

<c- b>callback</c-> <a href="#callbackdef-reportingobservercallback"><code><c- g>ReportingObserverCallback</c-></code></a> = <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined"><c- b>undefined</c-></a> (<a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence"><c- b>sequence</c-></a>&lt;<a data-link-type="idl-name" href="#dom-report"><c- n>Report</c-></a>> <a href="#dom-reportingobservercallback-reports"><code><c- g>reports</c-></code></a>, <a data-link-type="idl-name" href="#reportingobserver"><c- n>ReportingObserver</c-></a> <a href="#dom-reportingobservercallback-observer"><code><c- g>observer</c-></code></a>);

<c- b>dictionary</c-> <a href="#dictdef-reportingobserveroptions"><code><c- g>ReportingObserverOptions</c-></code></a> {
  <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence"><c- b>sequence</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a>> <a data-type="sequence<DOMString>" href="#dom-reportingobserveroptions-types"><code><c- g>types</c-></code></a>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean"><c- b>boolean</c-></a> <a data-default="false" data-type="boolean" href="#dom-reportingobserveroptions-buffered"><code><c- g>buffered</c-></code></a> = <c- b>false</c->;
};

<c- b>typedef</c-> <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence"><c- b>sequence</c-></a>&lt;<a data-link-type="idl-name" href="#dom-report"><c- n>Report</c-></a>> <a href="#typedefdef-reportlist"><code><c- g>ReportList</c-></code></a>;

<c- b>dictionary</c-> <a href="#dictdef-generatetestreportparameters"><code><c- g>GenerateTestReportParameters</c-></code></a> {
  <c- b>required</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a data-type="DOMString" href="#dom-generatetestreportparameters-message"><code><c- g>message</c-></code></a>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a data-default="&quot;default&quot;" data-type="DOMString" href="#dom-generatetestreportparameters-group"><code><c- g>group</c-></code></a> = "default";
};

</pre>
  <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> We don’t specify any retry mechanism here for failed reports.
  We may want to add one here, or provide some indication that the
  delivery failed. <a class="issue-return" href="#issue-7f6dd3bd" title="Jump to section">↵</a></div>
   <div class="issue"> how to polymorphically initialize body? <a class="issue-return" href="#issue-6311d126" title="Jump to section">↵</a></div>
   <div class="issue"> Consider mitigations. For example, we could
  drop reports if we change from one network to another. <a href="https://github.com/WICG/background-sync/issues/107">[WICG/background-sync Issue #107]</a> <a class="issue-return" href="#issue-acba119f" title="Jump to section">↵</a></div>
  </div>
  <details class="mdn-anno unpositioned" data-anno-for="dom-report-body">
   <summary><span>MDN</span></summary>
   <div class="feature">
    <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Report/body" title="The body read-only property of the Report interface returns the body of the report, which is a ReportBody object containing the detailed report information.">Report/body</a></p>
    <div class="support">
     <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari yes"><span>Safari</span><span>16.4+</span></span><span class="chrome yes"><span>Chrome</span><span>69+</span></span>
     <hr>
     <span class="opera no"><span>Opera</span><span>?</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
     <hr>
     <span class="edge no"><span>Edge (Legacy)</span><span>?</span></span><span class="ie no"><span>IE</span><span>None</span></span>
     <hr>
     <span class="firefox_android no"><span>Firefox for Android</span><span>?</span></span><span class="safari_ios no"><span>iOS Safari</span><span>?</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span class="webview_android no"><span>Android WebView</span><span>?</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
    </div>
   </div>
  </details>
  <details class="mdn-anno unpositioned" data-anno-for="dom-report-type">
   <summary><span>MDN</span></summary>
   <div class="feature">
    <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Report/type" title="The type read-only property of the Report interface returns the type of report generated, e.g. deprecation or intervention.">Report/type</a></p>
    <div class="support">
     <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari yes"><span>Safari</span><span>16.4+</span></span><span class="chrome yes"><span>Chrome</span><span>69+</span></span>
     <hr>
     <span class="opera no"><span>Opera</span><span>?</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
     <hr>
     <span class="edge no"><span>Edge (Legacy)</span><span>?</span></span><span class="ie no"><span>IE</span><span>None</span></span>
     <hr>
     <span class="firefox_android no"><span>Firefox for Android</span><span>?</span></span><span class="safari_ios no"><span>iOS Safari</span><span>?</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span class="webview_android no"><span>Android WebView</span><span>?</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
    </div>
   </div>
  </details>
  <details class="mdn-anno unpositioned" data-anno-for="dom-report-url">
   <summary><span>MDN</span></summary>
   <div class="feature">
    <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Report/url" title="The url read-only property of the Report interface returns the URL of the document that generated the report.">Report/url</a></p>
    <div class="support">
     <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari yes"><span>Safari</span><span>16.4+</span></span><span class="chrome yes"><span>Chrome</span><span>69+</span></span>
     <hr>
     <span class="opera no"><span>Opera</span><span>?</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
     <hr>
     <span class="edge no"><span>Edge (Legacy)</span><span>?</span></span><span class="ie no"><span>IE</span><span>None</span></span>
     <hr>
     <span class="firefox_android no"><span>Firefox for Android</span><span>?</span></span><span class="safari_ios no"><span>iOS Safari</span><span>?</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span class="webview_android no"><span>Android WebView</span><span>?</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
    </div>
   </div>
  </details>
  <details class="mdn-anno unpositioned" data-anno-for="dom-report">
   <summary><span>MDN</span></summary>
   <div class="feature">
    <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Report" title="The Report interface of the Reporting API represents a single report.">Report</a></p>
    <div class="support">
     <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari yes"><span>Safari</span><span>16.4+</span></span><span class="chrome yes"><span>Chrome</span><span>69+</span></span>
     <hr>
     <span class="opera no"><span>Opera</span><span>?</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
     <hr>
     <span class="edge no"><span>Edge (Legacy)</span><span>?</span></span><span class="ie no"><span>IE</span><span>None</span></span>
     <hr>
     <span class="firefox_android no"><span>Firefox for Android</span><span>?</span></span><span class="safari_ios no"><span>iOS Safari</span><span>?</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span class="webview_android no"><span>Android WebView</span><span>?</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
    </div>
   </div>
  </details>
  <details class="mdn-anno unpositioned" data-anno-for="reportbody">
   <summary><span>MDN</span></summary>
   <div class="feature">
    <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReportBody" title="The ReportBody interface of the Reporting API represents the body of a report. Individual report types inherit from this interface, adding specific attributes relevant to the particular report.">ReportBody</a></p>
    <div class="support">
     <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari yes"><span>Safari</span><span>16.4+</span></span><span class="chrome yes"><span>Chrome</span><span>69+</span></span>
     <hr>
     <span class="opera no"><span>Opera</span><span>?</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
     <hr>
     <span class="edge no"><span>Edge (Legacy)</span><span>?</span></span><span class="ie no"><span>IE</span><span>None</span></span>
     <hr>
     <span class="firefox_android no"><span>Firefox for Android</span><span>?</span></span><span class="safari_ios no"><span>iOS Safari</span><span>?</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span class="webview_android no"><span>Android WebView</span><span>?</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
    </div>
   </div>
  </details>
  <details class="mdn-anno unpositioned" data-anno-for="dom-reportingobserver-reportingobserver">
   <summary><span>MDN</span></summary>
   <div class="feature">
    <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReportingObserver/ReportingObserver" title="The ReportingObserver() constructor of the Reporting API creates a new ReportingObserver object instance, which can be used to collect and access reports.">ReportingObserver/ReportingObserver</a></p>
    <div class="support">
     <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari yes"><span>Safari</span><span>16.4+</span></span><span class="chrome yes"><span>Chrome</span><span>69+</span></span>
     <hr>
     <span class="opera no"><span>Opera</span><span>?</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
     <hr>
     <span class="edge no"><span>Edge (Legacy)</span><span>?</span></span><span class="ie no"><span>IE</span><span>None</span></span>
     <hr>
     <span class="firefox_android no"><span>Firefox for Android</span><span>?</span></span><span class="safari_ios no"><span>iOS Safari</span><span>?</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span class="webview_android no"><span>Android WebView</span><span>?</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
    </div>
   </div>
  </details>
  <details class="mdn-anno unpositioned" data-anno-for="dom-reportingobserver-disconnect">
   <summary><span>MDN</span></summary>
   <div class="feature">
    <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReportingObserver/disconnect" title="The disconnect() method of the ReportingObserver interface stops a reporting observer that had previously started observing from collecting reports.">ReportingObserver/disconnect</a></p>
    <div class="support">
     <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari yes"><span>Safari</span><span>16.4+</span></span><span class="chrome yes"><span>Chrome</span><span>69+</span></span>
     <hr>
     <span class="opera no"><span>Opera</span><span>?</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
     <hr>
     <span class="edge no"><span>Edge (Legacy)</span><span>?</span></span><span class="ie no"><span>IE</span><span>None</span></span>
     <hr>
     <span class="firefox_android no"><span>Firefox for Android</span><span>?</span></span><span class="safari_ios no"><span>iOS Safari</span><span>?</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span class="webview_android no"><span>Android WebView</span><span>?</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
    </div>
   </div>
  </details>
  <details class="mdn-anno unpositioned" data-anno-for="dom-reportingobserver-observe">
   <summary><span>MDN</span></summary>
   <div class="feature">
    <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReportingObserver/observe" title="The observe() method of the ReportingObserver interface instructs a reporting observer to start collecting reports in its report queue.">ReportingObserver/observe</a></p>
    <div class="support">
     <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari yes"><span>Safari</span><span>16.4+</span></span><span class="chrome yes"><span>Chrome</span><span>69+</span></span>
     <hr>
     <span class="opera no"><span>Opera</span><span>?</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
     <hr>
     <span class="edge no"><span>Edge (Legacy)</span><span>?</span></span><span class="ie no"><span>IE</span><span>None</span></span>
     <hr>
     <span class="firefox_android no"><span>Firefox for Android</span><span>?</span></span><span class="safari_ios no"><span>iOS Safari</span><span>?</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span class="webview_android no"><span>Android WebView</span><span>?</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
    </div>
   </div>
  </details>
  <details class="mdn-anno unpositioned" data-anno-for="dom-reportingobserver-takerecords">
   <summary><span>MDN</span></summary>
   <div class="feature">
    <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReportingObserver/takeRecords" title="The takeRecords() method of the ReportingObserver interface returns the current list of reports contained in the observer&apos;s report queue, and empties the queue.">ReportingObserver/takeRecords</a></p>
    <div class="support">
     <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari yes"><span>Safari</span><span>16.4+</span></span><span class="chrome yes"><span>Chrome</span><span>69+</span></span>
     <hr>
     <span class="opera no"><span>Opera</span><span>?</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
     <hr>
     <span class="edge no"><span>Edge (Legacy)</span><span>?</span></span><span class="ie no"><span>IE</span><span>None</span></span>
     <hr>
     <span class="firefox_android no"><span>Firefox for Android</span><span>?</span></span><span class="safari_ios no"><span>iOS Safari</span><span>?</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span class="webview_android no"><span>Android WebView</span><span>?</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
    </div>
   </div>
  </details>
  <details class="mdn-anno unpositioned" data-anno-for="interface-reporting-observer">
   <summary><span>MDN</span></summary>
   <div class="feature">
    <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReportingObserver" title="The ReportingObserver interface of the Reporting API allows you to collect and access reports.">ReportingObserver</a></p>
    <div class="support">
     <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari yes"><span>Safari</span><span>16.4+</span></span><span class="chrome yes"><span>Chrome</span><span>69+</span></span>
     <hr>
     <span class="opera no"><span>Opera</span><span>?</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
     <hr>
     <span class="edge no"><span>Edge (Legacy)</span><span>?</span></span><span class="ie no"><span>IE</span><span>None</span></span>
     <hr>
     <span class="firefox_android no"><span>Firefox for Android</span><span>?</span></span><span class="safari_ios no"><span>iOS Safari</span><span>?</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span class="webview_android no"><span>Android WebView</span><span>?</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
    </div>
   </div>
  </details>
<script>/* Boilerplate: script-dom-helper */
"use strict";
function query(sel) { return document.querySelector(sel); }

function queryAll(sel) { return [...document.querySelectorAll(sel)]; }

function iter(obj) {
	if(!obj) return [];
	var it = obj[Symbol.iterator];
	if(it) return it;
	return Object.entries(obj);
}

function mk(tagname, attrs, ...children) {
	const el = document.createElement(tagname);
	for(const [k,v] of iter(attrs)) {
		if(k.slice(0,3) == "_on") {
			const eventName = k.slice(3);
			el.addEventListener(eventName, v);
		} else if(k[0] == "_") {
			// property, not attribute
			el[k.slice(1)] = v;
		} else {
			if(v === false || v == null) {
        continue;
      } else if(v === true) {
        el.setAttribute(k, "");
        continue;
      } else {
  			el.setAttribute(k, v);
      }
		}
	}
	append(el, children);
	return el;
}

/* Create shortcuts for every known HTML element */
[
  "a",
  "abbr",
  "acronym",
  "address",
  "applet",
  "area",
  "article",
  "aside",
  "audio",
  "b",
  "base",
  "basefont",
  "bdo",
  "big",
  "blockquote",
  "body",
  "br",
  "button",
  "canvas",
  "caption",
  "center",
  "cite",
  "code",
  "col",
  "colgroup",
  "datalist",
  "dd",
  "del",
  "details",
  "dfn",
  "dialog",
  "div",
  "dl",
  "dt",
  "em",
  "embed",
  "fieldset",
  "figcaption",
  "figure",
  "font",
  "footer",
  "form",
  "frame",
  "frameset",
  "head",
  "header",
  "h1",
  "h2",
  "h3",
  "h4",
  "h5",
  "h6",
  "hr",
  "html",
  "i",
  "iframe",
  "img",
  "input",
  "ins",
  "kbd",
  "label",
  "legend",
  "li",
  "link",
  "main",
  "map",
  "mark",
  "meta",
  "meter",
  "nav",
  "nobr",
  "noscript",
  "object",
  "ol",
  "optgroup",
  "option",
  "output",
  "p",
  "param",
  "pre",
  "progress",
  "q",
  "s",
  "samp",
  "script",
  "section",
  "select",
  "small",
  "source",
  "span",
  "strike",
  "strong",
  "style",
  "sub",
  "summary",
  "sup",
  "table",
  "tbody",
  "td",
  "template",
  "textarea",
  "tfoot",
  "th",
  "thead",
  "time",
  "title",
  "tr",
  "u",
  "ul",
  "var",
  "video",
  "wbr",
  "xmp",
].forEach(tagname=>{
	mk[tagname] = (...args) => mk(tagname, ...args);
});

function* nodesFromChildList(children) {
	for(const child of children.flat(Infinity)) {
		if(child instanceof Node) {
			yield child;
		} else {
			yield new Text(child);
		}
	}
}
function append(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		if(el instanceof Node) el.appendChild(child);
		else el.push(child);
	}
	return el;
}

function insertAfter(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		el.parentNode.insertBefore(child, el.nextSibling);
	}
	return el;
}

function clearContents(el) {
	el.innerHTML = "";
	return el;
}

function parseHTML(markup) {
	if(markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
		const doc = document.implementation.createHTMLDocument("");
		doc.documentElement.innerHTML = markup;
		return doc;
	} else {
		const el = mk.template({});
		el.innerHTML = markup;
		return el.content;
	}
}</script>
<script>/* Boilerplate: script-dfn-panel */
"use strict";
{
let dfnPanelData = {
"024a1df2": {"dfnID":"024a1df2","dfnText":"current browsing context","external":true,"refSections":[{"refs":[{"id":"ref-for-dfn-current-browsing-context"},{"id":"ref-for-dfn-current-browsing-context\u2460"}],"title":"7.1. Generate Test Report"}],"url":"https://w3c.github.io/webdriver/#dfn-current-browsing-context"},
"040c67fa": {"dfnID":"040c67fa","dfnText":"extension command uri template","external":true,"refSections":[{"refs":[{"id":"ref-for-dfn-extension-command-uri-template"}],"title":"7.1. Generate Test Report"}],"url":"https://w3c.github.io/webdriver/#dfn-extension-command-uri-template"},
"0914e5ac": {"dfnID":"0914e5ac","dfnText":"reports directive","external":true,"refSections":[{"refs":[{"id":"ref-for-directives-reporting"},{"id":"ref-for-directives-reporting\u2460"}],"title":"1.2. Examples"}],"url":"https://w3c.github.io/webappsec-csp/#directives-reporting"},
"10ce5f6f": {"dfnID":"10ce5f6f","dfnText":"invoke","external":true,"refSections":[{"refs":[{"id":"ref-for-invoke-a-callback-function"}],"title":"4.4. \n    Invoke reporting observers with notify list\n  "}],"url":"https://webidl.spec.whatwg.org/#invoke-a-callback-function"},
"166572aa": {"dfnID":"166572aa","dfnText":"object","external":true,"refSections":[{"refs":[{"id":"ref-for-dfn-object"}],"title":"7.1. Generate Test Report"}],"url":"https://w3c.github.io/rdf-concepts/spec/#dfn-object"},
"20b42dd0": {"dfnID":"20b42dd0","dfnText":"URL","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-url"}],"title":"2.1.1. Endpoints"},{"refs":[{"id":"ref-for-concept-url\u2460"}],"title":"2.3. \n    Queue data as type for destination\n  "},{"refs":[{"id":"ref-for-concept-url\u2461"}],"title":"3.6. Strip URL for use in reports"}],"url":"https://url.spec.whatwg.org/#concept-url"},
"218c9455": {"dfnID":"218c9455","dfnText":"username (for url)","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-url-username"}],"title":"3.6. Strip URL for use in reports"}],"url":"https://url.spec.whatwg.org/#concept-url-username"},
"2382cfb6": {"dfnID":"2382cfb6","dfnText":"Content-Security-Policy","external":true,"refSections":[{"refs":[{"id":"ref-for-content-security-policy"},{"id":"ref-for-content-security-policy\u2460"}],"title":"1.2. Examples"}],"url":"https://w3c.github.io/webappsec-csp/#content-security-policy"},
"29d70c68": {"dfnID":"29d70c68","dfnText":"HTTPS state","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-response-https-state"}],"title":"3.3. \n    Process reporting endpoints for response\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-response-https-state"},
"303ff2d7": {"dfnID":"303ff2d7","dfnText":"origin","external":true,"refSections":[{"refs":[{"id":"ref-for-origin"}],"title":"2.1.1. Endpoints"},{"refs":[{"id":"ref-for-origin\u2460"}],"title":"3.3. \n    Process reporting endpoints for response\n  "},{"refs":[{"id":"ref-for-origin\u2461"},{"id":"ref-for-origin\u2462"}],"title":"3.5.1. Send reports"},{"refs":[{"id":"ref-for-origin\u2463"}],"title":"3.5.2. \n    Attempt to deliver reports to endpoint\n  "}],"url":"https://html.spec.whatwg.org/multipage/browsers.html#origin"},
"3268a8eb": {"dfnID":"3268a8eb","dfnText":"url","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-response-url"},{"id":"ref-for-concept-response-url\u2460"}],"title":"3.3. \n    Process reporting endpoints for response\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-response-url"},
"35972864": {"dfnID":"35972864","dfnText":"active document","external":true,"refSections":[{"refs":[{"id":"ref-for-nav-document"}],"title":"7.1. Generate Test Report"}],"url":"https://html.spec.whatwg.org/multipage/document-sequences.html#nav-document"},
"3a711be7": {"dfnID":"3a711be7","dfnText":"scheme","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-url-scheme"},{"id":"ref-for-concept-url-scheme\u2460"}],"title":"3.6. Strip URL for use in reports"}],"url":"https://url.spec.whatwg.org/#concept-url-scheme"},
"3de9e659": {"dfnID":"3de9e659","dfnText":"byte sequence","external":true,"refSections":[{"refs":[{"id":"ref-for-byte-sequence"}],"title":"2.4. Serialize Reports"}],"url":"https://infra.spec.whatwg.org/#byte-sequence"},
"3e12e042": {"dfnID":"3e12e042","dfnText":"environment settings object","external":true,"refSections":[{"refs":[{"id":"ref-for-environment-settings-object"},{"id":"ref-for-environment-settings-object\u2460"}],"title":"2.3. \n    Queue data as type for destination\n  "},{"refs":[{"id":"ref-for-environment-settings-object\u2461"}],"title":"7.1. Generate Test Report"}],"url":"https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"},
"4013a022": {"dfnID":"4013a022","dfnText":"this","external":true,"refSections":[{"refs":[{"id":"ref-for-this"},{"id":"ref-for-this\u2460"},{"id":"ref-for-this\u2461"},{"id":"ref-for-this\u2462"},{"id":"ref-for-this\u2463"},{"id":"ref-for-this\u2464"},{"id":"ref-for-this\u2465"},{"id":"ref-for-this\u2466"},{"id":"ref-for-this\u2467"},{"id":"ref-for-this\u2468"}],"title":"4.1. Interface ReportingObserver"}],"url":"https://webidl.spec.whatwg.org/#this"},
"449b55f1": {"dfnID":"449b55f1","dfnText":"source","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-body-source"}],"title":"3.5.2. \n    Attempt to deliver reports to endpoint\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-body-source"},
"4be6272b": {"dfnID":"4be6272b","dfnText":"success","external":true,"refSections":[{"refs":[{"id":"ref-for-dfn-success"}],"title":"7.1. Generate Test Report"}],"url":"https://w3c.github.io/webdriver/#dfn-success"},
"4c07280e": {"dfnID":"4c07280e","dfnText":"serialize an Infra value to JSON bytes","external":true,"refSections":[{"refs":[{"id":"ref-for-serialize-an-infra-value-to-json-bytes"}],"title":"2.4. Serialize Reports"}],"url":"https://infra.spec.whatwg.org/#serialize-an-infra-value-to-json-bytes"},
"5372cca8": {"dfnID":"5372cca8","dfnText":"boolean","external":true,"refSections":[{"refs":[{"id":"ref-for-idl-boolean"}],"title":"4.1. Interface ReportingObserver"}],"url":"https://webidl.spec.whatwg.org/#idl-boolean"},
"543d1495": {"dfnID":"543d1495","dfnText":"navigator.userAgent","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-navigator-useragent"}],"title":"2.3. \n    Queue data as type for destination\n  "}],"url":"https://html.spec.whatwg.org/multipage/system-state.html#dom-navigator-useragent"},
"5442ea33": {"dfnID":"5442ea33","dfnText":"URL serializer","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-url-serializer"}],"title":"2.3. \n    Queue data as type for destination\n  "},{"refs":[{"id":"ref-for-concept-url-serializer\u2460"}],"title":"3.6. Strip URL for use in reports"}],"url":"https://url.spec.whatwg.org/#concept-url-serializer"},
"55213b5b": {"dfnID":"55213b5b","dfnText":"request","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-request"}],"title":"2.1.3. Reports"},{"refs":[{"id":"ref-for-concept-request\u2460"},{"id":"ref-for-concept-request\u2461"}],"title":"3.5.2. \n    Attempt to deliver reports to endpoint\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-request"},
"5c66de35": {"dfnID":"5c66de35","dfnText":"get a structured field value","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-header-list-get-structured-header"}],"title":"3.3. \n    Process reporting endpoints for response\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-header-list-get-structured-header"},
"5cf0e148": {"dfnID":"5cf0e148","dfnText":"WebDriver error","external":true,"refSections":[{"refs":[{"id":"ref-for-dfn-error"},{"id":"ref-for-dfn-error\u2460"},{"id":"ref-for-dfn-error\u2461"},{"id":"ref-for-dfn-error\u2462"}],"title":"7.1. Generate Test Report"}],"url":"https://w3c.github.io/webdriver/#dfn-error"},
"5f6d392d": {"dfnID":"5f6d392d","dfnText":"WindowOrWorkerGlobalScope","external":true,"refSections":[{"refs":[{"id":"ref-for-windoworworkerglobalscope"},{"id":"ref-for-windoworworkerglobalscope\u2460"},{"id":"ref-for-windoworworkerglobalscope\u2461"}],"title":"3.1. Document configuration"},{"refs":[{"id":"ref-for-windoworworkerglobalscope\u2462"}],"title":"3.4.1. Generate report of type with\n  data"},{"refs":[{"id":"ref-for-windoworworkerglobalscope\u2463"}],"title":"3.5.1. Send reports"},{"refs":[{"id":"ref-for-windoworworkerglobalscope\u2464"},{"id":"ref-for-windoworworkerglobalscope\u2465"},{"id":"ref-for-windoworworkerglobalscope\u2466"}],"title":"4. Reporting Observers"},{"refs":[{"id":"ref-for-windoworworkerglobalscope\u2467"}],"title":"4.2. \n    Notify reporting observers on scope with report\n  "}],"url":"https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope"},
"5f90bbfb": {"dfnID":"5f90bbfb","dfnText":"undefined","external":true,"refSections":[{"refs":[{"id":"ref-for-idl-undefined"},{"id":"ref-for-idl-undefined\u2460"},{"id":"ref-for-idl-undefined\u2461"}],"title":"4.1. Interface ReportingObserver"}],"url":"https://webidl.spec.whatwg.org/#idl-undefined"},
"644cb530": {"dfnID":"644cb530","dfnText":"body","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-body"}],"title":"3.5.2. \n    Attempt to deliver reports to endpoint\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-body"},
"649608b9": {"dfnID":"649608b9","dfnText":"list","external":true,"refSections":[{"refs":[{"id":"ref-for-list"}],"title":"4. Reporting Observers"}],"url":"https://infra.spec.whatwg.org/#list"},
"64db426e": {"dfnID":"64db426e","dfnText":"creation URL","external":true,"refSections":[{"refs":[{"id":"ref-for-creation-url"}],"title":"2.3. \n    Queue data as type for destination\n  "}],"url":"https://html.spec.whatwg.org/multipage/webappapis.html#creation-url"},
"692595fe": {"dfnID":"692595fe","dfnText":"ordered set","external":true,"refSections":[{"refs":[{"id":"ref-for-ordered-set"}],"title":"4. Reporting Observers"}],"url":"https://infra.spec.whatwg.org/#ordered-set"},
"7482107b": {"dfnID":"7482107b","dfnText":"WebDriver error code","external":true,"refSections":[{"refs":[{"id":"ref-for-dfn-error-code"},{"id":"ref-for-dfn-error-code\u2460"},{"id":"ref-for-dfn-error-code\u2461"}],"title":"7.1. Generate Test Report"}],"url":"https://w3c.github.io/webdriver/#dfn-error-code"},
"7aa9c8e0": {"dfnID":"7aa9c8e0","dfnText":"trying","external":true,"refSections":[{"refs":[{"id":"ref-for-dfn-try"}],"title":"7.1. Generate Test Report"}],"url":"https://w3c.github.io/webdriver/#dfn-try"},
"82c23298": {"dfnID":"82c23298","dfnText":"remote end steps","external":true,"refSections":[{"refs":[{"id":"ref-for-dfn-remote-end-steps"}],"title":"7.1. Generate Test Report"}],"url":"https://w3c.github.io/webdriver/#dfn-remote-end-steps"},
"83c59a3a": {"dfnID":"83c59a3a","dfnText":"WorkerGlobalScope","external":true,"refSections":[{"refs":[{"id":"ref-for-workerglobalscope"}],"title":"3.4.1. Generate report of type with\n  data"}],"url":"https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope"},
"844c841b": {"dfnID":"844c841b","dfnText":"potentially trustworthy","external":true,"refSections":[{"refs":[{"id":"ref-for-is-origin-trustworthy"}],"title":"3.2. The Reporting-Endpoints HTTP Response Header Field"},{"refs":[{"id":"ref-for-is-origin-trustworthy\u2460"},{"id":"ref-for-is-origin-trustworthy\u2461"}],"title":"3.3. \n    Process reporting endpoints for response\n  "}],"url":"https://w3c.github.io/webappsec-secure-contexts/#is-origin-trustworthy"},
"85394472": {"dfnID":"85394472","dfnText":"Document","external":true,"refSections":[{"refs":[{"id":"ref-for-document"}],"title":"3.4.1. Generate report of type with\n  data"}],"url":"https://dom.spec.whatwg.org/#document"},
"8855a9aa": {"dfnID":"8855a9aa","dfnText":"DOMString","external":true,"refSections":[{"refs":[{"id":"ref-for-idl-DOMString"},{"id":"ref-for-idl-DOMString\u2460"},{"id":"ref-for-idl-DOMString\u2461"}],"title":"4.1. Interface ReportingObserver"},{"refs":[{"id":"ref-for-idl-DOMString\u2462"},{"id":"ref-for-idl-DOMString\u2463"}],"title":"7.1. Generate Test Report"}],"url":"https://webidl.spec.whatwg.org/#idl-DOMString"},
"889e932f": {"dfnID":"889e932f","dfnText":"Exposed","external":true,"refSections":[{"refs":[{"id":"ref-for-Exposed"},{"id":"ref-for-Exposed\u2460"},{"id":"ref-for-Exposed\u2461"}],"title":"4.1. Interface ReportingObserver"}],"url":"https://webidl.spec.whatwg.org/#Exposed"},
"8a30477b": {"dfnID":"8a30477b","dfnText":"global object","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-settings-object-global"}],"title":"3.4.1. Generate report of type with\n  data"}],"url":"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global"},
"8da4d1e3": {"dfnID":"8da4d1e3","dfnText":"invalid argument","external":true,"refSections":[{"refs":[{"id":"ref-for-dfn-invalid-argument"},{"id":"ref-for-dfn-invalid-argument\u2460"}],"title":"7.1. Generate Test Report"}],"url":"https://w3c.github.io/webdriver/#dfn-invalid-argument"},
"95210ccd": {"dfnID":"95210ccd","dfnText":"password (for URL)","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-url-password"}],"title":"2.3. \n    Queue data as type for destination\n  "}],"url":"https://url.spec.whatwg.org/#dom-url-password"},
"9a517a7d": {"dfnID":"9a517a7d","dfnText":"queue a task","external":true,"refSections":[{"refs":[{"id":"ref-for-queue-a-task"}],"title":"3.5.2. \n    Attempt to deliver reports to endpoint\n  "},{"refs":[{"id":"ref-for-queue-a-task\u2460"}],"title":"4.1. Interface ReportingObserver"},{"refs":[{"id":"ref-for-queue-a-task\u2461"}],"title":"4.3. \n    Add report to observer\n  "}],"url":"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"},
"9a79363d": {"dfnID":"9a79363d","dfnText":"wait for a response","external":true,"refSections":[{"refs":[{"id":"ref-for-wait-for-a-response"}],"title":"3.5.2. \n    Attempt to deliver reports to endpoint\n  "}],"url":"https://fetch.spec.whatwg.org/#wait-for-a-response"},
"9c4c1e66": {"dfnID":"9c4c1e66","dfnText":"relevant settings object","external":true,"refSections":[{"refs":[{"id":"ref-for-relevant-settings-object"}],"title":"3.4.1. Generate report of type with\n  data"}],"url":"https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"},
"9cce47fd": {"dfnID":"9cce47fd","dfnText":"sequence","external":true,"refSections":[{"refs":[{"id":"ref-for-idl-sequence"},{"id":"ref-for-idl-sequence\u2460"},{"id":"ref-for-idl-sequence\u2461"}],"title":"4.1. Interface ReportingObserver"}],"url":"https://webidl.spec.whatwg.org/#idl-sequence"},
"a1288f2a": {"dfnID":"a1288f2a","dfnText":"password (for url)","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-url-password"}],"title":"3.6. Strip URL for use in reports"}],"url":"https://url.spec.whatwg.org/#concept-url-password"},
"a1894061": {"dfnID":"a1894061","dfnText":"no such window","external":true,"refSections":[{"refs":[{"id":"ref-for-dfn-no-such-window"}],"title":"7.1. Generate Test Report"}],"url":"https://w3c.github.io/webdriver/#dfn-no-such-window"},
"a27468c5": {"dfnID":"a27468c5","dfnText":"ok status","external":true,"refSections":[{"refs":[{"id":"ref-for-ok-status"}],"title":"3.5.2. \n    Attempt to deliver reports to endpoint\n  "}],"url":"https://fetch.spec.whatwg.org/#ok-status"},
"a33db89a": {"dfnID":"a33db89a","dfnText":"fetch","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-fetch"}],"title":"3.5.2. \n    Attempt to deliver reports to endpoint\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-fetch"},
"a9bf6bd5": {"dfnID":"a9bf6bd5","dfnText":"callback this value","external":true,"refSections":[{"refs":[{"id":"ref-for-dfn-callback-this-value"}],"title":"4.4. \n    Invoke reporting observers with notify list\n  "}],"url":"https://webidl.spec.whatwg.org/#dfn-callback-this-value"},
"b3505eba": {"dfnID":"b3505eba","dfnText":"handle any user prompts","external":true,"refSections":[{"refs":[{"id":"ref-for-dfn-handle-any-user-prompts"}],"title":"7.1. Generate Test Report"}],"url":"https://w3c.github.io/webdriver/#dfn-handle-any-user-prompts"},
"b9d1df32": {"dfnID":"b9d1df32","dfnText":"base URL","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-base-url"}],"title":"3.3. \n    Process reporting endpoints for response\n  "}],"url":"https://url.spec.whatwg.org/#concept-base-url"},
"bc7f2174": {"dfnID":"bc7f2174","dfnText":"extension command","external":true,"refSections":[{"refs":[{"id":"ref-for-dfn-extension-command"}],"title":"7. Automation"},{"refs":[{"id":"ref-for-dfn-extension-command\u2460"},{"id":"ref-for-dfn-extension-command\u2461"}],"title":"7.1. Generate Test Report"}],"url":"https://w3c.github.io/webdriver/#dfn-extension-command"},
"c0666585": {"dfnID":"c0666585","dfnText":"sf-dictionary","external":true,"refSections":[{"refs":[{"id":"ref-for-section-3.2"}],"title":"3.2. The Reporting-Endpoints HTTP Response Header Field"}],"url":"https://www.rfc-editor.org/rfc/rfc8941.html#section-3.2"},
"c0fa3c07": {"dfnID":"c0fa3c07","dfnText":"Public-Key-Pins","external":true,"refSections":[{"refs":[{"id":"ref-for-section-2.1"},{"id":"ref-for-section-2.1\u2460"}],"title":"1.2. Examples"}],"url":"https://tools.ietf.org/html/rfc7469#section-2.1"},
"c4c32895": {"dfnID":"c4c32895","dfnText":"origin of a url","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-url-origin"}],"title":"3.3. \n    Process reporting endpoints for response\n  "}],"url":"https://url.spec.whatwg.org/#concept-url-origin"},
"c8829574": {"dfnID":"c8829574","dfnText":"JSON text","external":true,"refSections":[{"refs":[{"id":"ref-for-section-2"}],"title":"2.1.3. Reports"},{"refs":[{"id":"ref-for-section-2\u2460"}],"title":"7.1. Generate Test Report"}],"url":"https://tools.ietf.org/html/rfc8259#section-2"},
"c9e7c11a": {"dfnID":"c9e7c11a","dfnText":"header","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-header"}],"title":"2.1.3. Reports"},{"refs":[{"id":"ref-for-concept-header\u2460"}],"title":"3.5.2. \n    Attempt to deliver reports to endpoint\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-header"},
"ca3ca4ae": {"dfnID":"ca3ca4ae","dfnText":"URL parser","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-url-parser"}],"title":"3.3. \n    Process reporting endpoints for response\n  "}],"url":"https://url.spec.whatwg.org/#concept-url-parser"},
"callbackdef-reportingobservercallback": {"dfnID":"callbackdef-reportingobservercallback","dfnText":"ReportingObserverCallback","external":false,"refSections":[{"refs":[{"id":"ref-for-callbackdef-reportingobservercallback"}],"title":"4.1. Interface ReportingObserver"}],"url":"#callbackdef-reportingobservercallback"},
"d6f79d11": {"dfnID":"d6f79d11","dfnText":"username (for URL)","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-url-username"}],"title":"2.3. \n    Queue data as type for destination\n  "}],"url":"https://url.spec.whatwg.org/#dom-url-username"},
"d85a6c84": {"dfnID":"d85a6c84","dfnText":"header list","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-header-list"}],"title":"3.5.2. \n    Attempt to deliver reports to endpoint\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-header-list"},
"dcffbccd": {"dfnID":"dcffbccd","dfnText":"URL","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-url"}],"title":"2.1.1. Endpoints"},{"refs":[{"id":"ref-for-concept-url\u2460"}],"title":"2.3. \n    Queue data as type for destination\n  "},{"refs":[{"id":"ref-for-concept-url\u2461"}],"title":"3.6. Strip URL for use in reports"}],"url":"https://url.spec.whatwg.org/#concept-url"},
"dictdef-generatetestreportparameters": {"dfnID":"dictdef-generatetestreportparameters","dfnText":"GenerateTestReportParameters","external":false,"refSections":[],"url":"#dictdef-generatetestreportparameters"},
"dictdef-reportingobserveroptions": {"dfnID":"dictdef-reportingobserveroptions","dfnText":"ReportingObserverOptions","external":false,"refSections":[{"refs":[{"id":"ref-for-dictdef-reportingobserveroptions"},{"id":"ref-for-dictdef-reportingobserveroptions\u2460"}],"title":"4.1. Interface ReportingObserver"}],"url":"#dictdef-reportingobserveroptions"},
"dom-endpoint-failures": {"dfnID":"dom-endpoint-failures","dfnText":"failures","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-endpoint-failures"}],"title":"3.3. \n    Process reporting endpoints for response\n  "},{"refs":[{"id":"ref-for-dom-endpoint-failures\u2460"}],"title":"3.5.1. Send reports"},{"refs":[{"id":"ref-for-dom-endpoint-failures\u2461"}],"title":"5.2. Garbage Collection"}],"url":"#dom-endpoint-failures"},
"dom-endpoint-name": {"dfnID":"dom-endpoint-name","dfnText":"name","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-endpoint-name"}],"title":"2.1.3. Reports"},{"refs":[{"id":"ref-for-dom-endpoint-name\u2460"}],"title":"3.1. Document configuration"},{"refs":[{"id":"ref-for-dom-endpoint-name\u2461"}],"title":"3.3. \n    Process reporting endpoints for response\n  "},{"refs":[{"id":"ref-for-dom-endpoint-name\u2462"}],"title":"3.5.1. Send reports"}],"url":"#dom-endpoint-name"},
"dom-endpoint-url": {"dfnID":"dom-endpoint-url","dfnText":"url","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-endpoint-url"}],"title":"3.3. \n    Process reporting endpoints for response\n  "},{"refs":[{"id":"ref-for-dom-endpoint-url\u2460"}],"title":"3.5.2. \n    Attempt to deliver reports to endpoint\n  "}],"url":"#dom-endpoint-url"},
"dom-generatetestreportparameters-group": {"dfnID":"dom-generatetestreportparameters-group","dfnText":"group","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-generatetestreportparameters-group"}],"title":"7.1. Generate Test Report"}],"url":"#dom-generatetestreportparameters-group"},
"dom-generatetestreportparameters-message": {"dfnID":"dom-generatetestreportparameters-message","dfnText":"message","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-generatetestreportparameters-message"}],"title":"7.1. Generate Test Report"}],"url":"#dom-generatetestreportparameters-message"},
"dom-report": {"dfnID":"dom-report","dfnText":"Report","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-report"},{"id":"ref-for-dom-report\u2460"},{"id":"ref-for-dom-report\u2461"},{"id":"ref-for-dom-report\u2462"},{"id":"ref-for-dom-report\u2463"}],"title":"4.1. Interface ReportingObserver"},{"refs":[{"id":"ref-for-dom-report\u2464"}],"title":"4.3. \n    Add report to observer\n  "}],"url":"#dom-report"},
"dom-report-body": {"dfnID":"dom-report-body","dfnText":"body","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-report-body"}],"title":"4.1. Interface ReportingObserver"},{"refs":[{"id":"ref-for-dom-report-body\u2460"}],"title":"4.3. \n    Add report to observer\n  "}],"url":"#dom-report-body"},
"dom-report-tojson": {"dfnID":"dom-report-tojson","dfnText":"toJSON","external":false,"refSections":[],"url":"#dom-report-tojson"},
"dom-report-type": {"dfnID":"dom-report-type","dfnText":"type","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-report-type"}],"title":"4.1. Interface ReportingObserver"},{"refs":[{"id":"ref-for-dom-report-type\u2460"}],"title":"4.3. \n    Add report to observer\n  "}],"url":"#dom-report-type"},
"dom-report-url": {"dfnID":"dom-report-url","dfnText":"url","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-report-url"}],"title":"4.1. Interface ReportingObserver"},{"refs":[{"id":"ref-for-dom-report-url\u2460"}],"title":"4.3. \n    Add report to observer\n  "}],"url":"#dom-report-url"},
"dom-reportbody-tojson": {"dfnID":"dom-reportbody-tojson","dfnText":"toJSON","external":false,"refSections":[],"url":"#dom-reportbody-tojson"},
"dom-reportingobserver-disconnect": {"dfnID":"dom-reportingobserver-disconnect","dfnText":"disconnect()","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-reportingobserver-disconnect"}],"title":"4.1. Interface ReportingObserver"}],"url":"#dom-reportingobserver-disconnect"},
"dom-reportingobserver-observe": {"dfnID":"dom-reportingobserver-observe","dfnText":"observe()","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-reportingobserver-observe"}],"title":"4.1. Interface ReportingObserver"}],"url":"#dom-reportingobserver-observe"},
"dom-reportingobserver-reportingobserver": {"dfnID":"dom-reportingobserver-reportingobserver","dfnText":"\n  ReportingObserver(callback, options)","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-reportingobserver-reportingobserver"}],"title":"4.1. Interface ReportingObserver"}],"url":"#dom-reportingobserver-reportingobserver"},
"dom-reportingobserver-reportingobserver-callback-options-callback": {"dfnID":"dom-reportingobserver-reportingobserver-callback-options-callback","dfnText":"callback","external":false,"refSections":[],"url":"#dom-reportingobserver-reportingobserver-callback-options-callback"},
"dom-reportingobserver-reportingobserver-callback-options-options": {"dfnID":"dom-reportingobserver-reportingobserver-callback-options-options","dfnText":"options","external":false,"refSections":[],"url":"#dom-reportingobserver-reportingobserver-callback-options-options"},
"dom-reportingobserver-takerecords": {"dfnID":"dom-reportingobserver-takerecords","dfnText":"takeRecords()","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-reportingobserver-takerecords"}],"title":"4.1. Interface ReportingObserver"}],"url":"#dom-reportingobserver-takerecords"},
"dom-reportingobservercallback-observer": {"dfnID":"dom-reportingobservercallback-observer","dfnText":"observer","external":false,"refSections":[],"url":"#dom-reportingobservercallback-observer"},
"dom-reportingobservercallback-reports": {"dfnID":"dom-reportingobservercallback-reports","dfnText":"reports","external":false,"refSections":[],"url":"#dom-reportingobservercallback-reports"},
"dom-reportingobserveroptions-buffered": {"dfnID":"dom-reportingobserveroptions-buffered","dfnText":"buffered","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-reportingobserveroptions-buffered"}],"title":"4. Reporting Observers"},{"refs":[{"id":"ref-for-dom-reportingobserveroptions-buffered\u2460"},{"id":"ref-for-dom-reportingobserveroptions-buffered\u2461"}],"title":"4.1. Interface ReportingObserver"}],"url":"#dom-reportingobserveroptions-buffered"},
"dom-reportingobserveroptions-types": {"dfnID":"dom-reportingobserveroptions-types","dfnText":"types","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-reportingobserveroptions-types"}],"title":"4.3. \n    Add report to observer\n  "}],"url":"#dom-reportingobserveroptions-types"},
"e99bd18e": {"dfnID":"e99bd18e","dfnText":"relevant global object","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-relevant-global"},{"id":"ref-for-concept-relevant-global\u2460"}],"title":"4.1. Interface ReportingObserver"},{"refs":[{"id":"ref-for-concept-relevant-global\u2461"}],"title":"4.3. \n    Add report to observer\n  "}],"url":"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global"},
"eb62573b": {"dfnID":"eb62573b","dfnText":"HTTP(S) scheme","external":true,"refSections":[{"refs":[{"id":"ref-for-http-scheme"}],"title":"3.6. Strip URL for use in reports"}],"url":"https://fetch.spec.whatwg.org/#http-scheme"},
"ed948033": {"dfnID":"ed948033","dfnText":"fragment","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-url-fragment"}],"title":"3.6. Strip URL for use in reports"}],"url":"https://url.spec.whatwg.org/#concept-url-fragment"},
"ee7bba09": {"dfnID":"ee7bba09","dfnText":"response","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-response"}],"title":"3.1. Document configuration"},{"refs":[{"id":"ref-for-concept-response\u2460"}],"title":"3.3. \n    Process reporting endpoints for response\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-response"},
"efd1ec5d": {"dfnID":"efd1ec5d","dfnText":"object","external":true,"refSections":[{"refs":[{"id":"ref-for-idl-object"},{"id":"ref-for-idl-object\u2460"}],"title":"4.1. Interface ReportingObserver"}],"url":"https://webidl.spec.whatwg.org/#idl-object"},
"endpoint": {"dfnID":"endpoint","dfnText":"endpoint","external":false,"refSections":[{"refs":[{"id":"ref-for-endpoint"},{"id":"ref-for-endpoint\u2460"},{"id":"ref-for-endpoint\u2461"}],"title":"2.1.1. Endpoints"},{"refs":[{"id":"ref-for-endpoint\u2462"}],"title":"2.1.3. Reports"},{"refs":[{"id":"ref-for-endpoint\u2463"}],"title":"3.1. Document configuration"},{"refs":[{"id":"ref-for-endpoint\u2464"},{"id":"ref-for-endpoint\u2465"},{"id":"ref-for-endpoint\u2466"},{"id":"ref-for-endpoint\u2467"}],"title":"3.2. The Reporting-Endpoints HTTP Response Header Field"},{"refs":[{"id":"ref-for-endpoint\u2468"},{"id":"ref-for-endpoint\u2460\u24ea"}],"title":"3.3. \n    Process reporting endpoints for response\n  "},{"refs":[{"id":"ref-for-endpoint\u2460\u2460"},{"id":"ref-for-endpoint\u2460\u2461"}],"title":"3.5.1. Send reports"},{"refs":[{"id":"ref-for-endpoint\u2460\u2462"}],"title":"3.5.2. \n    Attempt to deliver reports to endpoint\n  "},{"refs":[{"id":"ref-for-endpoint\u2460\u2463"},{"id":"ref-for-endpoint\u2460\u2464"}],"title":"5.2. Garbage Collection"}],"url":"#endpoint"},
"f4531911": {"dfnID":"f4531911","dfnText":"Default","external":true,"refSections":[{"refs":[{"id":"ref-for-Default"},{"id":"ref-for-Default\u2460"}],"title":"4.1. Interface ReportingObserver"}],"url":"https://webidl.spec.whatwg.org/#Default"},
"f7b00a8b": {"dfnID":"f7b00a8b","dfnText":"header list (for response)","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-response-header-list"}],"title":"3.3. \n    Process reporting endpoints for response\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-response-header-list"},
"f937b7b6": {"dfnID":"f937b7b6","dfnText":"continue","external":true,"refSections":[{"refs":[{"id":"ref-for-iteration-continue"},{"id":"ref-for-iteration-continue\u2460"},{"id":"ref-for-iteration-continue\u2461"}],"title":"3.3. \n    Process reporting endpoints for response\n  "}],"url":"https://infra.spec.whatwg.org/#iteration-continue"},
"generate-a-report": {"dfnID":"generate-a-report","dfnText":"generate a report","external":false,"refSections":[{"refs":[{"id":"ref-for-generate-a-report"}],"title":"3.4.1. Generate report of type with\n  data"}],"url":"#generate-a-report"},
"generate-and-queue-a-report": {"dfnID":"generate-and-queue-a-report","dfnText":"generate and queue a report","external":false,"refSections":[{"refs":[{"id":"ref-for-generate-and-queue-a-report"}],"title":"7.1. Generate Test Report"}],"url":"#generate-and-queue-a-report"},
"generate-and-queue-a-report-context": {"dfnID":"generate-and-queue-a-report-context","dfnText":"context","external":false,"refSections":[],"url":"#generate-and-queue-a-report-context"},
"generate-and-queue-a-report-data": {"dfnID":"generate-and-queue-a-report-data","dfnText":"data","external":false,"refSections":[],"url":"#generate-and-queue-a-report-data"},
"generate-and-queue-a-report-destination": {"dfnID":"generate-and-queue-a-report-destination","dfnText":"destination","external":false,"refSections":[],"url":"#generate-and-queue-a-report-destination"},
"generate-and-queue-a-report-type": {"dfnID":"generate-and-queue-a-report-type","dfnText":"type","external":false,"refSections":[],"url":"#generate-and-queue-a-report-type"},
"generate-test-report": {"dfnID":"generate-test-report","dfnText":"Generate Test Report","external":false,"refSections":[],"url":"#generate-test-report"},
"initialize-a-globals-endpoint-list": {"dfnID":"initialize-a-globals-endpoint-list","dfnText":"initialize a global\u2019s endpoint list","external":false,"refSections":[],"url":"#initialize-a-globals-endpoint-list"},
"registered": {"dfnID":"registered","dfnText":"registered","external":false,"refSections":[{"refs":[{"id":"ref-for-registered"}],"title":"4.1. Interface ReportingObserver"},{"refs":[{"id":"ref-for-registered\u2460"},{"id":"ref-for-registered\u2461"}],"title":"4.2. \n    Notify reporting observers on scope with report\n  "},{"refs":[{"id":"ref-for-registered\u2462"}],"title":"7.1. Generate Test Report"}],"url":"#registered"},
"report": {"dfnID":"report","dfnText":"report","external":false,"refSections":[{"refs":[{"id":"ref-for-report"}],"title":"2.1.2. Report Type"},{"refs":[{"id":"ref-for-report\u2460"},{"id":"ref-for-report\u2461"},{"id":"ref-for-report\u2462"},{"id":"ref-for-report\u2463"},{"id":"ref-for-report\u2464"},{"id":"ref-for-report\u2465"},{"id":"ref-for-report\u2466"},{"id":"ref-for-report\u2467"},{"id":"ref-for-report\u2468"},{"id":"ref-for-report\u2460\u24ea"},{"id":"ref-for-report\u2460\u2460"}],"title":"2.1.3. Reports"},{"refs":[{"id":"ref-for-report\u2460\u2461"}],"title":"2.3. \n    Queue data as type for destination\n  "},{"refs":[{"id":"ref-for-report\u2460\u2462"}],"title":"3.1. Document configuration"},{"refs":[{"id":"ref-for-report\u2460\u2463"},{"id":"ref-for-report\u2460\u2464"},{"id":"ref-for-report\u2460\u2465"}],"title":"3.5.1. Send reports"},{"refs":[{"id":"ref-for-report\u2460\u2466"}],"title":"4.1. Interface ReportingObserver"},{"refs":[{"id":"ref-for-report\u2460\u2467"}],"title":"4.3. \n    Add report to observer\n  "},{"refs":[{"id":"ref-for-report\u2460\u2468"},{"id":"ref-for-report\u2461\u24ea"},{"id":"ref-for-report\u2461\u2460"}],"title":"5.2. Garbage Collection"},{"refs":[{"id":"ref-for-report\u2461\u2461"}],"title":"7.1. Generate Test Report"},{"refs":[{"id":"ref-for-report\u2461\u2462"}],"title":"8.1. Capability URLs"}],"url":"#report"},
"report-attempts": {"dfnID":"report-attempts","dfnText":"attempts","external":false,"refSections":[{"refs":[{"id":"ref-for-report-attempts"}],"title":"2.3. \n    Queue data as type for destination\n  "},{"refs":[{"id":"ref-for-report-attempts\u2460"}],"title":"2.4. Serialize Reports"}],"url":"#report-attempts"},
"report-body": {"dfnID":"report-body","dfnText":"body","external":false,"refSections":[{"refs":[{"id":"ref-for-report-body"}],"title":"2.1.2. Report Type"},{"refs":[{"id":"ref-for-report-body\u2460"}],"title":"2.1.3. Reports"},{"refs":[{"id":"ref-for-report-body\u2461"}],"title":"2.3. \n    Queue data as type for destination\n  "},{"refs":[{"id":"ref-for-report-body\u2462"}],"title":"2.4. Serialize Reports"},{"refs":[{"id":"ref-for-report-body\u2463"}],"title":"4.1. Interface ReportingObserver"},{"refs":[{"id":"ref-for-report-body\u2464"}],"title":"4.3. \n    Add report to observer\n  "},{"refs":[{"id":"ref-for-report-body\u2465"},{"id":"ref-for-report-body\u2466"}],"title":"8.1. Capability URLs"}],"url":"#report-body"},
"report-destination": {"dfnID":"report-destination","dfnText":"destination","external":false,"refSections":[{"refs":[{"id":"ref-for-report-destination"}],"title":"2.3. \n    Queue data as type for destination\n  "},{"refs":[{"id":"ref-for-report-destination\u2460"}],"title":"3.5.1. Send reports"}],"url":"#report-destination"},
"report-reporttype": {"dfnID":"report-reporttype","dfnText":"type","external":false,"refSections":[{"refs":[{"id":"ref-for-report-reporttype"}],"title":"2.1.3. Reports"},{"refs":[{"id":"ref-for-report-reporttype\u2460"}],"title":"2.3. \n    Queue data as type for destination\n  "},{"refs":[{"id":"ref-for-report-reporttype\u2461"}],"title":"2.4. Serialize Reports"},{"refs":[{"id":"ref-for-report-reporttype\u2462"}],"title":"4.1. Interface ReportingObserver"},{"refs":[{"id":"ref-for-report-reporttype\u2463"},{"id":"ref-for-report-reporttype\u2464"},{"id":"ref-for-report-reporttype\u2465"}],"title":"4.2. \n    Notify reporting observers on scope with report\n  "},{"refs":[{"id":"ref-for-report-reporttype\u2466"},{"id":"ref-for-report-reporttype\u2467"},{"id":"ref-for-report-reporttype\u2468"},{"id":"ref-for-report-reporttype\u2460\u24ea"}],"title":"4.3. \n    Add report to observer\n  "}],"url":"#report-reporttype"},
"report-timestamp": {"dfnID":"report-timestamp","dfnText":"timestamp","external":false,"refSections":[{"refs":[{"id":"ref-for-report-timestamp"}],"title":"2.3. \n    Queue data as type for destination\n  "},{"refs":[{"id":"ref-for-report-timestamp\u2460"}],"title":"2.4. Serialize Reports"}],"url":"#report-timestamp"},
"report-type": {"dfnID":"report-type","dfnText":"report type","external":false,"refSections":[{"refs":[{"id":"ref-for-report-type"},{"id":"ref-for-report-type\u2460"}],"title":"2.1.2. Report Type"},{"refs":[{"id":"ref-for-report-type\u2461"}],"title":"2.1.3. Reports"}],"url":"#report-type"},
"report-url": {"dfnID":"report-url","dfnText":"url","external":false,"refSections":[{"refs":[{"id":"ref-for-report-url"}],"title":"2.3. \n    Queue data as type for destination\n  "},{"refs":[{"id":"ref-for-report-url\u2460"}],"title":"2.4. Serialize Reports"},{"refs":[{"id":"ref-for-report-url\u2461"}],"title":"3.5.1. Send reports"},{"refs":[{"id":"ref-for-report-url\u2462"}],"title":"4.1. Interface ReportingObserver"},{"refs":[{"id":"ref-for-report-url\u2463"}],"title":"4.3. \n    Add report to observer\n  "}],"url":"#report-url"},
"report-user-agent": {"dfnID":"report-user-agent","dfnText":"user agent","external":false,"refSections":[{"refs":[{"id":"ref-for-report-user-agent"}],"title":"2.1.3. Reports"},{"refs":[{"id":"ref-for-report-user-agent\u2460"}],"title":"2.3. \n    Queue data as type for destination\n  "},{"refs":[{"id":"ref-for-report-user-agent\u2461"}],"title":"2.4. Serialize Reports"}],"url":"#report-user-agent"},
"reportbody": {"dfnID":"reportbody","dfnText":"ReportBody","external":false,"refSections":[{"refs":[{"id":"ref-for-reportbody"}],"title":"4.1. Interface ReportingObserver"}],"url":"#reportbody"},
"reporting-endpoints": {"dfnID":"reporting-endpoints","dfnText":"Reporting-Endpoints","external":false,"refSections":[{"refs":[{"id":"ref-for-reporting-endpoints"},{"id":"ref-for-reporting-endpoints\u2460"}],"title":"1.2. Examples"},{"refs":[{"id":"ref-for-reporting-endpoints\u2461"},{"id":"ref-for-reporting-endpoints\u2462"}],"title":"3.2. The Reporting-Endpoints HTTP Response Header Field"}],"url":"#reporting-endpoints"},
"reporting-observer": {"dfnID":"reporting-observer","dfnText":"reporting observer","external":false,"refSections":[{"refs":[{"id":"ref-for-reporting-observer"}],"title":"2.1.2. Report Type"},{"refs":[{"id":"ref-for-reporting-observer\u2460"},{"id":"ref-for-reporting-observer\u2461"}],"title":"2.3. \n    Queue data as type for destination\n  "},{"refs":[{"id":"ref-for-reporting-observer\u2462"},{"id":"ref-for-reporting-observer\u2463"},{"id":"ref-for-reporting-observer\u2464"},{"id":"ref-for-reporting-observer\u2465"}],"title":"4. Reporting Observers"},{"refs":[{"id":"ref-for-reporting-observer\u2466"}],"title":"4.2. \n    Notify reporting observers on scope with report\n  "},{"refs":[{"id":"ref-for-reporting-observer\u2467"}],"title":"5.2. Garbage Collection"},{"refs":[{"id":"ref-for-reporting-observer\u2468"}],"title":"7.1. Generate Test Report"}],"url":"#reporting-observer"},
"reportingobserver": {"dfnID":"reportingobserver","dfnText":"ReportingObserver","external":false,"refSections":[{"refs":[{"id":"ref-for-reportingobserver"}],"title":"4. Reporting Observers"},{"refs":[{"id":"ref-for-reportingobserver\u2460"},{"id":"ref-for-reportingobserver\u2461"},{"id":"ref-for-reportingobserver\u2462"},{"id":"ref-for-reportingobserver\u2463"}],"title":"4.1. Interface ReportingObserver"},{"refs":[{"id":"ref-for-reportingobserver\u2464"}],"title":"4.2. \n    Notify reporting observers on scope with report\n  "},{"refs":[{"id":"ref-for-reportingobserver\u2465"}],"title":"4.3. \n    Add report to observer\n  "},{"refs":[{"id":"ref-for-reportingobserver\u2466"}],"title":"4.4. \n    Invoke reporting observers with notify list\n  "}],"url":"#reportingobserver"},
"reportingobserver-callback": {"dfnID":"reportingobserver-callback","dfnText":"callback","external":false,"refSections":[{"refs":[{"id":"ref-for-reportingobserver-callback"}],"title":"4.1. Interface ReportingObserver"},{"refs":[{"id":"ref-for-reportingobserver-callback\u2460"}],"title":"4.4. \n    Invoke reporting observers with notify list\n  "}],"url":"#reportingobserver-callback"},
"reportingobserver-options": {"dfnID":"reportingobserver-options","dfnText":"options","external":false,"refSections":[{"refs":[{"id":"ref-for-reportingobserver-options"},{"id":"ref-for-reportingobserver-options\u2460"},{"id":"ref-for-reportingobserver-options\u2461"}],"title":"4.1. Interface ReportingObserver"},{"refs":[{"id":"ref-for-reportingobserver-options\u2462"}],"title":"4.3. \n    Add report to observer\n  "}],"url":"#reportingobserver-options"},
"reportingobserver-report-queue": {"dfnID":"reportingobserver-report-queue","dfnText":"report\nqueue","external":false,"refSections":[{"refs":[{"id":"ref-for-reportingobserver-report-queue"},{"id":"ref-for-reportingobserver-report-queue\u2460"}],"title":"4.1. Interface ReportingObserver"},{"refs":[{"id":"ref-for-reportingobserver-report-queue\u2461"},{"id":"ref-for-reportingobserver-report-queue\u2462"},{"id":"ref-for-reportingobserver-report-queue\u2463"}],"title":"4.3. \n    Add report to observer\n  "},{"refs":[{"id":"ref-for-reportingobserver-report-queue\u2464"},{"id":"ref-for-reportingobserver-report-queue\u2465"},{"id":"ref-for-reportingobserver-report-queue\u2466"}],"title":"4.4. \n    Invoke reporting observers with notify list\n  "}],"url":"#reportingobserver-report-queue"},
"serialize-a-list-of-reports-to-json": {"dfnID":"serialize-a-list-of-reports-to-json","dfnText":"serialize a list of reports to JSON","external":false,"refSections":[{"refs":[{"id":"ref-for-serialize-a-list-of-reports-to-json"}],"title":"3.5.2. \n    Attempt to deliver reports to endpoint\n  "}],"url":"#serialize-a-list-of-reports-to-json"},
"strip-url-for-use-in-reports": {"dfnID":"strip-url-for-use-in-reports","dfnText":"strip URL for use in reports","external":false,"refSections":[],"url":"#strip-url-for-use-in-reports"},
"typedefdef-reportlist": {"dfnID":"typedefdef-reportlist","dfnText":"ReportList","external":false,"refSections":[{"refs":[{"id":"ref-for-typedefdef-reportlist"},{"id":"ref-for-typedefdef-reportlist\u2460"}],"title":"4.1. Interface ReportingObserver"}],"url":"#typedefdef-reportlist"},
"visible-to-reportingobservers": {"dfnID":"visible-to-reportingobservers","dfnText":"visible to ReportingObservers","external":false,"refSections":[{"refs":[{"id":"ref-for-visible-to-reportingobservers"}],"title":"2.1.2. Report Type"},{"refs":[{"id":"ref-for-visible-to-reportingobservers\u2460"}],"title":"4.3. \n    Add report to observer\n  "}],"url":"#visible-to-reportingobservers"},
"windoworworkerglobalscope-endpoints": {"dfnID":"windoworworkerglobalscope-endpoints","dfnText":"endpoints","external":false,"refSections":[{"refs":[{"id":"ref-for-windoworworkerglobalscope-endpoints"}],"title":"3.1. Document configuration"},{"refs":[{"id":"ref-for-windoworworkerglobalscope-endpoints\u2460"},{"id":"ref-for-windoworworkerglobalscope-endpoints\u2461"}],"title":"3.5.1. Send reports"}],"url":"#windoworworkerglobalscope-endpoints"},
"windoworworkerglobalscope-registered-reporting-observer-list": {"dfnID":"windoworworkerglobalscope-registered-reporting-observer-list","dfnText":"registered reporting observer list","external":false,"refSections":[{"refs":[{"id":"ref-for-windoworworkerglobalscope-registered-reporting-observer-list"}],"title":"4. Reporting Observers"},{"refs":[{"id":"ref-for-windoworworkerglobalscope-registered-reporting-observer-list\u2460"},{"id":"ref-for-windoworworkerglobalscope-registered-reporting-observer-list\u2461"}],"title":"4.1. Interface ReportingObserver"},{"refs":[{"id":"ref-for-windoworworkerglobalscope-registered-reporting-observer-list\u2462"}],"title":"4.3. \n    Add report to observer\n  "}],"url":"#windoworworkerglobalscope-registered-reporting-observer-list"},
"windoworworkerglobalscope-report-buffer": {"dfnID":"windoworworkerglobalscope-report-buffer","dfnText":"report buffer","external":false,"refSections":[{"refs":[{"id":"ref-for-windoworworkerglobalscope-report-buffer"}],"title":"4. Reporting Observers"},{"refs":[{"id":"ref-for-windoworworkerglobalscope-report-buffer\u2460"}],"title":"4.1. Interface ReportingObserver"},{"refs":[{"id":"ref-for-windoworworkerglobalscope-report-buffer\u2461"},{"id":"ref-for-windoworworkerglobalscope-report-buffer\u2462"},{"id":"ref-for-windoworworkerglobalscope-report-buffer\u2463"}],"title":"4.2. \n    Notify reporting observers on scope with report\n  "},{"refs":[{"id":"ref-for-windoworworkerglobalscope-report-buffer\u2464"}],"title":"5.2. Garbage Collection"}],"url":"#windoworworkerglobalscope-report-buffer"},
"windoworworkerglobalscope-reports": {"dfnID":"windoworworkerglobalscope-reports","dfnText":"reports","external":false,"refSections":[{"refs":[{"id":"ref-for-windoworworkerglobalscope-reports"}],"title":"2.1.1. Endpoints"},{"refs":[{"id":"ref-for-windoworworkerglobalscope-reports\u2460"}],"title":"2.1.2. Report Type"},{"refs":[{"id":"ref-for-windoworworkerglobalscope-reports\u2461"}],"title":"3.4.1. Generate report of type with\n  data"},{"refs":[{"id":"ref-for-windoworworkerglobalscope-reports\u2462"}],"title":"3.5. Report Delivery"},{"refs":[{"id":"ref-for-windoworworkerglobalscope-reports\u2463"}],"title":"3.5.1. Send reports"},{"refs":[{"id":"ref-for-windoworworkerglobalscope-reports\u2464"}],"title":"3.5.2. \n    Attempt to deliver reports to endpoint\n  "},{"refs":[{"id":"ref-for-windoworworkerglobalscope-reports\u2465"},{"id":"ref-for-windoworworkerglobalscope-reports\u2466"}],"title":"4. Reporting Observers"},{"refs":[{"id":"ref-for-windoworworkerglobalscope-reports\u2467"}],"title":"5.2. Garbage Collection"}],"url":"#windoworworkerglobalscope-reports"},
};

document.addEventListener("DOMContentLoaded", ()=>{
    genAllDfnPanels();

    document.body.addEventListener("click", (e) => {
        // If not handled already, just hide all dfn panels.
        hideAllDfnPanels();
    });
});

window.addEventListener("resize", () => {
    // Pin any visible dfn panel
    queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el=>positionDfnPanel(el));
});

function genAllDfnPanels() {
    for(const panelData of Object.values(dfnPanelData)) {
        const dfnID = panelData.dfnID;
        const dfn = document.getElementById(dfnID);
        if(!dfn) {
            console.log(`Can't find dfn#${dfnID}.`, panelData);
            continue;
        }
        dfn.panelData = panelData;
        insertDfnPopupAction(dfn);
    }
}

function genDfnPanel(dfn, { dfnID, url, dfnText, refSections, external }) {
    const dfnPanel = mk.aside({
        class: "dfn-panel on",
        id: `infopanel-for-${dfnID}`,
        "data-for": dfnID,
        "aria-labelled-by":`infopaneltitle-for-${dfnID}`,
        },
        mk.span({id:`infopaneltitle-for-${dfnID}`, style:"display:none"},
            `Info about the '${dfnText}' ${external?"external":""} reference.`),
        mk.a({href:url, class:"dfn-link"}, url),
        refSections.length == 0 ? [] :
            mk.b({}, "Referenced in:"),
            mk.ul({},
                ...refSections.map(section=>
                    mk.li({},
                        ...section.refs.map((ref, refI)=>
                            [
                                mk.a({ href: `#${ref.id}` },
                                    (refI == 0) ? section.title : `(${refI + 1})`
                                ),
                                " ",
                            ]
                        ),
                    ),
                ),
            ),
        genLinkingSyntaxes(dfn),
    );

    dfnPanel.addEventListener('click', (event) => {
        if (event.target.nodeName == 'A') {
            scrollToTargetAndHighlight(event);
            pinDfnPanel(dfnPanel);
        }
        event.stopPropagation();
        refocusOnTarget(event);
    });
    dfnPanel.addEventListener('keydown', (event) => {
        if(event.keyCode == 27) { // Escape key
            hideDfnPanel({dfnPanel});
            event.stopPropagation();
            event.preventDefault();
        }
    });

    dfnPanel.dfn = dfn;
    dfn.dfnPanel = dfnPanel;
    return dfnPanel;
}



function hideAllDfnPanels() {
    // Delete the currently-active dfn panel.
    queryAll(".dfn-panel").forEach(dfnPanel=>hideDfnPanel({dfnPanel}));
}

function showDfnPanel(dfn) {
    hideAllDfnPanels(); // Only display one at a time.

    dfn.setAttribute("aria-expanded", "true");

    const dfnPanel = genDfnPanel(dfn, dfn.panelData);

    // Give the dfn a unique tabindex, and then
    // give all the tabbable panel bits successive indexes.
    let tabIndex = 100;
    dfn.tabIndex = tabIndex++;
    const tabbable = dfnPanel.querySelectorAll(":is(a, button)");
    for (const el of tabbable) {
        el.tabIndex = tabIndex++;
    }

    append(document.body, dfnPanel);
    positionDfnPanel(dfnPanel);
}

function positionDfnPanel(dfnPanel) {
    const dfn = dfnPanel.dfn;
    const dfnPos = getBounds(dfn);
    dfnPanel.style.top = dfnPos.bottom + "px";
    dfnPanel.style.left = dfnPos.left + "px";

    const panelPos = dfnPanel.getBoundingClientRect();
    const panelMargin = 8;
    const maxRight = document.body.parentNode.clientWidth - panelMargin;
    if (panelPos.right > maxRight) {
        const overflowAmount = panelPos.right - maxRight;
        const newLeft = Math.max(panelMargin, dfnPos.left - overflowAmount);
        dfnPanel.style.left = newLeft + "px";
    }
}

function pinDfnPanel(dfnPanel) {
    // Switch it to "activated" state, which pins it.
    dfnPanel.classList.add("activated");
    dfnPanel.style.position = "fixed";
    dfnPanel.style.left = null;
    dfnPanel.style.top = null;
}

function hideDfnPanel({dfn, dfnPanel}) {
    if(!dfnPanel) dfnPanel = dfn.dfnPanel;
    if(!dfn) dfn = dfnPanel.dfn;
    dfn.dfnPanel = undefined;
    dfnPanel.dfn = undefined;
    dfn.setAttribute("aria-expanded", "false");
    dfn.tabIndex = undefined;
    dfnPanel.remove()
}

function toggleDfnPanel(dfn) {
    if(dfn.dfnPanel) {
        hideDfnPanel(dfn);
    } else {
        showDfnPanel(dfn);
    }
}

function insertDfnPopupAction(dfn) {
    dfn.setAttribute('role', 'button');
    dfn.setAttribute('aria-expanded', 'false')
    dfn.tabIndex = 0;
    dfn.classList.add('has-dfn-panel');
    dfn.addEventListener('click', (event) => {
        toggleDfnPanel(dfn);
        event.stopPropagation();
    });
    dfn.addEventListener('keypress', (event) => {
        const kc = event.keyCode;
        // 32->Space, 13->Enter
        if(kc == 32 || kc == 13) {
            toggleDfnPanel(dfn);
            event.stopPropagation();
            event.preventDefault();
        }
    });
}

function refocusOnTarget(event) {
    const target = event.target;
    setTimeout(() => {
        // Refocus on the event.target element.
        // This is needed after browser scrolls to the destination.
        target.focus();
    });
}

// TODO: shared util
// Returns the root-level absolute position {left and top} of element.
function getBounds(el, relativeTo=document.body) {
    const relativeRect = relativeTo.getBoundingClientRect();
    const elRect = el.getBoundingClientRect();
    const top = elRect.top - relativeRect.top;
    const left = elRect.left - relativeRect.left;
    return {
        top,
        left,
        bottom: top + elRect.height,
        right: left + elRect.width,
    }
}

function scrollToTargetAndHighlight(event) {
    let hash = event.target.hash;
    if (hash) {
        hash = decodeURIComponent(hash.substring(1));
        const dest = document.getElementById(hash);
        if (dest) {
            dest.classList.add('highlighted');
            setTimeout(() => dest.classList.remove('highlighted'), 1000);
        }
    }
}

// Functions, divided by link type, that wrap an autolink's
// contents with the appropriate outer syntax.
// Alternately, a string naming another type they format
// the same as.
function needsFor(type) {
    switch(type) {
        case "descriptor":
        case "value":
        case "element-attr":
        case "attr-value":
        case "element-state":
        case "method":
        case "constructor":
        case "argument":
        case "attribute":
        case "const":
        case "dict-member":
        case "event":
        case "enum-value":
        case "stringifier":
        case "serializer":
        case "iterator":
        case "maplike":
        case "setlike":
        case "state":
        case "mode":
        case "context":
        case "facet": return true;

        default: return false;
    }
}
function refusesFor(type) {
    switch(type) {
        case "property":
        case "element":
        case "interface":
        case "namespace":
        case "callback":
        case "dictionary":
        case "enum":
        case "exception":
        case "typedef":
        case "http-header":
        case "permission": return true;

        default: return false;
    }
}
function linkFormatterFromType(type) {
    switch(type) {
        case 'scheme':
        case 'permission':
        case 'dfn': return (text) => `[=${text}=]`;

        case 'abstract-op': return (text) => `[\$${text}\$]`;

        case 'function':
        case 'at-rule':
        case 'selector':
        case 'value': return (text) => `''${text}''`;

        case 'http-header': return (text) => `[:${text}:]`;

        case 'interface':
        case 'constructor':
        case 'method':
        case 'argument':
        case 'attribute':
        case 'callback':
        case 'dictionary':
        case 'dict-member':
        case 'enum':
        case 'enum-value':
        case 'exception':
        case 'const':
        case 'typedef':
        case 'stringifier':
        case 'serializer':
        case 'iterator':
        case 'maplike':
        case 'setlike':
        case 'extended-attribute':
        case 'event':
        case 'idl': return (text) => `{{${text}}}`;

        case 'element-state':
        case 'element-attr':
        case 'attr-value':
        case 'element': return (element) => `<{${element}}>`;

        case 'grammar': return (text) => `${text} (within a <pre class=prod>)`;

        case 'type': return (text)=> `<<${text}>>`;

        case 'descriptor':
        case 'property': return (text) => `'${text}'`;

        default: return;
    };
};

function genLinkingSyntaxes(dfn) {
    if(dfn.tagName != "DFN") return;

    const type = dfn.getAttribute('data-dfn-type');
    if(!type) {
        console.log(`<dfn> doesn't have a data-dfn-type:`, dfn);
        return [];
    }

    // Return a function that wraps link text based on the type
    const linkFormatter = linkFormatterFromType(type);
    if(!linkFormatter) {
        console.log(`<dfn> has an unknown data-dfn-type:`, dfn);
        return [];
    }

    let ltAlts;
    if(dfn.hasAttribute('data-lt')) {
        ltAlts = dfn.getAttribute('data-lt')
            .split("|")
            .map(x=>x.trim());
    } else {
        ltAlts = [dfn.textContent.trim()];
    }
    if(type == "type") {
        // lt of "<foo>", but "foo" is the interior;
        // <<foo/bar>> is how you write it with a for,
        // not <foo/<bar>> or whatever.
        for(var i = 0; i < ltAlts.length; i++) {
            const lt = ltAlts[i];
            const match = /<(.*)>/.exec(lt);
            if(match) { ltAlts[i] = match[1]; }
        }
    }

    let forAlts;
    if(dfn.hasAttribute('data-dfn-for')) {
        forAlts = dfn.getAttribute('data-dfn-for')
            .split(",")
            .map(x=>x.trim());
    } else {
        forAlts = [''];
    }

    let linkingSyntaxes = [];
    if(!needsFor(type)) {
        for(const lt of ltAlts) {
            linkingSyntaxes.push(linkFormatter(lt));
        }
    }
    if(!refusesFor(type)) {
        for(const f of forAlts) {
            linkingSyntaxes.push(linkFormatter(`${f}/${ltAlts[0]}`))
        }
    }
    return [
        mk.b({}, 'Possible linking syntaxes:'),
        mk.ul({},
            ...linkingSyntaxes.map(link => {
                const copyLink = async () =>
                    await navigator.clipboard.writeText(link);
                return mk.li({},
                    mk.div({ class: 'link-item' },
                        mk.button({
                            class: 'copy-icon', title: 'Copy',
                            type: 'button',
                            _onclick: copyLink,
                            tabindex: 0,
                        }, mk.span({ class: 'icon' }) ),
                        mk.span({}, link)
                    )
                );
            })
        )
    ];
}
}
</script>
<script>/* Boilerplate: script-position-annos */
"use strict";
{
function repositionAnnoPanels(){
    const panels = [...document.querySelectorAll("[data-anno-for]")];
    hydratePanels(panels);
    let vSoFar = 0;
    for(const panel of panels.sort(cmpTops)) {
        if(panel.top < vSoFar) {
            panel.top = vSoFar;
            panel.style.top = vSoFar + "px";
        }
        vSoFar = panel.top + panel.height + 15;
    }
}
function hydratePanels(panels) {
    const main = document.querySelector("main");
    let mainRect;
    if(main) mainRect = main.getBoundingClientRect();
    // First display them all, if they're not already visible.
    for(const panel of panels) {
        panel.classList.remove("unpositioned");
    }
    // Measure them all
    for(const panel of panels) {
        const dfn = document.getElementById(panel.getAttribute("data-anno-for"));
        if(!dfn) {
            console.log("Can't find the annotation panel target:", panel);
            continue;
        }
        panel.dfn = dfn;
        panel.top = window.scrollY + dfn.getBoundingClientRect().top;
        let panelRect = panel.getBoundingClientRect();
        panel.height = panelRect.height;
        if(main) {
            panel.overlappingMain = panelRect.left < mainRect.right;
        } else {
            panel.overlappingMain = false;
        }
    }
    // And finally position them
    for(const panel of panels) {
        const dfn = panel.dfn;
        if(!dfn) continue;
        panel.style.top = panel.top + "px";
        panel.classList.toggle("overlapping-main", panel.overlappingMain);
    }
}

function cmpTops(a,b) {
    return a.top - b.top;
}

window.addEventListener("load", repositionAnnoPanels);
window.addEventListener("resize", repositionAnnoPanels);
}
</script>
<script>/* Boilerplate: script-ref-hints */
"use strict";
{
let refsData = {
"#callbackdef-reportingobservercallback": {"displayText":"ReportingObserverCallback","export":true,"for_":[],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"ReportingObserverCallback","type":"callback","url":"#callbackdef-reportingobservercallback"},
"#dictdef-reportingobserveroptions": {"displayText":"ReportingObserverOptions","export":true,"for_":[],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"ReportingObserverOptions","type":"dictionary","url":"#dictdef-reportingobserveroptions"},
"#dom-endpoint-failures": {"displayText":"failures","export":true,"for_":["endpoint"],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"failures","type":"attribute","url":"#dom-endpoint-failures"},
"#dom-endpoint-name": {"displayText":"name","export":true,"for_":["endpoint"],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"name","type":"attribute","url":"#dom-endpoint-name"},
"#dom-endpoint-url": {"displayText":"url","export":true,"for_":["endpoint"],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"url","type":"attribute","url":"#dom-endpoint-url"},
"#dom-generatetestreportparameters-group": {"displayText":"group","export":true,"for_":["GenerateTestReportParameters"],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"group","type":"dict-member","url":"#dom-generatetestreportparameters-group"},
"#dom-generatetestreportparameters-message": {"displayText":"message","export":true,"for_":["GenerateTestReportParameters"],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"message","type":"dict-member","url":"#dom-generatetestreportparameters-message"},
"#dom-report": {"displayText":"Report","export":true,"for_":[],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"Report","type":"interface","url":"#dom-report"},
"#dom-report-body": {"displayText":"body","export":true,"for_":["Report"],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"body","type":"attribute","url":"#dom-report-body"},
"#dom-report-type": {"displayText":"type","export":true,"for_":["Report"],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"type","type":"attribute","url":"#dom-report-type"},
"#dom-report-url": {"displayText":"url","export":true,"for_":["Report"],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"url","type":"attribute","url":"#dom-report-url"},
"#dom-reportingobserver-disconnect": {"displayText":"disconnect()","export":true,"for_":["ReportingObserver"],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"disconnect()","type":"method","url":"#dom-reportingobserver-disconnect"},
"#dom-reportingobserver-observe": {"displayText":"observe()","export":true,"for_":["ReportingObserver"],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"observe()","type":"method","url":"#dom-reportingobserver-observe"},
"#dom-reportingobserver-reportingobserver": {"displayText":"ReportingObserver(callback, options)","export":true,"for_":["ReportingObserver"],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"ReportingObserver(callback, options)","type":"constructor","url":"#dom-reportingobserver-reportingobserver"},
"#dom-reportingobserver-takerecords": {"displayText":"takeRecords()","export":true,"for_":["ReportingObserver"],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"takeRecords()","type":"method","url":"#dom-reportingobserver-takerecords"},
"#dom-reportingobserveroptions-buffered": {"displayText":"buffered","export":true,"for_":["ReportingObserverOptions"],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"buffered","type":"dict-member","url":"#dom-reportingobserveroptions-buffered"},
"#dom-reportingobserveroptions-types": {"displayText":"types","export":true,"for_":["ReportingObserverOptions"],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"types","type":"dict-member","url":"#dom-reportingobserveroptions-types"},
"#endpoint": {"displayText":"endpoint","export":true,"for_":[],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"endpoint","type":"dfn","url":"#endpoint"},
"#generate-a-report": {"displayText":"generate a report","export":true,"for_":[],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"generate a report","type":"dfn","url":"#generate-a-report"},
"#generate-and-queue-a-report": {"displayText":"generate and queue a report","export":true,"for_":[],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"generate and queue a report","type":"dfn","url":"#generate-and-queue-a-report"},
"#registered": {"displayText":"registered","export":true,"for_":[],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"registered","type":"dfn","url":"#registered"},
"#report": {"displayText":"report","export":true,"for_":[],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"report","type":"dfn","url":"#report"},
"#report-attempts": {"displayText":"attempts","export":true,"for_":["report"],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"attempts","type":"dfn","url":"#report-attempts"},
"#report-body": {"displayText":"body","export":true,"for_":["report"],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"body","type":"dfn","url":"#report-body"},
"#report-destination": {"displayText":"destination","export":true,"for_":["report"],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"destination","type":"dfn","url":"#report-destination"},
"#report-reporttype": {"displayText":"type","export":true,"for_":["report"],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"type","type":"dfn","url":"#report-reporttype"},
"#report-timestamp": {"displayText":"timestamp","export":true,"for_":["report"],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"timestamp","type":"dfn","url":"#report-timestamp"},
"#report-type": {"displayText":"report type","export":true,"for_":[],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"report type","type":"dfn","url":"#report-type"},
"#report-url": {"displayText":"url","export":true,"for_":["report"],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"url","type":"dfn","url":"#report-url"},
"#report-user-agent": {"displayText":"user agent","export":true,"for_":["report"],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"user agent","type":"dfn","url":"#report-user-agent"},
"#reportbody": {"displayText":"ReportBody","export":true,"for_":[],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"ReportBody","type":"interface","url":"#reportbody"},
"#reporting-endpoints": {"displayText":"reporting-endpoints","export":true,"for_":[],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"reporting-endpoints","type":"dfn","url":"#reporting-endpoints"},
"#reporting-observer": {"displayText":"reporting observer","export":true,"for_":[],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"reporting observer","type":"dfn","url":"#reporting-observer"},
"#reportingobserver": {"displayText":"ReportingObserver","export":true,"for_":[],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"ReportingObserver","type":"interface","url":"#reportingobserver"},
"#reportingobserver-callback": {"displayText":"callback","export":true,"for_":["ReportingObserver"],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"callback","type":"dfn","url":"#reportingobserver-callback"},
"#reportingobserver-options": {"displayText":"options","export":true,"for_":["ReportingObserver"],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"options","type":"dfn","url":"#reportingobserver-options"},
"#reportingobserver-report-queue": {"displayText":"report queue","export":true,"for_":["ReportingObserver"],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"report queue","type":"dfn","url":"#reportingobserver-report-queue"},
"#serialize-a-list-of-reports-to-json": {"displayText":"serialize a list of reports to json","export":true,"for_":[],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"serialize a list of reports to json","type":"dfn","url":"#serialize-a-list-of-reports-to-json"},
"#typedefdef-reportlist": {"displayText":"ReportList","export":true,"for_":[],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"ReportList","type":"typedef","url":"#typedefdef-reportlist"},
"#visible-to-reportingobservers": {"displayText":"visible to reportingobservers","export":true,"for_":[],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"visible to reportingobservers","type":"dfn","url":"#visible-to-reportingobservers"},
"#windoworworkerglobalscope-endpoints": {"displayText":"endpoints","export":true,"for_":["WindowOrWorkerGlobalScope"],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"endpoints","type":"dfn","url":"#windoworworkerglobalscope-endpoints"},
"#windoworworkerglobalscope-registered-reporting-observer-list": {"displayText":"registered reporting observer list","export":true,"for_":["WindowOrWorkerGlobalScope"],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"registered reporting observer list","type":"dfn","url":"#windoworworkerglobalscope-registered-reporting-observer-list"},
"#windoworworkerglobalscope-report-buffer": {"displayText":"report buffer","export":true,"for_":["WindowOrWorkerGlobalScope"],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"report buffer","type":"dfn","url":"#windoworworkerglobalscope-report-buffer"},
"#windoworworkerglobalscope-reports": {"displayText":"reports","export":true,"for_":["WindowOrWorkerGlobalScope"],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"local","text":"reports","type":"dfn","url":"#windoworworkerglobalscope-reports"},
"https://dom.spec.whatwg.org/#document": {"displayText":"Document","export":true,"for_":[],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"Document","type":"interface","url":"https://dom.spec.whatwg.org/#document"},
"https://fetch.spec.whatwg.org/#concept-body": {"displayText":"body","export":true,"for_":[],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"body","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-body"},
"https://fetch.spec.whatwg.org/#concept-body-source": {"displayText":"source","export":true,"for_":["body"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"source","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-body-source"},
"https://fetch.spec.whatwg.org/#concept-fetch": {"displayText":"fetch","export":true,"for_":[],"level":"","normative":true,"shortname":"fetch","spec":"fetch","status":"anchor-block","text":"fetch","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-fetch"},
"https://fetch.spec.whatwg.org/#concept-header": {"displayText":"header","export":true,"for_":[],"level":"","normative":true,"shortname":"fetch","spec":"fetch","status":"anchor-block","text":"header","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-header"},
"https://fetch.spec.whatwg.org/#concept-header-list": {"displayText":"header list","export":true,"for_":[],"level":"","normative":true,"shortname":"fetch","spec":"fetch","status":"anchor-block","text":"header list","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-header-list"},
"https://fetch.spec.whatwg.org/#concept-header-list-get-structured-header": {"displayText":"get a structured field value","export":true,"for_":["header list"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"get a structured field value","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-header-list-get-structured-header"},
"https://fetch.spec.whatwg.org/#concept-request": {"displayText":"request","export":true,"for_":[],"level":"","normative":true,"shortname":"fetch","spec":"fetch","status":"anchor-block","text":"request","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-request"},
"https://fetch.spec.whatwg.org/#concept-response": {"displayText":"response","export":true,"for_":[],"level":"","normative":true,"shortname":"fetch","spec":"fetch","status":"anchor-block","text":"response","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-response"},
"https://fetch.spec.whatwg.org/#concept-response-header-list": {"displayText":"header list","export":true,"for_":["response"],"level":"","normative":true,"shortname":"fetch","spec":"fetch","status":"anchor-block","text":"header list","type":"attribute","url":"https://fetch.spec.whatwg.org/#concept-response-header-list"},
"https://fetch.spec.whatwg.org/#concept-response-https-state": {"displayText":"HTTPS state","export":true,"for_":["response"],"level":"","normative":true,"shortname":"fetch","spec":"fetch","status":"anchor-block","text":"HTTPS state","type":"attribute","url":"https://fetch.spec.whatwg.org/#concept-response-https-state"},
"https://fetch.spec.whatwg.org/#concept-response-url": {"displayText":"url","export":true,"for_":["response"],"level":"","normative":true,"shortname":"fetch","spec":"fetch","status":"anchor-block","text":"url","type":"attribute","url":"https://fetch.spec.whatwg.org/#concept-response-url"},
"https://fetch.spec.whatwg.org/#http-scheme": {"displayText":"HTTP(S) scheme","export":true,"for_":[],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"http(s) scheme","type":"dfn","url":"https://fetch.spec.whatwg.org/#http-scheme"},
"https://fetch.spec.whatwg.org/#ok-status": {"displayText":"ok status","export":true,"for_":[],"level":"","normative":true,"shortname":"fetch","spec":"fetch","status":"anchor-block","text":"ok status","type":"dfn","url":"https://fetch.spec.whatwg.org/#ok-status"},
"https://fetch.spec.whatwg.org/#wait-for-a-response": {"displayText":"wait for a response","export":true,"for_":[],"level":"","normative":true,"shortname":"fetch","spec":"fetch","status":"anchor-block","text":"wait for a response","type":"dfn","url":"https://fetch.spec.whatwg.org/#wait-for-a-response"},
"https://html.spec.whatwg.org/multipage/browsers.html#origin": {"displayText":"origin","export":true,"for_":[],"level":"","normative":true,"shortname":"html","spec":"html","status":"anchor-block","text":"origin","type":"dfn","url":"https://html.spec.whatwg.org/multipage/browsers.html#origin"},
"https://html.spec.whatwg.org/multipage/document-sequences.html#nav-document": {"displayText":"active document","export":true,"for_":["navigable"],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"active document","type":"dfn","url":"https://html.spec.whatwg.org/multipage/document-sequences.html#nav-document"},
"https://html.spec.whatwg.org/multipage/system-state.html#dom-navigator-useragent": {"displayText":"navigator.userAgent","export":true,"for_":[],"level":"","normative":true,"shortname":"html","spec":"html","status":"anchor-block","text":"navigator.useragent","type":"dfn","url":"https://html.spec.whatwg.org/multipage/system-state.html#dom-navigator-useragent"},
"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global": {"displayText":"relevant global object","export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"relevant global object","type":"dfn","url":"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global"},
"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global": {"displayText":"global object","export":true,"for_":["environment settings object"],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"global object","type":"dfn","url":"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global"},
"https://html.spec.whatwg.org/multipage/webappapis.html#creation-url": {"displayText":"creation URL","export":true,"for_":[],"level":"","normative":true,"shortname":"html","spec":"html","status":"anchor-block","text":"creation url","type":"dfn","url":"https://html.spec.whatwg.org/multipage/webappapis.html#creation-url"},
"https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object": {"displayText":"environment settings object","export":true,"for_":[],"level":"","normative":true,"shortname":"html","spec":"html","status":"anchor-block","text":"environment settings object","type":"dfn","url":"https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"},
"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task": {"displayText":"queue a task","export":true,"for_":[],"level":"","normative":true,"shortname":"html","spec":"html","status":"anchor-block","text":"queue a task","type":"dfn","url":"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"},
"https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object": {"displayText":"relevant settings object","export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"relevant settings object","type":"dfn","url":"https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"},
"https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope": {"displayText":"WindowOrWorkerGlobalScope","export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"WindowOrWorkerGlobalScope","type":"interface","url":"https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope"},
"https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope": {"displayText":"WorkerGlobalScope","export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"WorkerGlobalScope","type":"interface","url":"https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope"},
"https://infra.spec.whatwg.org/#byte-sequence": {"displayText":"byte sequence","export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"byte sequence","type":"dfn","url":"https://infra.spec.whatwg.org/#byte-sequence"},
"https://infra.spec.whatwg.org/#iteration-continue": {"displayText":"continue","export":true,"for_":["iteration"],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"continue","type":"dfn","url":"https://infra.spec.whatwg.org/#iteration-continue"},
"https://infra.spec.whatwg.org/#list": {"displayText":"list","export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"list","type":"dfn","url":"https://infra.spec.whatwg.org/#list"},
"https://infra.spec.whatwg.org/#ordered-set": {"displayText":"ordered set","export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"ordered set","type":"dfn","url":"https://infra.spec.whatwg.org/#ordered-set"},
"https://infra.spec.whatwg.org/#serialize-an-infra-value-to-json-bytes": {"displayText":"serialize an Infra value to JSON bytes","export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"serialize an infra value to json bytes","type":"dfn","url":"https://infra.spec.whatwg.org/#serialize-an-infra-value-to-json-bytes"},
"https://tools.ietf.org/html/rfc7469#section-2.1": {"displayText":"Public-Key-Pins","export":true,"for_":[],"level":"","normative":true,"shortname":"rfc7469","spec":"rfc7469","status":"anchor-block","text":"public-key-pins","type":"dfn","url":"https://tools.ietf.org/html/rfc7469#section-2.1"},
"https://tools.ietf.org/html/rfc8259#section-2": {"displayText":"JSON text","export":true,"for_":[],"level":"","normative":true,"shortname":"rfc8259","spec":"rfc8259","status":"anchor-block","text":"json text","type":"dfn","url":"https://tools.ietf.org/html/rfc8259#section-2"},
"https://url.spec.whatwg.org/#concept-base-url": {"displayText":"base URL","export":false,"for_":[],"level":"1","normative":true,"shortname":"url","spec":"url","status":"current","text":"base url","type":"dfn","url":"https://url.spec.whatwg.org/#concept-base-url"},
"https://url.spec.whatwg.org/#concept-url": {"displayText":"URL","export":true,"for_":[],"level":"","normative":true,"shortname":"url","spec":"url","status":"anchor-block","text":"URL","type":"interface","url":"https://url.spec.whatwg.org/#concept-url"},
"https://url.spec.whatwg.org/#concept-url-fragment": {"displayText":"fragment","export":true,"for_":["url"],"level":"1","normative":true,"shortname":"url","spec":"url","status":"current","text":"fragment","type":"dfn","url":"https://url.spec.whatwg.org/#concept-url-fragment"},
"https://url.spec.whatwg.org/#concept-url-origin": {"displayText":"origin of a url","export":true,"for_":[],"level":"","normative":true,"shortname":"url","spec":"url","status":"anchor-block","text":"origin of a url","type":"dfn","url":"https://url.spec.whatwg.org/#concept-url-origin"},
"https://url.spec.whatwg.org/#concept-url-parser": {"displayText":"URL parser","export":true,"for_":[],"level":"","normative":true,"shortname":"url","spec":"url","status":"anchor-block","text":"url parser","type":"dfn","url":"https://url.spec.whatwg.org/#concept-url-parser"},
"https://url.spec.whatwg.org/#concept-url-password": {"displayText":"password","export":true,"for_":["url"],"level":"1","normative":true,"shortname":"url","spec":"url","status":"current","text":"password","type":"dfn","url":"https://url.spec.whatwg.org/#concept-url-password"},
"https://url.spec.whatwg.org/#concept-url-scheme": {"displayText":"scheme","export":true,"for_":["url"],"level":"1","normative":true,"shortname":"url","spec":"url","status":"current","text":"scheme","type":"dfn","url":"https://url.spec.whatwg.org/#concept-url-scheme"},
"https://url.spec.whatwg.org/#concept-url-serializer": {"displayText":"URL serializer","export":true,"for_":[],"level":"","normative":true,"shortname":"url","spec":"url","status":"anchor-block","text":"url serializer","type":"dfn","url":"https://url.spec.whatwg.org/#concept-url-serializer"},
"https://url.spec.whatwg.org/#concept-url-username": {"displayText":"username","export":true,"for_":["url"],"level":"1","normative":true,"shortname":"url","spec":"url","status":"current","text":"username","type":"dfn","url":"https://url.spec.whatwg.org/#concept-url-username"},
"https://url.spec.whatwg.org/#concept-url_https://url.spec.whatwg.org/#concept-url": {"displayText":"URL","export":true,"for_":[],"level":"1","normative":true,"shortname":"url","spec":"url","status":"current","text":"url","type":"dfn","url":"https://url.spec.whatwg.org/#concept-url"},
"https://url.spec.whatwg.org/#dom-url-password": {"displayText":"password","export":true,"for_":["URL"],"level":"1","normative":true,"shortname":"url","spec":"url","status":"current","text":"password","type":"attribute","url":"https://url.spec.whatwg.org/#dom-url-password"},
"https://url.spec.whatwg.org/#dom-url-username": {"displayText":"username","export":true,"for_":["URL"],"level":"1","normative":true,"shortname":"url","spec":"url","status":"current","text":"username","type":"attribute","url":"https://url.spec.whatwg.org/#dom-url-username"},
"https://w3c.github.io/rdf-concepts/spec/#dfn-object": {"displayText":"object","export":true,"for_":[],"level":"1","normative":true,"shortname":"rdf-concepts","spec":"rdf12-concepts","status":"current","text":"object","type":"dfn","url":"https://w3c.github.io/rdf-concepts/spec/#dfn-object"},
"https://w3c.github.io/webappsec-csp/#content-security-policy": {"displayText":"Content-Security-Policy","export":true,"for_":[],"level":"","normative":true,"shortname":"csp","spec":"csp","status":"anchor-block","text":"content-security-policy","type":"dfn","url":"https://w3c.github.io/webappsec-csp/#content-security-policy"},
"https://w3c.github.io/webappsec-csp/#directives-reporting": {"displayText":"reports directive","export":true,"for_":[],"level":"","normative":true,"shortname":"csp","spec":"csp","status":"anchor-block","text":"reports directive","type":"dfn","url":"https://w3c.github.io/webappsec-csp/#directives-reporting"},
"https://w3c.github.io/webappsec-secure-contexts/#is-origin-trustworthy": {"displayText":"potentially trustworthy","export":true,"for_":[],"level":"","normative":true,"shortname":"secure-contexts","spec":"secure-contexts","status":"anchor-block","text":"potentially trustworthy","type":"dfn","url":"https://w3c.github.io/webappsec-secure-contexts/#is-origin-trustworthy"},
"https://w3c.github.io/webdriver/#dfn-current-browsing-context": {"displayText":"current browsing context","export":true,"for_":[],"level":"","normative":true,"shortname":"webdriver","spec":"webdriver","status":"anchor-block","text":"current browsing context","type":"dfn","url":"https://w3c.github.io/webdriver/#dfn-current-browsing-context"},
"https://w3c.github.io/webdriver/#dfn-error": {"displayText":"WebDriver error","export":true,"for_":[],"level":"","normative":true,"shortname":"webdriver","spec":"webdriver","status":"anchor-block","text":"webdriver error","type":"dfn","url":"https://w3c.github.io/webdriver/#dfn-error"},
"https://w3c.github.io/webdriver/#dfn-error-code": {"displayText":"WebDriver error code","export":true,"for_":[],"level":"","normative":true,"shortname":"webdriver","spec":"webdriver","status":"anchor-block","text":"webdriver error code","type":"dfn","url":"https://w3c.github.io/webdriver/#dfn-error-code"},
"https://w3c.github.io/webdriver/#dfn-extension-command": {"displayText":"extension command","export":true,"for_":[],"level":"","normative":true,"shortname":"webdriver","spec":"webdriver","status":"anchor-block","text":"extension command","type":"dfn","url":"https://w3c.github.io/webdriver/#dfn-extension-command"},
"https://w3c.github.io/webdriver/#dfn-extension-command-uri-template": {"displayText":"extension command uri template","export":true,"for_":[],"level":"","normative":true,"shortname":"webdriver","spec":"webdriver","status":"anchor-block","text":"extension command uri template","type":"dfn","url":"https://w3c.github.io/webdriver/#dfn-extension-command-uri-template"},
"https://w3c.github.io/webdriver/#dfn-handle-any-user-prompts": {"displayText":"handle any user prompts","export":true,"for_":[],"level":"","normative":true,"shortname":"webdriver","spec":"webdriver","status":"anchor-block","text":"handle any user prompts","type":"dfn","url":"https://w3c.github.io/webdriver/#dfn-handle-any-user-prompts"},
"https://w3c.github.io/webdriver/#dfn-invalid-argument": {"displayText":"invalid argument","export":true,"for_":[],"level":"","normative":true,"shortname":"webdriver","spec":"webdriver","status":"anchor-block","text":"invalid argument","type":"dfn","url":"https://w3c.github.io/webdriver/#dfn-invalid-argument"},
"https://w3c.github.io/webdriver/#dfn-no-such-window": {"displayText":"no such window","export":true,"for_":[],"level":"","normative":true,"shortname":"webdriver","spec":"webdriver","status":"anchor-block","text":"no such window","type":"dfn","url":"https://w3c.github.io/webdriver/#dfn-no-such-window"},
"https://w3c.github.io/webdriver/#dfn-remote-end-steps": {"displayText":"remote end steps","export":true,"for_":[],"level":"","normative":true,"shortname":"webdriver","spec":"webdriver","status":"anchor-block","text":"remote end steps","type":"dfn","url":"https://w3c.github.io/webdriver/#dfn-remote-end-steps"},
"https://w3c.github.io/webdriver/#dfn-success": {"displayText":"success","export":true,"for_":[],"level":"","normative":true,"shortname":"webdriver","spec":"webdriver","status":"anchor-block","text":"success","type":"dfn","url":"https://w3c.github.io/webdriver/#dfn-success"},
"https://w3c.github.io/webdriver/#dfn-try": {"displayText":"trying","export":true,"for_":[],"level":"","normative":true,"shortname":"webdriver","spec":"webdriver","status":"anchor-block","text":"trying","type":"dfn","url":"https://w3c.github.io/webdriver/#dfn-try"},
"https://webidl.spec.whatwg.org/#Default": {"displayText":"Default","export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"Default","type":"extended-attribute","url":"https://webidl.spec.whatwg.org/#Default"},
"https://webidl.spec.whatwg.org/#Exposed": {"displayText":"Exposed","export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"Exposed","type":"extended-attribute","url":"https://webidl.spec.whatwg.org/#Exposed"},
"https://webidl.spec.whatwg.org/#dfn-callback-this-value": {"displayText":"callback this value","export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"callback this value","type":"dfn","url":"https://webidl.spec.whatwg.org/#dfn-callback-this-value"},
"https://webidl.spec.whatwg.org/#idl-DOMString": {"displayText":"DOMString","export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"DOMString","type":"interface","url":"https://webidl.spec.whatwg.org/#idl-DOMString"},
"https://webidl.spec.whatwg.org/#idl-boolean": {"displayText":"boolean","export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"boolean","type":"interface","url":"https://webidl.spec.whatwg.org/#idl-boolean"},
"https://webidl.spec.whatwg.org/#idl-object": {"displayText":"object","export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"object","type":"interface","url":"https://webidl.spec.whatwg.org/#idl-object"},
"https://webidl.spec.whatwg.org/#idl-sequence": {"displayText":"sequence","export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"sequence","type":"dfn","url":"https://webidl.spec.whatwg.org/#idl-sequence"},
"https://webidl.spec.whatwg.org/#idl-undefined": {"displayText":"undefined","export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"undefined","type":"interface","url":"https://webidl.spec.whatwg.org/#idl-undefined"},
"https://webidl.spec.whatwg.org/#invoke-a-callback-function": {"displayText":"invoke","export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"invoke","type":"dfn","url":"https://webidl.spec.whatwg.org/#invoke-a-callback-function"},
"https://webidl.spec.whatwg.org/#this": {"displayText":"this","export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"this","type":"dfn","url":"https://webidl.spec.whatwg.org/#this"},
"https://www.rfc-editor.org/rfc/rfc8941.html#section-3.2": {"displayText":"sf-dictionary","export":true,"for_":[],"level":"","normative":true,"shortname":"structured-fields","spec":"structured-fields","status":"anchor-block","text":"sf-dictionary","type":"grammar","url":"https://www.rfc-editor.org/rfc/rfc8941.html#section-3.2"},
};

function mkRefHint(link, ref) {
    const linkText = link.textContent;
    let dfnTextElements = '';
    if (ref.displayText.toLowerCase() != linkText.toLowerCase()) {
        // Give the original term if it's being displayed in a different way.
        // But allow casing differences, they're insignificant.
        dfnTextElements =
            mk.li({},
                mk.b({}, "Term: "),
                mk.span({}, ref.displayText)
            );
    }
    const forList = ref.for_;
    let forListElements;
    if(forList.length == 0) {
        forListElements = [];
    } else if(forList.length == 1) {
        forListElements = mk.li({},
            mk.b({}, "For: "),
            mk.span({}, forList[0]),
        );
    } else {
        forListElements = mk.li({},
            mk.b({}, "For: "),
            mk.ul({},
                ...forList.map(forItem =>
                    mk.li({},
                        mk.span({}, forItem)
                    ),
                ),
            ),
        );
    }
    const url = ref.url;
    const safeUrl = encodeURIComponent(url);
    const hintPanel = mk.aside({
        class: "ref-hint",
        id: `ref-hint-for-${safeUrl}`,
        "data-for": url,
        "aria-labelled-by": `ref-hint-for-${safeUrl}`,
    },
        mk.ul({},
            dfnTextElements,
            mk.li({},
                mk.b({}, "URL: "),
                mk.a({ href: url, class: "ref" }, url),
            ),
            mk.li({},
                mk.b({}, "Type: "),
                mk.span({}, `${ref.type}`),
            ),
            mk.li({},
                mk.b({}, "Spec: "),
                mk.span({}, `${ref.spec ? ref.spec : ''}`),
            ),
            forListElements
        ),
    );
    hintPanel.forLink = link;
    setupRefHintEventListeners(link, hintPanel);
    return hintPanel;
}

function hideAllRefHints() {
    queryAll(".ref-hint").forEach(el=>hideRefHint(el));
}

function hideRefHint(refHint) {
    const link = refHint.forLink;
    link.setAttribute("aria-expanded", "false");
    if(refHint.teardownEventListeners) {
        refHint.teardownEventListeners();
    }
    refHint.remove();
}

function showRefHint(link) {
    if(link.classList.contains("dfn-link")) return;
    const url = link.getAttribute("href");
    const refHintKey = link.getAttribute("data-refhint-key");
    let key = url;
    if(refHintKey) {
        key = refHintKey + "_" + url;
    }
    const ref = refsData[key];
    if(!ref) return;

    hideAllRefHints(); // Only display one at this time.

    const refHint = mkRefHint(link, ref);
    append(document.body, refHint);
    link.setAttribute("aria-expanded", "true");
    positionRefHint(refHint);
}

function setupRefHintEventListeners(link, refHint) {
    if (refHint.teardownEventListeners) return;
    // Add event handlers to hide the refHint after the user moves away
    // from both the link and refHint, if not hovering either within one second.
    let timeout = null;
    const startHidingRefHint = (event) => {
        if (timeout) {
            clearTimeout(timeout);
        }
        timeout = setTimeout(() => {
            hideRefHint(refHint);
        }, 1000);
    }
    const resetHidingRefHint = (event) => {
        if (timeout) clearTimeout(timeout);
        timeout = null;
    };
    link.addEventListener("mouseleave", startHidingRefHint);
    link.addEventListener("mouseenter", resetHidingRefHint);
    link.addEventListener("blur", startHidingRefHint);
    link.addEventListener("focus", resetHidingRefHint);
    refHint.addEventListener("mouseleave", startHidingRefHint);
    refHint.addEventListener("mouseenter", resetHidingRefHint);
    refHint.addEventListener("blur", startHidingRefHint);
    refHint.addEventListener("focus", resetHidingRefHint);

    refHint.teardownEventListeners = () => {
        // remove event listeners
        resetHidingRefHint();
        link.removeEventListener("mouseleave", startHidingRefHint);
        link.removeEventListener("mouseenter", resetHidingRefHint);
        link.removeEventListener("blur", startHidingRefHint);
        link.removeEventListener("focus", resetHidingRefHint);
        refHint.removeEventListener("mouseleave", startHidingRefHint);
        refHint.removeEventListener("mouseenter", resetHidingRefHint);
        refHint.removeEventListener("blur", startHidingRefHint);
        refHint.removeEventListener("focus", resetHidingRefHint);
    };
}

function positionRefHint(refHint) {
    const link = refHint.forLink;
    const linkPos = getBounds(link);
    refHint.style.top = linkPos.bottom + "px";
    refHint.style.left = linkPos.left + "px";

    const panelPos = refHint.getBoundingClientRect();
    const panelMargin = 8;
    const maxRight = document.body.parentNode.clientWidth - panelMargin;
    if (panelPos.right > maxRight) {
        const overflowAmount = panelPos.right - maxRight;
        const newLeft = Math.max(panelMargin, linkPos.left - overflowAmount);
        refHint.style.left = newLeft + "px";
    }
}

// TODO: shared util
// Returns the root-level absolute position {left and top} of element.
function getBounds(el, relativeTo=document.body) {
    const relativeRect = relativeTo.getBoundingClientRect();
    const elRect = el.getBoundingClientRect();
    const top = elRect.top - relativeRect.top;
    const left = elRect.left - relativeRect.left;
    return {
        top,
        left,
        bottom: top + elRect.height,
        right: left + elRect.width,
    }
}

function showRefHintListener(e) {
    // If the target isn't in a link (or is a link),
    // just ignore it.
    let link = e.target.closest("a");
    if(!link) return;

    // If the target is in a ref-hint panel
    // (aka a link in the already-open one),
    // also just ignore it.
    if(link.closest(".ref-hint")) return;

    // Otherwise, show the panel for the link.
    showRefHint(link);
}

function hideAllHintsListener(e) {
    // If the click is inside a ref-hint panel, ignore it.
    if(e.target.closest(".ref-hint")) return;
    // Otherwise, close all the current panels.
    hideAllRefHints();
}

document.addEventListener("DOMContentLoaded", () => {
    document.body.addEventListener("mousedown", showRefHintListener);
    document.body.addEventListener("focus", showRefHintListener);

    document.body.addEventListener("click", hideAllHintsListener);
});

window.addEventListener("resize", () => {
    // Hide any open ref hint.
    hideAllRefHints();
});
}
</script>
<script>/* Boilerplate: script-var-click-highlighting */
"use strict";
{
/*
Color-choosing design:

* Colors are ordered by goodness.
* On clicking a var, give it the earliest color
    with the lowest usage in the algorithm.
* On re-clicking, re-use the var's most recent color
    if that's not currently being used elsewhere.
*/

const COLOR_COUNT = 7;

document.addEventListener("click", e=>{
    if(e.target.nodeName == "VAR") {
        highlightSameAlgoVars(e.target);
    }
});

function highlightSameAlgoVars(v) {
    // Find the algorithm container.
    let algoContainer = findAlgoContainer(v);

    // Not highlighting document-global vars,
    // too likely to be unrelated.
    if(algoContainer == null) return;

    const varName = nameFromVar(v);
    if(!v.hasAttribute("data-var-color")) {
        const newColor = chooseHighlightColor(algoContainer, v);
        for(const el of algoContainer.querySelectorAll("var")) {
            if(nameFromVar(el) == varName) {
                el.setAttribute("data-var-color", newColor);
                el.setAttribute("data-var-last-color", newColor);
            }
        }
    } else {
        for(const el of algoContainer.querySelectorAll("var")) {
            if(nameFromVar(el) == varName) {
                el.removeAttribute("data-var-color");
            }
        }
    }
}
function findAlgoContainer(el) {
    while(el != document.body) {
        if(el.hasAttribute("data-algorithm")) return el;
        el = el.parentNode;
    }
    return null;
}
function nameFromVar(el) {
    return el.textContent.replace(/(\s|\xa0)+/g, " ").trim();
}
function colorCountsFromContainer(container) {
    const namesFromColor = Array.from({length:COLOR_COUNT}, x=>new Set());
    for(let v of container.querySelectorAll("var[data-var-color]")) {
        let color = +v.getAttribute("data-var-color");
        namesFromColor[color].add(nameFromVar(v));
    }

    return namesFromColor.map(x=>x.size);
}
function leastUsedColor(colors) {
    // Find the earliest color with the lowest count.
    let minCount = Infinity;
    let minColor = null;
    for(var i = 0; i < colors.length; i++) {
        if(colors[i] < minCount) {
            minColor = i;
            minCount = colors[i];
        }
    }
    return minColor;
}
function chooseHighlightColor(container, v) {
    const colorCounts = colorCountsFromContainer(container);
    if(v.hasAttribute("data-var-last-color")) {
        let color = +v.getAttribute("data-var-last-color");
        if(colorCounts[color] == 0) return color;
    }
    return leastUsedColor(colorCounts);
}
}
</script>